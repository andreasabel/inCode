\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{\usepackage{microtype}}{}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Justin Le},
            pdftitle={Degenerate Hyper-Dimensional Game of Life},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
% Make links footnotes instead of hotlinks:
\renewcommand{\href}[2]{#2\footnote{\url{#1}}}
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{0}

\title{Degenerate Hyper-Dimensional Game of Life}
\author{Justin Le}

\begin{document}
\maketitle

\emph{Originally posted on
\textbf{\href{https://blog.jle.im/entry/degenerate-hyper-dimensional-game-of-life.html}{in
Code}}.}

tldr: Over the course of a month, we were able to successive new mathematical
properties of a ``degenerate'' hyper-dimensional game of life" to take a ``10
dimensions may just barely be possible on a supercomputer'' to ``10 dimensions
is easy enough to be run on any modern browser''. Includes interactive
visualizations and simulations!

This is a story about breaking the degenerate hyper-dimensional game of life by
exploratory visualizations and math! Let's travel back in time: t'was the night
before December 17, 2020, The release of
\href{https://adventofcode.com/2020/day/17}{``Conway Cubes''}, day 17 of the
``Advent of Code'' (fun little coding puzzles building up to Christmas). One
part about Advent of Code I've always found especially fun is that, because the
problems are so self-contained and tidy, they are often \emph{open-ended} in the
interesting ways you can solve them or expand them.

On the surface, Day 17 seemed to essentially be a straightforward extension of
\href{https://en.wikipedia.org/wiki/Conway\%27s_Game_of_Life}{Conway's Game Of
Life} (``GoL''). GoL is a simulation played out on a 2d grid, where cells are
``on'' and ``off'', and at each step of the simulation, the on/off cells spread
and propagate in fascinating ways based on the state of their neighbors.

The twist of the Advent of Code puzzle is it asks what would happen if we played
out the rules of GoL in 3d, and then 4d! The ``starting conditions'' are a 8x8
2D grid picked out for each participant, and the puzzle solution is the number
of live cells after six steps. My personal starting conditions were:

\begin{verbatim}
#####..#
#..###.#
###.....
.#.#.#..
##.#..#.
######..
.##..###
###.####
\end{verbatim}

I submitted my answer with a direct implementation (scoring the 66th spot on the
leader board for that day)\ldots and that was that for the ``competitive'' part.
But the real fun always starts after! When discussing with some friends, we
started talking about the trade-offs of different implementations and realized
that the extra dimensionality was no joke\ldots as you upped the number of
dimensions, the number of points you have to consider grow as
\includegraphics{https://latex.codecogs.com/png.latex?O\%28\%282t\%2B6\%29\%5Ed\%29},
and the number of neighbors of each point to check grows as
\includegraphics{https://latex.codecogs.com/png.latex?O\%283\%5Ed\%29}. So for
4D it's definitely possible to solve naively\ldots but anything higher is going
to strain.

To confirm, I ran my naive solution (running six time steps) on 5D, and then 6D
(which took three minute)\ldots and I had to quit out of my 7D attempt because
it took too long. At d=7 you have to consider 2186 neighbors for each of the
potential 61,222,0032 points\ldots that's no joke. d=7 seemed impossible on any
commercial hardware, but I had the dream that \emph{maybe}, with some
breakthroughs in optimization, we could one day hit d=10. But not naively,
checking 59,048 neighbors for each potential 357,046,722,6624 points.

And soon\ldots a breakthrough did come! Someone brought up that if we look at
the 3d version, we see there's actually a \emph{mirror symmetry}! That is,
because everything starts off on the xy plane, with z=0, the resulting
progression must be symmetrical on both sides (positive and negative z).

\begin{figure}
\centering
\includegraphics{/img/entries/advent-gol/life3d.gif}
\caption{d=3 animation by
\href{https://www.reddit.com/r/adventofcode/comments/kfa3nr/2020_day_17_godot_cubes_i_think_i_went_a_bit_too/}{u/ZuBsPaCe}}
\end{figure}

This means we can save the number of points by a factor of two for each extra
dimension\ldots that's a factor of 2 for d=3, a factor of 4 for d=4, and a
factor of 8 for d=5
(\includegraphics{https://latex.codecogs.com/png.latex?O\%282\%5E\%7Bd-2\%7D\%29})!
After implementing this, my d=7 ran in under six minutes, and my d=8 in 75
minutes.

Well, it didn't get us to d=10\ldots but this discovery completely changed how
we saw this puzzle. It made us believe that there were potentially more
breakthroughs we could get by exploiting interesting features in how the problem
was set up (starting with a 2D grid). We didn't know what those could be yet,
but suddenly, d=10 seemed attainable\ldots maybe?

And such a ``maybe'' (as posed in
\href{https://www.reddit.com/r/adventofcode/comments/kfb6zx/day_17_getting_to_t6_at_for_higher_spoilerss/}{this
reddit thread I started}) turned into a month-long quest of breakthrough after
breakthrough, exploiting different aspects of this 2d degeneracy! It was a long,
harrowing journey full of sudden twists and turns and bursts of excitement when
new innovations came. And in the end, the hopeful question ``What if d=10 was
possible?'' turned into ``d=10 in 100ms, d=40 in eight minutes.'' We even got
d=10 fast enough to run on easily any modern browser --- this post includes
those simulations! Furthermore, the whole journey became an adventure in the
power of visualization combined with abstract thinking.

So, let's take a deep dive --- deeper than you probably ever expected to dive
into any particular degenerate starting conditions of a hyper-dimensional game
of life :D

\hypertarget{the-baseline}{%
\section{The Baseline}\label{the-baseline}}

So let's start at the very beginning: how do you solve everything without
anything too fancy?

I discuss my basic Haskell method in
\href{https://github.com/mstksg/advent-of-code-2020/blob/master/reflections-out/day17.md}{this
write-up}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{{-}{-} | Given a neighbor set}
\OtherTok{neighbsSet ::} \DataTypeTok{Vector} \DataTypeTok{Int} \OtherTok{{-}>} \DataTypeTok{Set}\NormalTok{ (}\DataTypeTok{Vector} \DataTypeTok{Int}\NormalTok{)}
\NormalTok{neighbsSet }\OtherTok{=}\NormalTok{ S.fromList }\OperatorTok{.} \FunctionTok{tail} \OperatorTok{.} \FunctionTok{traverse}\NormalTok{ (\textbackslash{}x }\OtherTok{{-}>}\NormalTok{ [x,x}\OperatorTok{{-}}\DecValTok{1}\NormalTok{,x}\OperatorTok{+}\DecValTok{1}\NormalTok{])}

\OtherTok{neighborMap ::} \DataTypeTok{Set}\NormalTok{ (}\DataTypeTok{V3} \DataTypeTok{Int}\NormalTok{) }\OtherTok{{-}>} \DataTypeTok{Map}\NormalTok{ (}\DataTypeTok{V3} \DataTypeTok{Int}\NormalTok{) }\DataTypeTok{Int}
\NormalTok{neighborMap ps }\OtherTok{=}\NormalTok{ M.unionsWith (}\OperatorTok{+}\NormalTok{)}
\NormalTok{    [ M.fromSet (}\FunctionTok{const} \DecValTok{1}\NormalTok{) (neighbsSet p)}
    \OperatorTok{|}\NormalTok{ p }\OtherTok{<{-}}\NormalTok{ S.toList ps}
\NormalTok{    ]}

\NormalTok{stepper}
\OtherTok{    ::} \DataTypeTok{Set}\NormalTok{ (}\DataTypeTok{V3} \DataTypeTok{Int}\NormalTok{)}
    \OtherTok{{-}>} \DataTypeTok{Set}\NormalTok{ (}\DataTypeTok{V3} \DataTypeTok{Int}\NormalTok{)}
\NormalTok{stepper ps }\OtherTok{=}\NormalTok{ stayAlive }\OperatorTok{<>}\NormalTok{ comeAlive}
  \KeywordTok{where}
\NormalTok{    neighborCounts }\OtherTok{=}\NormalTok{ neighborMap ps}
\NormalTok{    stayAlive }\OtherTok{=}\NormalTok{ M.keysSet }\OperatorTok{.}\NormalTok{ M.filter (\textbackslash{}n }\OtherTok{{-}>}\NormalTok{ n }\OperatorTok{==} \DecValTok{2} \OperatorTok{||}\NormalTok{ n }\OperatorTok{==} \DecValTok{3}\NormalTok{) }\OperatorTok{$}
\NormalTok{                  neighborCounts }\OtherTok{\textasciigrave{}M.restrictKeys\textasciigrave{}}\NormalTok{ ps}
\NormalTok{    comeAlive }\OtherTok{=}\NormalTok{ M.keysSet }\OperatorTok{.}\NormalTok{ M.filter (}\OperatorTok{==} \DecValTok{3}\NormalTok{) }\OperatorTok{$}
\NormalTok{                  neighborCounts }\OtherTok{\textasciigrave{}M.withoutKeys\textasciigrave{}}\NormalTok{  ps}
\end{Highlighting}
\end{Shaded}

\leavevmode\hypertarget{golDrawer}{}%
Please enable Javascript

\leavevmode\hypertarget{gol2D}{}%
Please enable Javascript

\leavevmode\hypertarget{gol3D}{}%
Please enable Javascript

\leavevmode\hypertarget{gol4D}{}%
Please enable Javascript

\leavevmode\hypertarget{golFlat}{}%
Please enable Javascript

\leavevmode\hypertarget{golSyms3DForward}{}%
Please enable Javascript

\leavevmode\hypertarget{golSyms3DReverse}{}%
Please enable Javascript

\leavevmode\hypertarget{golSyms4DForward}{}%
Please enable Javascript

\leavevmode\hypertarget{golSyms4DReverse}{}%
Please enable Javascript

\leavevmode\hypertarget{golTreeForward}{}%
Please enable Javascript

\leavevmode\hypertarget{golTreeReverse}{}%
Please enable Javascript

\leavevmode\hypertarget{golSyms5D}{}%
Please enable Javascript

\begin{verbatim}
sim642  I wanted to ask this before but forgot: did anyone try to take advantage of the symmetry, e.g. in z axis in part 1?
sim642  Should halve the amount of calculations you have to do
sim642  Only some extra work at the end to differentiate z=0 and z>0 positions to know which to count twice
sim642  And in part 2 I feel like you could also exploit the symmetry in w axis simultaneously
\end{verbatim}

\hypertarget{signoff}{%
\section{Signoff}\label{signoff}}

Hi, thanks for reading! You can reach me via email at
\href{mailto:justin@jle.im}{\nolinkurl{justin@jle.im}}, or at twitter at
\href{https://twitter.com/mstk}{@mstk}! This post and all others are published
under the \href{https://creativecommons.org/licenses/by-nc-nd/3.0/}{CC-BY-NC-ND
3.0} license. Corrections and edits via pull request are welcome and encouraged
at \href{https://github.com/mstksg/inCode}{the source repository}.

If you feel inclined, or this post was particularly helpful for you, why not
consider \href{https://www.patreon.com/justinle/overview}{supporting me on
Patreon}, or a \href{bitcoin:3D7rmAYgbDnp4gp4rf22THsGt74fNucPDU}{BTC donation}?
:)

\end{document}
