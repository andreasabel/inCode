<!DOCTYPE HTML>
<html><head><title>Degenerate Hyper-Dimensional Game of Life: Pushing Advent of Code to its Limits · in Code</title><meta name="description" content="Weblog of Justin Le, covering various adventures in programming and explorations in the worlds of computation physics, and knowledge.
"><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><meta name="flattr:id" content="3p9jqr"><meta property="og:site_name" content="in Code"><meta property="og:description" content="tldr: By exploiting multiple mathematical properties of a “degenerate” hyper-dimensional game of life, each discovered one-by-one over the course of a month, we were able to go from “10 dimensions may just barely be possible” to “10 dimensions in 100ms, 50 dimensions tackled.” This is a story about breaking the degenerate hyper-dimensional game of life! Let’s travel back in time to the night before December 17, 2020: The release of “Conway Cubes”, day 17 of the “Advent of Code” of fun little coding puzzles building up to Christmas. One part I’ve always found especially fun is that, because the problems are so self-contained and tidy, they are often open-ended in the interesting ways you can solve them or expand them. On the surface, it seems to essentially be a straightforward expansion of Conway’s Game Of Life. GoL is a simulation played out on an infinite 2d grid, where certain cells are “on” and “off”, and at each step of the simulation, the on/off cells spread and propagate in fascinating ways. The twist of the Advent of Code puzzle is it asks what would happen if we played out the rules of GoL in 3d, and then 4d! The “starting conditions” are a 8x8 2D grid that every puzzle solver receives their own one of, and to solve the puzzle you must simulate six steps of GoL for your personal input and count the number of live cells at the end of it. For example, my xy starting conditions were #####..# #..###.# ###..... .#.#.#.. ##.#..#. ######.. .##..### ###.#### After 6 steps for 4-dimensional game of life, I had 2620 total points. I submitted my answer with a direct implementation (scoring the 66th spot on the leader board)…and that was that."><meta property="og:type" content="article"><meta property="og:title" content="Degenerate Hyper-Dimensional Game of Life: Pushing Advent of Code to its Limits"><meta property="og:image" content="https://blog.jle.im/img/site_logo.jpg"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://blog.jle.im/entry/degenerate-hyper-dimensional-game-of-life.html"><meta name="twitter:card" content="summary"><meta name="twitter:creator:id" content="mstk"><link rel="author" href="https://plus.google.com/107705320197444500140"><link rel="alternate" type="application/rss+xml" title="in Code (RSS Feed)" href="http://feeds.feedburner.com/incodeblog"><link rel="canonical" href="https://blog.jle.im/entry/degenerate-hyper-dimensional-game-of-life.html"><link href="https://blog.jle.im/favicon.ico" rel="shortcut icon"><link href="https://blog.jle.im/css/toast.css" rel="stylesheet" type="text/css"><link href="https://blog.jle.im/css/font.css" rel="stylesheet" type="text/css"><link href="https://blog.jle.im/css/main.css" rel="stylesheet" type="text/css"><link href="https://blog.jle.im/css/page/entry.css" rel="stylesheet" type="text/css"><link href="https://blog.jle.im/css/pygments.css" rel="stylesheet" type="text/css"><script type="text/javascript">var page_data = {};
var disqus_shortname='incode';
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-443711-8', 'jle.im');
ga('send', 'pageview');
</script><script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5234d67a6b68dcd4"></script><script type="text/javascript" src="https://blog.jle.im/js/page/entry_toc.js"></script><script type="text/javascript" src="https://blog.jle.im/js/disqus_count.js"></script><script type="text/javascript" src="https://blog.jle.im/js/social.js"></script><script type="text/javascript" src="https://blog.jle.im/js/jquery/jquery.toc.js"></script><script type="text/javascript" src="https://blog.jle.im/purescript/entry.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/d3@6.3.1"></script><script type="text/javascript" src="https://blog.jle.im/purescript/gol.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/d3-simple-slider@1.7.0"></script></head><body><div id="fb-root"><script>(function(d, s, id) {
 var js, fjs = d.getElementsByTagName(s)[0];
 if (d.getElementById(id)) return;
 js = d.createElement(s); js.id = id;
 js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=641852699171929";
 fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script></div><div id="header-container"><div id="navbar-container" class="tile"><nav id="navbar-content"><div class="nav-info"><h1 class="site-title"><a href="https://blog.jle.im/" class="nav-title">in Code</a></h1><span class="nav-author">Justin Le</span></div><ul class="nav-links"><li><a href="https://blog.jle.im/">home</a></li><li><a href="https://blog.jle.im/entries.html">archives</a></li><li><a href="https://cv.jle.im">cv</a></li><div class="clear"></div></ul></nav></div><div id="header-content"></div></div><div id="body-container" class="container"><div id="main-container" class="grid"><div class="entry-section unit span-grid" role="main"><article class="tile article"><header><div class="unposted-banner">Unposted entry</div><h1 id="title">Degenerate Hyper-Dimensional Game of Life: Pushing Advent of Code to its Limits</h1><p class="entry-info">by <a class="author" href="https://blog.jle.im/">Justin Le</a></p><p><span class="source-info"><a class="source-link" href="https://github.com/mstksg/inCode/tree/master/copy/entries/advent-gol.md">Source</a><span class="info-separator"> &diams; </span><a class="source-link" href="https://github.com/mstksg/inCode/tree/gh-pages/entry/degenerate-hyper-dimensional-game-of-life.md">Markdown</a><span class="info-separator"> &diams; </span><a class="source-link" href="https://blog.jle.im/entry/degenerate-hyper-dimensional-game-of-life.tex">LaTeX</a><span class="info-separator"> &diams; </span></span>Posted in <a href="https://blog.jle.im/entries/category/@haskell.html" class="tag-a-category" title="Functional, pure, non-strict, statically and strongly typed, natively
compiled...really just the king of great languages.">Haskell</a><span class="info-separator"> &diams; </span><a class="comment-link" href="#disqus_thread">Comments</a></p></header><hr><aside class="contents-container"><h5 id="contents-header">Contents</h5><div id="toc"></div></aside><div class="main-content copy-content"><p>tldr: By exploiting multiple mathematical properties of a “degenerate” hyper-dimensional game of life, each discovered one-by-one over the course of a month, we were able to go from “10 dimensions may just barely be possible” to “10 dimensions in 100ms, 50 dimensions tackled.”</p>
<p>This is a story about breaking the degenerate hyper-dimensional game of life! Let’s travel back in time to the night before December 17, 2020: The release of <a href="https://adventofcode.com/2020/day/17">“Conway Cubes”</a>, day 17 of the “Advent of Code” of fun little coding puzzles building up to Christmas. One part I’ve always found especially fun is that, because the problems are so self-contained and tidy, they are often <em>open-ended</em> in the interesting ways you can solve them or expand them.</p>
<p>On the surface, it seems to essentially be a straightforward expansion of <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Conway’s Game Of Life</a>. GoL is a simulation played out on an infinite 2d grid, where certain cells are “on” and “off”, and at each step of the simulation, the on/off cells spread and propagate in fascinating ways.</p>
<p>The twist of the Advent of Code puzzle is it asks what would happen if we played out the rules of GoL in 3d, and then 4d! The “starting conditions” are a 8x8 2D grid that every puzzle solver receives their own one of, and to solve the puzzle you must simulate six steps of GoL for your personal input and count the number of live cells at the end of it. For example, my xy starting conditions were</p>
<pre><code>#####..#
#..###.#
###.....
.#.#.#..
##.#..#.
######..
.##..###
###.####</code></pre>
<p>After 6 steps for 4-dimensional game of life, I had 2620 total points. I submitted my answer with a direct implementation (scoring the 66th spot on the leader board)…and that was that.</p>
<p>Simple enough, right? Afterwards, when discussing with some friends, we started talking about the trade-offs of different implementations and realized that dimensionality was no joke…as you upped the number of dimensions, the number of points you have to consider grow as <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?O%28%282t%2B8%29%5Ed%29" alt="O((2t+8)^d)" title="O((2t+8)^d)" />, and the number of neighbors of each point to check grows as <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?O%283%5Ed%29" alt="O(3^d)" title="O(3^d)" />… I took my solution for d=4 and could <em>barely</em> churn out d=6 (in three minutes), since even at d=6 you have to consider 728 neighbors for (potentially) each of the 64,000,000 points. I had a dream that t=6, d=10 just <em>might</em> be possible…but clearly not without some major breakthrough. After all, at d=10, you’d need to check 59,048 neighbors for potentially each of 10,240,000,000,000 points.</p>
<p>And…a breakthrough soon came. Someone brought up that if we look at the 3d version, we see there’s actually a <em>mirror symmetry</em>! That is, because everything starts off on the xy plane, with z=0 and w=0, the resulting progression must be symmetrical on both sides.</p>
<figure>
<img src="/img/entries/advent-gol/life3d.gif" title="d=3 animation u/ZuBsPaCe" alt="" /><figcaption>d=3 animation by <a href="https://www.reddit.com/r/adventofcode/comments/kfa3nr/2020_day_17_godot_cubes_i_think_i_went_a_bit_too/">u/ZuBsPaCe</a></figcaption>
</figure>
<p>This means that we only have to simulate <em>half</em> of the points (for each extra dimension) to get the answer, <em>halving</em> the number of points for d=3, saving a factor of 4 for d=4, saving a factor of 8 for d=5, etc. (<img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?O%282%5E%7Bd-2%7D%29" alt="O(2^{d-2})" title="O(2^{d-2})" />). After implementing this optimization, I was able to run d=7 in under <em>six minutes</em> (and d=8 in 75 minutes).</p>
<p>What’s more is that this made us realize that there were potentially more breakthroughs we could get by exploiting the fact that we are only given a 2d slice…we didn’t know what those could be yet, but suddenly, d=10 seemed attainable…maybe?</p>
<p>And such a “maybe” (as posed in <a href="https://www.reddit.com/r/adventofcode/comments/kfb6zx/day_17_getting_to_t6_at_for_higher_spoilerss/">this reddit thread I started</a>) turned into a month-long quest of breakthrough after breakthrough, exploting different aspects of this 2d degeneracy! It was a long, harrowing journey full of sudden twists and turns and bursts of excitement when new innovations came. And in the end, the hopeful question “What if d=10 was possible?” turned into “d=10 in 100ms, d=40 in eight minutes.”</p>
<p>So, let’s take a deep dive — deeper than you probably ever expected to dive into any particular degenerate starting conditions of a hyper-dimensional game of life :D</p>
<h2 id="the-baseline">The Baseline</h2>
<p>So let’s start at the very beginning: how do you solve everything without anything too fancy?</p>
<p>I discuss my basic Haskell method in <a href="https://github.com/mstksg/advent-of-code-2020/blob/master/reflections-out/day17.md">this write-up</a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">-- | Given a neighbor set</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="ot">neighbsSet ::</span> <span class="dt">Vector</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Set</span> (<span class="dt">Vector</span> <span class="dt">Int</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>neighbsSet <span class="ot">=</span> S.fromList <span class="op">.</span> <span class="fu">tail</span> <span class="op">.</span> <span class="fu">traverse</span> (\x <span class="ot">-&gt;</span> [x,x<span class="op">-</span><span class="dv">1</span>,x<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="ot">neighborMap ::</span> <span class="dt">Set</span> (<span class="dt">V3</span> <span class="dt">Int</span>) <span class="ot">-&gt;</span> <span class="dt">Map</span> (<span class="dt">V3</span> <span class="dt">Int</span>) <span class="dt">Int</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>neighborMap ps <span class="ot">=</span> M.unionsWith (<span class="op">+</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>    [ M.fromSet (<span class="fu">const</span> <span class="dv">1</span>) (neighbsSet p)</span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="op">|</span> p <span class="ot">&lt;-</span> S.toList ps</span>
<span id="cb2-9"><a href="#cb2-9"></a>    ]</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a>stepper</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="ot">    ::</span> <span class="dt">Set</span> (<span class="dt">V3</span> <span class="dt">Int</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="ot">-&gt;</span> <span class="dt">Set</span> (<span class="dt">V3</span> <span class="dt">Int</span>)</span>
<span id="cb2-14"><a href="#cb2-14"></a>stepper ps <span class="ot">=</span> stayAlive <span class="op">&lt;&gt;</span> comeAlive</span>
<span id="cb2-15"><a href="#cb2-15"></a>  <span class="kw">where</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    neighborCounts <span class="ot">=</span> neighborMap ps</span>
<span id="cb2-17"><a href="#cb2-17"></a>    stayAlive <span class="ot">=</span> M.keysSet <span class="op">.</span> M.filter (\n <span class="ot">-&gt;</span> n <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> n <span class="op">==</span> <span class="dv">3</span>) <span class="op">$</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>                  neighborCounts <span class="ot">`M.restrictKeys`</span> ps</span>
<span id="cb2-19"><a href="#cb2-19"></a>    comeAlive <span class="ot">=</span> M.keysSet <span class="op">.</span> M.filter (<span class="op">==</span> <span class="dv">3</span>) <span class="op">$</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>                  neighborCounts <span class="ot">`M.withoutKeys`</span>  ps</span></code></pre></div>
<div id="gol1">
<p>hi</p>
</div>
<pre><code>sim642  I wanted to ask this before but forgot: did anyone try to take advantage of the symmetry, e.g. in z axis in part 1?
sim642  Should halve the amount of calculations you have to do
sim642  Only some extra work at the end to differentiate z=0 and z&gt;0 positions to know which to count twice
sim642  And in part 2 I feel like you could also exploit the symmetry in w axis simultaneously</code></pre></div><footer><hr><div class="copy-content"><p>Hi, thanks for reading! You can reach me via email at <a href="mailto:justin@jle.im" class="email">justin@jle.im</a>, or at twitter at <a href="https://twitter.com/mstk">@mstk</a>! This post and all others are published under the <a href="https://creativecommons.org/licenses/by-nc-nd/3.0/">CC-BY-NC-ND 3.0</a> license. Corrections and edits via pull request are welcome and encouraged at <a href="https://github.com/mstksg/inCode">the source repository</a>.</p>
<p>If you feel inclined, or this post was particularly helpful for you, why not consider <a href="https://www.patreon.com/justinle/overview">supporting me on Patreon</a>, or a <a href="bitcoin:3D7rmAYgbDnp4gp4rf22THsGt74fNucPDU">BTC donation</a>? :)</p></div><div class="clear"></div><ul class="entry-series"><li><div>This entry is a part of a series called <b>&quot;Advent of Code&quot;</b>.  Find the rest of the entries in this series at its <a href="https://blog.jle.im/entries/series/+advent-of-code.html" class="tag-a-series" title="+Advent of Code"> series history</a>.</div></li></ul><ul class="tag-list"><li><a href="https://blog.jle.im/entries/tagged/advent-of-code.html" class="tag-a-tag">#advent of code</a></li><li><a href="https://blog.jle.im/entries/tagged/haskell.html" class="tag-a-tag">#haskell</a></li><li><a href="https://blog.jle.im/entries/category/@haskell.html" class="tag-a-category">@HASKELL</a></li><li><a href="https://blog.jle.im/entries/series/+advent-of-code.html" class="tag-a-series">+Advent of Code</a></li></ul><aside class="social-buttons"><div class="addthis_toolbox addthis_default_style addthis-buttons"><a class="addthis_button_facebook_like" fb:like:layout="button_count"></a><a class="addthis_button_tweet"></a><a class="addthis_button_google_plusone" g:plusone:size="medium"></a><a class="addthis_counter addthis_pill_style"></a></div><div class="custom-social-buttons"><div class="custom-social-button"><a href="https://www.reddit.com/submit" onclick="window.location = &#39;https://www.reddit.com/submit?url=&#39;+ encodeURIComponent(window.location); return false"><img src="https://www.reddit.com/static/spreddit7.gif" alt="submit to reddit"></a></div></div></aside><nav class="next-prev-links"><ul><li class="next-entry-link">(Next) <a href="https://blog.jle.im/entry/introducing-in-code.html">Introducing &quot;in Code&quot;!</a> &rarr;</li></ul></nav></footer></article><div class="post-entry"><div class="tile"><div id="disqus_thread"></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://blog.jle.im/entry/degenerate-hyper-dimensional-game-of-life.html';
    this.page.identifier = 'advent-gol';
};
(function() {
    var d = document, s = d.createElement('script');
    s.src = '//incode.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a><br></noscript><a href="http://disqus.com" class="dsq-brlink">Comments powered by <span class="logo-disqus">Disqus</span></a></div></div></div></div></div><div id="footer-container"><div id="footer-content"><div class="tile"><div class="footer-copyright">&copy; 2020 Justin Le <span class="license-link">(<a href="https://creativecommons.org/licenses/by-nc-nd/3.0/" class="license">CC-BY-NC-ND 3.0</a>)</span></div><div class="footer-follow social-follows"><ul class="social-follows-list"><li><ul class="social-follows-list-social"><li><a class="social-follow-twitter" title="Follow me on Twitter!" href="https://twitter.com/intent/user?user_id=mstk" onclick="window.open(
  &#39;http://twitter.com/intent/user?user_id=907281&#39;,
  &#39;facebook-share-dialog&#39;,
  &#39;width=550,height=520&#39;);
return false;
">Twitter</a></li><li><a class="social-follow-github" title="Fork me on Github!" href="https://github.com/mstksg">Github</a></li><li><a class="social-follow-twitch" title="Watch me on Twitch!" href="https://www.twitch.tv/justin_l">Twitch</a></li><li><a class="social-follow-patreon" title="Support me on Patreon!" href="https://www.patreon.com/justinle/overview">Patreon</a></li><li><a class="social-follow-gplus" title="Add me on Google+!" href="https://plus.google.com/+JustinLe">Google+</a></li><li><a class="social-follow-keybase" title="Track me on Keybase!" href="https://keybase.io/mstksg">Keybase</a></li><li><a class="social-follow-linkedin" title="Connect with me on LinkedIn!" href="https://linkedin.com/in/lejustin">LinkedIn</a></li><li><a class="social-follow-bitcoin" title="Donate via bitcoin!" href="bitcoin:3D7rmAYgbDnp4gp4rf22THsGt74fNucPDU">Bitcoin</a></li></ul></li><li><ul class="social-follows-list-site"><li><a class="social-follow-rss" title="Subscribe to my RSS Feed!" href="http://feeds.feedburner.com/incodeblog">RSS</a></li><li><a class="social-follow-email" title="Subscribe to the mailing list!" href="https://feedburner.google.com/fb/a/mailverify?loc=en_US&amp;uri=incodeblog">Mailing list</a></li></ul></li></ul></div></div></div></div></body></html>