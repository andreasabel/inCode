var PS={};(function($PS){"use strict";$PS["Control.Alt"]=$PS["Control.Alt"]||{};var exports=$PS["Control.Alt"],Alt=function(Functor0,alt){this.Functor0=Functor0;this.alt=alt};exports["Alt"]=Alt})(PS);(function($PS){"use strict";$PS["Control.Alternative"]=$PS["Control.Alternative"]||{};var exports=$PS["Control.Alternative"],Alternative=function(Applicative0,Plus1){this.Applicative0=Applicative0;this.Plus1=Plus1};exports["Alternative"]=Alternative})(PS);(function(exports){"use strict";exports.arrayApply=function(fs){return function(xs){var l=fs.length,k=xs.length,result=new Array(l*k),n=0;for(var i=0;i<l;i++){var f=fs[i];for(var j=0;j<k;j++)result[n++]=f(xs[j])};return result}}})(PS["Control.Apply"]=PS["Control.Apply"]||{});(function($PS){"use strict";$PS["Control.Semigroupoid"]=$PS["Control.Semigroupoid"]||{};var exports=$PS["Control.Semigroupoid"],Semigroupoid=function(compose){this.compose=compose},semigroupoidFn=new Semigroupoid(function(f){return function(g){return function(x){return f(g(x))}}}),compose=function(dict){return dict.compose};exports["compose"]=compose;exports["semigroupoidFn"]=semigroupoidFn})(PS);(function($PS){"use strict";$PS["Control.Category"]=$PS["Control.Category"]||{};var exports=$PS["Control.Category"],Control_Semigroupoid=$PS["Control.Semigroupoid"],Category=function(Semigroupoid0,identity){this.Semigroupoid0=Semigroupoid0;this.identity=identity},identity=function(dict){return dict.identity},categoryFn=new Category(function(){return Control_Semigroupoid.semigroupoidFn},function(x){return x});exports["identity"]=identity;exports["categoryFn"]=categoryFn})(PS);(function($PS){"use strict";$PS["Data.Function"]=$PS["Data.Function"]||{};var exports=$PS["Data.Function"],flip=function(f){return function(b){return function(a){return f(a)(b)}}},$$const=function(a){return function(v){return a}};exports["flip"]=flip;exports["const"]=$$const})(PS);(function(exports){"use strict";exports.arrayMap=function(f){return function(arr){var l=arr.length,result=new Array(l);for(var i=0;i<l;i++)result[i]=f(arr[i]);return result}}})(PS["Data.Functor"]=PS["Data.Functor"]||{});(function(exports){"use strict";exports.unit={}})(PS["Data.Unit"]=PS["Data.Unit"]||{});(function($PS){"use strict";$PS["Data.Unit"]=$PS["Data.Unit"]||{};var exports=$PS["Data.Unit"],$foreign=$PS["Data.Unit"];exports["unit"]=$foreign.unit})(PS);(function($PS){"use strict";$PS["Data.Functor"]=$PS["Data.Functor"]||{};var exports=$PS["Data.Functor"],$foreign=$PS["Data.Functor"],Data_Function=$PS["Data.Function"],Data_Unit=$PS["Data.Unit"],Functor=function(map){this.map=map},map=function(dict){return dict.map},$$void=function(dictFunctor){return map(dictFunctor)(Data_Function["const"](Data_Unit.unit))},voidRight=function(dictFunctor){return function(x){return map(dictFunctor)(Data_Function["const"](x))}},functorArray=new Functor($foreign.arrayMap);exports["Functor"]=Functor;exports["map"]=map;exports["void"]=$$void;exports["voidRight"]=voidRight;exports["functorArray"]=functorArray})(PS);(function($PS){"use strict";$PS["Control.Apply"]=$PS["Control.Apply"]||{};var exports=$PS["Control.Apply"],$foreign=$PS["Control.Apply"],Control_Category=$PS["Control.Category"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Apply=function(Functor0,apply){this.Functor0=Functor0;this.apply=apply},applyArray=new Apply(function(){return Data_Functor.functorArray},$foreign.arrayApply),apply=function(dict){return dict.apply},applySecond=function(dictApply){return function(a){return function(b){return apply(dictApply)(Data_Functor.map(dictApply.Functor0())(Data_Function["const"](Control_Category.identity(Control_Category.categoryFn)))(a))(b)}}};exports["Apply"]=Apply;exports["apply"]=apply;exports["applySecond"]=applySecond;exports["applyArray"]=applyArray})(PS);(function($PS){"use strict";$PS["Control.Applicative"]=$PS["Control.Applicative"]||{};var exports=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Data_Unit=$PS["Data.Unit"],Applicative=function(Apply0,pure){this.Apply0=Apply0;this.pure=pure},pure=function(dict){return dict.pure},unless=function(dictApplicative){return function(v){return function(v1){if(!v)return v1;if(v)return pure(dictApplicative)(Data_Unit.unit);throw new Error("Failed pattern match at Control.Applicative (line 62, column 1 - line 62, column 65): "+[v.constructor.name,v1.constructor.name])}}},liftA1=function(dictApplicative){return function(f){return function(a){return Control_Apply.apply(dictApplicative.Apply0())(pure(dictApplicative)(f))(a)}}};exports["Applicative"]=Applicative;exports["pure"]=pure;exports["liftA1"]=liftA1;exports["unless"]=unless})(PS);(function(exports){"use strict";exports.arrayBind=function(arr){return function(f){var result=[];for(var i=0,l=arr.length;i<l;i++)Array.prototype.push.apply(result,f(arr[i]));return result}}})(PS["Control.Bind"]=PS["Control.Bind"]||{});(function($PS){"use strict";$PS["Control.Bind"]=$PS["Control.Bind"]||{};var exports=$PS["Control.Bind"],$foreign=$PS["Control.Bind"],Control_Apply=$PS["Control.Apply"],Data_Function=$PS["Data.Function"],Discard=function(discard){this.discard=discard},Bind=function(Apply0,bind){this.Apply0=Apply0;this.bind=bind},discard=function(dict){return dict.discard},bindArray=new Bind(function(){return Control_Apply.applyArray},$foreign.arrayBind),bind=function(dict){return dict.bind},bindFlipped=function(dictBind){return Data_Function.flip(bind(dictBind))},discardUnit=new Discard(function(dictBind){return bind(dictBind)});exports["Bind"]=Bind;exports["bind"]=bind;exports["bindFlipped"]=bindFlipped;exports["discard"]=discard;exports["bindArray"]=bindArray;exports["discardUnit"]=discardUnit})(PS);(function($PS){"use strict";$PS["Control.Lazy"]=$PS["Control.Lazy"]||{};var exports=$PS["Control.Lazy"],Lazy=function(defer){this.defer=defer},defer=function(dict){return dict.defer},fix=function(dictLazy){return function(f){var go=defer(dictLazy)(function(v){return f(go)});return go}};exports["defer"]=defer;exports["Lazy"]=Lazy;exports["fix"]=fix})(PS);(function($PS){"use strict";$PS["Control.Monad"]=$PS["Control.Monad"]||{};var exports=$PS["Control.Monad"],Control_Applicative=$PS["Control.Applicative"],Control_Bind=$PS["Control.Bind"],Monad=function(Applicative0,Bind1){this.Applicative0=Applicative0;this.Bind1=Bind1},liftM1=function(dictMonad){return function(f){return function(a){return Control_Bind.bind(dictMonad.Bind1())(a)(function(a$prime){return Control_Applicative.pure(dictMonad.Applicative0())(f(a$prime))})}}},ap=function(dictMonad){return function(f){return function(a){return Control_Bind.bind(dictMonad.Bind1())(f)(function(f$prime){return Control_Bind.bind(dictMonad.Bind1())(a)(function(a$prime){return Control_Applicative.pure(dictMonad.Applicative0())(f$prime(a$prime))})})}}};exports["Monad"]=Monad;exports["liftM1"]=liftM1;exports["ap"]=ap})(PS);(function($PS){"use strict";$PS["Control.Monad.Trans.Class"]=$PS["Control.Monad.Trans.Class"]||{};var exports=$PS["Control.Monad.Trans.Class"],MonadTrans=function(lift){this.lift=lift},lift=function(dict){return dict.lift};exports["lift"]=lift;exports["MonadTrans"]=MonadTrans})(PS);(function($PS){"use strict";$PS["Data.Maybe"]=$PS["Data.Maybe"]||{};var exports=$PS["Data.Maybe"],Control_Category=$PS["Control.Category"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Nothing=(function(){function Nothing(){};Nothing.value=new Nothing();return Nothing})(),Just=(function(){function Just(value0){this.value0=value0};Just.create=function(value0){return new Just(value0)};return Just})(),maybe=function(v){return function(v1){return function(v2){if(v2 instanceof Nothing)return v;if(v2 instanceof Just)return v1(v2.value0);throw new Error("Failed pattern match at Data.Maybe (line 217, column 1 - line 217, column 51): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}},isNothing=maybe(true)(Data_Function["const"](false)),isJust=maybe(false)(Data_Function["const"](true)),functorMaybe=new Data_Functor.Functor(function(v){return function(v1){if(v1 instanceof Just)return new Just(v(v1.value0));return Nothing.value}}),fromMaybe=function(a){return maybe(a)(Control_Category.identity(Control_Category.categoryFn))},fromJust=function(dictPartial){return function(v){if(v instanceof Just)return v.value0;throw new Error("Failed pattern match at Data.Maybe (line 268, column 1 - line 268, column 46): "+[v.constructor.name])}};exports["Nothing"]=Nothing;exports["Just"]=Just;exports["maybe"]=maybe;exports["fromMaybe"]=fromMaybe;exports["isJust"]=isJust;exports["isNothing"]=isNothing;exports["fromJust"]=fromJust;exports["functorMaybe"]=functorMaybe})(PS);(function(exports){"use strict";exports.pureE=function(a){return function(){return a}};exports.bindE=function(a){return function(f){return function(){return f(a())()}}}})(PS["Effect"]=PS["Effect"]||{});(function($PS){"use strict";$PS["Effect"]=$PS["Effect"]||{};var exports=$PS["Effect"],$foreign=$PS["Effect"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Control_Monad=$PS["Control.Monad"],Data_Functor=$PS["Data.Functor"],monadEffect=new Control_Monad.Monad(function(){return applicativeEffect},function(){return bindEffect}),bindEffect=new Control_Bind.Bind(function(){return applyEffect},$foreign.bindE),applyEffect=new Control_Apply.Apply(function(){return functorEffect},Control_Monad.ap(monadEffect)),applicativeEffect=new Control_Applicative.Applicative(function(){return applyEffect},$foreign.pureE),functorEffect=new Data_Functor.Functor(Control_Applicative.liftA1(applicativeEffect));exports["functorEffect"]=functorEffect;exports["applicativeEffect"]=applicativeEffect;exports["bindEffect"]=bindEffect;exports["monadEffect"]=monadEffect})(PS);(function($PS){"use strict";$PS["Effect.Class"]=$PS["Effect.Class"]||{};var exports=$PS["Effect.Class"],Control_Category=$PS["Control.Category"],Effect=$PS["Effect"],MonadEffect=function(Monad0,liftEffect){this.Monad0=Monad0;this.liftEffect=liftEffect},monadEffectEffect=new MonadEffect(function(){return Effect.monadEffect},Control_Category.identity(Control_Category.categoryFn)),liftEffect=function(dict){return dict.liftEffect};exports["liftEffect"]=liftEffect;exports["MonadEffect"]=MonadEffect;exports["monadEffectEffect"]=monadEffectEffect})(PS);(function($PS){"use strict";$PS["Control.Monad.Maybe.Trans"]=$PS["Control.Monad.Maybe.Trans"]||{};var exports=$PS["Control.Monad.Maybe.Trans"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Control_Monad=$PS["Control.Monad"],Control_Monad_Trans_Class=$PS["Control.Monad.Trans.Class"],Data_Functor=$PS["Data.Functor"],Data_Maybe=$PS["Data.Maybe"],Effect_Class=$PS["Effect.Class"],MaybeT=function(x){return x},runMaybeT=function(v){return v},monadTransMaybeT=new Control_Monad_Trans_Class.MonadTrans(function(dictMonad){var $71=Control_Monad.liftM1(dictMonad)(Data_Maybe.Just.create);return function($72){return MaybeT($71($72))}}),functorMaybeT=function(dictFunctor){return new Data_Functor.Functor(function(f){return function(v){return Data_Functor.map(dictFunctor)(Data_Functor.map(Data_Maybe.functorMaybe)(f))(v)}})},monadMaybeT=function(dictMonad){return new Control_Monad.Monad(function(){return applicativeMaybeT(dictMonad)},function(){return bindMaybeT(dictMonad)})},bindMaybeT=function(dictMonad){return new Control_Bind.Bind(function(){return applyMaybeT(dictMonad)},function(v){return function(f){return Control_Bind.bind(dictMonad.Bind1())(v)(function(v1){if(v1 instanceof Data_Maybe.Nothing)return Control_Applicative.pure(dictMonad.Applicative0())(Data_Maybe.Nothing.value);if(v1 instanceof Data_Maybe.Just){var v2=f(v1.value0);return v2};throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 54, column 11 - line 56, column 42): "+[v1.constructor.name])})}})},applyMaybeT=function(dictMonad){return new Control_Apply.Apply(function(){return functorMaybeT(((dictMonad.Bind1()).Apply0()).Functor0())},Control_Monad.ap(monadMaybeT(dictMonad)))},applicativeMaybeT=function(dictMonad){return new Control_Applicative.Applicative(function(){return applyMaybeT(dictMonad)},(function(){var $73=Control_Applicative.pure(dictMonad.Applicative0());return function($74){return MaybeT($73(Data_Maybe.Just.create($74)))}})())},monadEffectMaybe=function(dictMonadEffect){return new Effect_Class.MonadEffect(function(){return monadMaybeT(dictMonadEffect.Monad0())},(function(){var $75=Control_Monad_Trans_Class.lift(monadTransMaybeT)(dictMonadEffect.Monad0()),$76=Effect_Class.liftEffect(dictMonadEffect);return function($77){return $75($76($77))}})())};exports["MaybeT"]=MaybeT;exports["runMaybeT"]=runMaybeT;exports["functorMaybeT"]=functorMaybeT;exports["applicativeMaybeT"]=applicativeMaybeT;exports["bindMaybeT"]=bindMaybeT;exports["monadEffectMaybe"]=monadEffectMaybe})(PS);(function($PS){"use strict";$PS["Control.Plus"]=$PS["Control.Plus"]||{};var exports=$PS["Control.Plus"],Plus=function(Alt0,empty){this.Alt0=Alt0;this.empty=empty},empty=function(dict){return dict.empty};exports["Plus"]=Plus;exports["empty"]=empty})(PS);(function($PS){"use strict";$PS["Control.MonadZero"]=$PS["Control.MonadZero"]||{};var exports=$PS["Control.MonadZero"],Control_Applicative=$PS["Control.Applicative"],Control_Plus=$PS["Control.Plus"],Data_Unit=$PS["Data.Unit"],MonadZero=function(Alternative1,Monad0){this.Alternative1=Alternative1;this.Monad0=Monad0},guard=function(dictMonadZero){return function(v){if(v)return Control_Applicative.pure((dictMonadZero.Alternative1()).Applicative0())(Data_Unit.unit);if(!v)return Control_Plus.empty((dictMonadZero.Alternative1()).Plus1());throw new Error("Failed pattern match at Control.MonadZero (line 54, column 1 - line 54, column 52): "+[v.constructor.name])}};exports["MonadZero"]=MonadZero;exports["guard"]=guard})(PS);(function(exports){"use strict";var replicateFill=function(count){return function(value){if(count<1)return[];var result=new Array(count);return result.fill(value)}},replicatePolyfill=function(count){return function(value){var result=[],n=0;for(var i=0;i<count;i++)result[n++]=value;return result}};exports.replicate=typeof Array.prototype.fill==="function"?replicateFill:replicatePolyfill;exports.fromFoldableImpl=(function(){function Cons(head,tail){this.head=head;this.tail=tail};var emptyList={};function curryCons(head){return function(tail){return new Cons(head,tail)}}
function listToArray(list){var result=[],count=0,xs=list;while(xs!==emptyList){result[count++]=xs.head;xs=xs.tail};return result};return function(foldr){return function(xs){return listToArray(foldr(curryCons)(emptyList)(xs))}}})();exports.length=function(xs){return xs.length};exports.indexImpl=function(just){return function(nothing){return function(xs){return function(i){return i<0||i>=xs.length?nothing:just(xs[i])}}}};exports.findIndexImpl=function(just){return function(nothing){return function(f){return function(xs){for(var i=0,l=xs.length;i<l;i++)if(f(xs[i]))return just(i);return nothing}}}};exports.filter=function(f){return function(xs){return xs.filter(f)}}})(PS["Data.Array"]=PS["Data.Array"]||{});(function(exports){"use strict";var refEq=function(r1){return function(r2){return r1===r2}};exports.eqBooleanImpl=refEq;exports.eqIntImpl=refEq;exports.eqCharImpl=refEq;exports.eqArrayImpl=function(f){return function(xs){return function(ys){if(xs===ys)return true;if(xs.length!==ys.length)return false;for(var i=0;i<xs.length;i++)if(!f(xs[i])(ys[i]))return false;return true}}}})(PS["Data.Eq"]=PS["Data.Eq"]||{});(function($PS){"use strict";$PS["Data.Symbol"]=$PS["Data.Symbol"]||{};var exports=$PS["Data.Symbol"],SProxy=(function(){function SProxy(){};SProxy.value=new SProxy();return SProxy})(),IsSymbol=function(reflectSymbol){this.reflectSymbol=reflectSymbol},reflectSymbol=function(dict){return dict.reflectSymbol};exports["IsSymbol"]=IsSymbol;exports["reflectSymbol"]=reflectSymbol;exports["SProxy"]=SProxy})(PS);(function(exports){"use strict";exports.unsafeGet=function(label){return function(rec){return rec[label]}}})(PS["Record.Unsafe"]=PS["Record.Unsafe"]||{});(function($PS){"use strict";$PS["Record.Unsafe"]=$PS["Record.Unsafe"]||{};var exports=$PS["Record.Unsafe"],$foreign=$PS["Record.Unsafe"];exports["unsafeGet"]=$foreign.unsafeGet})(PS);(function($PS){"use strict";$PS["Type.Data.RowList"]=$PS["Type.Data.RowList"]||{};var exports=$PS["Type.Data.RowList"],RLProxy=(function(){function RLProxy(){};RLProxy.value=new RLProxy();return RLProxy})();exports["RLProxy"]=RLProxy})(PS);(function($PS){"use strict";$PS["Data.Eq"]=$PS["Data.Eq"]||{};var exports=$PS["Data.Eq"],$foreign=$PS["Data.Eq"],Data_Symbol=$PS["Data.Symbol"],Record_Unsafe=$PS["Record.Unsafe"],Type_Data_RowList=$PS["Type.Data.RowList"],EqRecord=function(eqRecord){this.eqRecord=eqRecord},Eq1=function(eq1){this.eq1=eq1},Eq=function(eq){this.eq=eq},eqUnit=new Eq(function(v){return function(v1){return true}}),eqRowNil=new EqRecord(function(v){return function(v1){return function(v2){return true}}}),eqRecord=function(dict){return dict.eqRecord},eqRec=function(dictRowToList){return function(dictEqRecord){return new Eq(eqRecord(dictEqRecord)(Type_Data_RowList.RLProxy.value))}},eqInt=new Eq($foreign.eqIntImpl),eqChar=new Eq($foreign.eqCharImpl),eqBoolean=new Eq($foreign.eqBooleanImpl),eq1=function(dict){return dict.eq1},eq=function(dict){return dict.eq},eqArray=function(dictEq){return new Eq($foreign.eqArrayImpl(eq(dictEq)))},eqRowCons=function(dictEqRecord){return function(dictCons){return function(dictIsSymbol){return function(dictEq){return new EqRecord(function(v){return function(ra){return function(rb){var tail=eqRecord(dictEqRecord)(Type_Data_RowList.RLProxy.value)(ra)(rb),key=Data_Symbol.reflectSymbol(dictIsSymbol)(Data_Symbol.SProxy.value),get=Record_Unsafe.unsafeGet(key);return eq(dictEq)(get(ra))(get(rb))&&tail}}})}}}},notEq=function(dictEq){return function(x){return function(y){return eq(eqBoolean)(eq(dictEq)(x)(y))(false)}}};exports["Eq"]=Eq;exports["eq"]=eq;exports["notEq"]=notEq;exports["Eq1"]=Eq1;exports["eq1"]=eq1;exports["eqInt"]=eqInt;exports["eqChar"]=eqChar;exports["eqUnit"]=eqUnit;exports["eqArray"]=eqArray;exports["eqRec"]=eqRec;exports["eqRowNil"]=eqRowNil;exports["eqRowCons"]=eqRowCons})(PS);(function(exports){"use strict";exports.foldrArray=function(f){return function(init){return function(xs){var acc=init,len=xs.length;for(var i=len-1;i>=0;i--)acc=f(xs[i])(acc);return acc}}};exports.foldlArray=function(f){return function(init){return function(xs){var acc=init,len=xs.length;for(var i=0;i<len;i++)acc=f(acc)(xs[i]);return acc}}}})(PS["Data.Foldable"]=PS["Data.Foldable"]||{});(function(exports){"use strict";exports.concatString=function(s1){return function(s2){return s1+s2}}})(PS["Data.Semigroup"]=PS["Data.Semigroup"]||{});(function($PS){"use strict";$PS["Data.Semigroup"]=$PS["Data.Semigroup"]||{};var exports=$PS["Data.Semigroup"],$foreign=$PS["Data.Semigroup"],Semigroup=function(append){this.append=append},semigroupString=new Semigroup($foreign.concatString),append=function(dict){return dict.append};exports["Semigroup"]=Semigroup;exports["append"]=append;exports["semigroupString"]=semigroupString})(PS);(function($PS){"use strict";$PS["Data.Monoid"]=$PS["Data.Monoid"]||{};var exports=$PS["Data.Monoid"],Data_Semigroup=$PS["Data.Semigroup"],Monoid=function(Semigroup0,mempty){this.Semigroup0=Semigroup0;this.mempty=mempty},monoidString=new Monoid(function(){return Data_Semigroup.semigroupString},""),mempty=function(dict){return dict.mempty};exports["Monoid"]=Monoid;exports["mempty"]=mempty;exports["monoidString"]=monoidString})(PS);(function($PS){"use strict";$PS["Data.Monoid.Dual"]=$PS["Data.Monoid.Dual"]||{};var exports=$PS["Data.Monoid.Dual"],Data_Monoid=$PS["Data.Monoid"],Data_Semigroup=$PS["Data.Semigroup"],Dual=function(x){return x},semigroupDual=function(dictSemigroup){return new Data_Semigroup.Semigroup(function(v){return function(v1){return Data_Semigroup.append(dictSemigroup)(v1)(v)}})},monoidDual=function(dictMonoid){return new Data_Monoid.Monoid(function(){return semigroupDual(dictMonoid.Semigroup0())},Data_Monoid.mempty(dictMonoid))};exports["Dual"]=Dual;exports["monoidDual"]=monoidDual})(PS);(function($PS){"use strict";$PS["Data.Monoid.Endo"]=$PS["Data.Monoid.Endo"]||{};var exports=$PS["Data.Monoid.Endo"],Control_Category=$PS["Control.Category"],Control_Semigroupoid=$PS["Control.Semigroupoid"],Data_Monoid=$PS["Data.Monoid"],Data_Semigroup=$PS["Data.Semigroup"],Endo=function(x){return x},semigroupEndo=function(dictSemigroupoid){return new Data_Semigroup.Semigroup(function(v){return function(v1){return Control_Semigroupoid.compose(dictSemigroupoid)(v)(v1)}})},monoidEndo=function(dictCategory){return new Data_Monoid.Monoid(function(){return semigroupEndo(dictCategory.Semigroupoid0())},Control_Category.identity(dictCategory))};exports["Endo"]=Endo;exports["monoidEndo"]=monoidEndo})(PS);(function($PS){"use strict";$PS["Data.Newtype"]=$PS["Data.Newtype"]||{};var exports=$PS["Data.Newtype"],Data_Monoid_Dual=$PS["Data.Monoid.Dual"],Data_Monoid_Endo=$PS["Data.Monoid.Endo"],Newtype=function(unwrap,wrap){this.unwrap=unwrap;this.wrap=wrap},unwrap=function(dict){return dict.unwrap},newtypeEndo=new Newtype(function(v){return v},Data_Monoid_Endo.Endo),newtypeDual=new Newtype(function(v){return v},Data_Monoid_Dual.Dual);exports["unwrap"]=unwrap;exports["Newtype"]=Newtype;exports["newtypeDual"]=newtypeDual;exports["newtypeEndo"]=newtypeEndo})(PS);(function(exports){"use strict";exports.intAdd=function(x){return function(y){return x+y|0}};exports.intMul=function(x){return function(y){return x*y|0}}})(PS["Data.Semiring"]=PS["Data.Semiring"]||{});(function($PS){"use strict";$PS["Data.Semiring"]=$PS["Data.Semiring"]||{};var exports=$PS["Data.Semiring"],$foreign=$PS["Data.Semiring"],Semiring=function(add,mul,one,zero){this.add=add;this.mul=mul;this.one=one;this.zero=zero},zero=function(dict){return dict.zero},semiringInt=new Semiring($foreign.intAdd,$foreign.intMul,1,0),one=function(dict){return dict.one},mul=function(dict){return dict.mul},add=function(dict){return dict.add};exports["add"]=add;exports["zero"]=zero;exports["mul"]=mul;exports["one"]=one;exports["semiringInt"]=semiringInt})(PS);(function($PS){"use strict";$PS["Data.Foldable"]=$PS["Data.Foldable"]||{};var exports=$PS["Data.Foldable"],$foreign=$PS["Data.Foldable"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Category=$PS["Control.Category"],Data_Function=$PS["Data.Function"],Data_Maybe=$PS["Data.Maybe"],Data_Monoid=$PS["Data.Monoid"],Data_Monoid_Dual=$PS["Data.Monoid.Dual"],Data_Monoid_Endo=$PS["Data.Monoid.Endo"],Data_Newtype=$PS["Data.Newtype"],Data_Semigroup=$PS["Data.Semigroup"],Data_Semiring=$PS["Data.Semiring"],Data_Unit=$PS["Data.Unit"],Foldable=function(foldMap,foldl,foldr){this.foldMap=foldMap;this.foldl=foldl;this.foldr=foldr},foldr=function(dict){return dict.foldr},traverse_=function(dictApplicative){return function(dictFoldable){return function(f){return foldr(dictFoldable)((function(){var $197=Control_Apply.applySecond(dictApplicative.Apply0());return function($198){return $197(f($198))}})())(Control_Applicative.pure(dictApplicative)(Data_Unit.unit))}}},for_=function(dictApplicative){return function(dictFoldable){return Data_Function.flip(traverse_(dictApplicative)(dictFoldable))}},foldl=function(dict){return dict.foldl},intercalate=function(dictFoldable){return function(dictMonoid){return function(sep){return function(xs){var go=function(v){return function(x){if(v.init)return{init:false,acc:x};return{init:false,acc:Data_Semigroup.append(dictMonoid.Semigroup0())(v.acc)(Data_Semigroup.append(dictMonoid.Semigroup0())(sep)(x))}}};return(foldl(dictFoldable)(go)({init:true,acc:Data_Monoid.mempty(dictMonoid)})(xs)).acc}}}},product=function(dictFoldable){return function(dictSemiring){return foldl(dictFoldable)(Data_Semiring.mul(dictSemiring))(Data_Semiring.one(dictSemiring))}},sum=function(dictFoldable){return function(dictSemiring){return foldl(dictFoldable)(Data_Semiring.add(dictSemiring))(Data_Semiring.zero(dictSemiring))}},foldableMaybe=new Foldable(function(dictMonoid){return function(f){return function(v){if(v instanceof Data_Maybe.Nothing)return Data_Monoid.mempty(dictMonoid);if(v instanceof Data_Maybe.Just)return f(v.value0);throw new Error("Failed pattern match at Data.Foldable (line 129, column 1 - line 135, column 27): "+[f.constructor.name,v.constructor.name])}}},function(v){return function(z){return function(v1){if(v1 instanceof Data_Maybe.Nothing)return z;if(v1 instanceof Data_Maybe.Just)return v(z)(v1.value0);throw new Error("Failed pattern match at Data.Foldable (line 129, column 1 - line 135, column 27): "+[v.constructor.name,z.constructor.name,v1.constructor.name])}}},function(v){return function(z){return function(v1){if(v1 instanceof Data_Maybe.Nothing)return z;if(v1 instanceof Data_Maybe.Just)return v(v1.value0)(z);throw new Error("Failed pattern match at Data.Foldable (line 129, column 1 - line 135, column 27): "+[v.constructor.name,z.constructor.name,v1.constructor.name])}}}),foldMapDefaultR=function(dictFoldable){return function(dictMonoid){return function(f){return foldr(dictFoldable)(function(x){return function(acc){return Data_Semigroup.append(dictMonoid.Semigroup0())(f(x))(acc)}})(Data_Monoid.mempty(dictMonoid))}}},foldableArray=new Foldable(function(dictMonoid){return foldMapDefaultR(foldableArray)(dictMonoid)},$foreign.foldlArray,$foreign.foldrArray),foldMap=function(dict){return dict.foldMap},foldlDefault=function(dictFoldable){return function(c){return function(u){return function(xs){return Data_Newtype.unwrap(Data_Newtype.newtypeEndo)(Data_Newtype.unwrap(Data_Newtype.newtypeDual)(foldMap(dictFoldable)(Data_Monoid_Dual.monoidDual(Data_Monoid_Endo.monoidEndo(Control_Category.categoryFn)))((function(){var $201=Data_Function.flip(c);return function($202){return Data_Monoid_Dual.Dual(Data_Monoid_Endo.Endo($201($202)))}})())(xs)))(u)}}}},foldrDefault=function(dictFoldable){return function(c){return function(u){return function(xs){return Data_Newtype.unwrap(Data_Newtype.newtypeEndo)(foldMap(dictFoldable)(Data_Monoid_Endo.monoidEndo(Control_Category.categoryFn))(function($203){return Data_Monoid_Endo.Endo(c($203))})(xs))(u)}}}};exports["Foldable"]=Foldable;exports["foldr"]=foldr;exports["foldl"]=foldl;exports["foldMap"]=foldMap;exports["foldrDefault"]=foldrDefault;exports["foldlDefault"]=foldlDefault;exports["for_"]=for_;exports["intercalate"]=intercalate;exports["sum"]=sum;exports["product"]=product;exports["foldableArray"]=foldableArray;exports["foldableMaybe"]=foldableMaybe})(PS);(function($PS){"use strict";$PS["Data.Array"]=$PS["Data.Array"]||{};var exports=$PS["Data.Array"],$foreign=$PS["Data.Array"],Control_Bind=$PS["Control.Bind"],Control_Category=$PS["Control.Category"],Data_Eq=$PS["Data.Eq"],Data_Foldable=$PS["Data.Foldable"],Data_Function=$PS["Data.Function"],Data_Maybe=$PS["Data.Maybe"],singleton=function(a){return[a]},index=$foreign.indexImpl(Data_Maybe.Just.create)(Data_Maybe.Nothing.value),fromFoldable=function(dictFoldable){return $foreign.fromFoldableImpl(Data_Foldable.foldr(dictFoldable))},findIndex=$foreign.findIndexImpl(Data_Maybe.Just.create)(Data_Maybe.Nothing.value),elemIndex=function(dictEq){return function(x){return findIndex(function(v){return Data_Eq.eq(dictEq)(v)(x)})}},concatMap=Data_Function.flip(Control_Bind.bind(Control_Bind.bindArray)),mapMaybe=function(f){return concatMap((function(){var $94=Data_Maybe.maybe([])(singleton);return function($95){return $94(f($95))}})())},catMaybes=mapMaybe(Control_Category.identity(Control_Category.categoryFn));exports["fromFoldable"]=fromFoldable;exports["singleton"]=singleton;exports["index"]=index;exports["elemIndex"]=elemIndex;exports["catMaybes"]=catMaybes;exports["replicate"]=$foreign.replicate;exports["length"]=$foreign.length;exports["filter"]=$foreign.filter})(PS);(function($PS){"use strict";$PS["Data.Bifunctor"]=$PS["Data.Bifunctor"]||{};var exports=$PS["Data.Bifunctor"],Bifunctor=function(bimap){this.bimap=bimap},bimap=function(dict){return dict.bimap};exports["bimap"]=bimap;exports["Bifunctor"]=Bifunctor})(PS);(function($PS){"use strict";$PS["Data.Boolean"]=$PS["Data.Boolean"]||{};var exports=$PS["Data.Boolean"],otherwise=true;exports["otherwise"]=otherwise})(PS);(function(exports){"use strict";exports.topInt=2147483647;exports.bottomInt=-2147483648;exports.topChar=String.fromCharCode(65535);exports.bottomChar=String.fromCharCode(0)})(PS["Data.Bounded"]=PS["Data.Bounded"]||{});(function(exports){"use strict";var unsafeCompareImpl=function(lt){return function(eq){return function(gt){return function(x){return function(y){return x<y?lt:x===y?eq:gt}}}}};exports.ordIntImpl=unsafeCompareImpl;exports.ordCharImpl=unsafeCompareImpl})(PS["Data.Ord"]=PS["Data.Ord"]||{});(function($PS){"use strict";$PS["Data.Ordering"]=$PS["Data.Ordering"]||{};var exports=$PS["Data.Ordering"],Data_Eq=$PS["Data.Eq"],LT=(function(){function LT(){};LT.value=new LT();return LT})(),GT=(function(){function GT(){};GT.value=new GT();return GT})(),EQ=(function(){function EQ(){};EQ.value=new EQ();return EQ})(),eqOrdering=new Data_Eq.Eq(function(v){return function(v1){if(v instanceof LT&&v1 instanceof LT)return true;if(v instanceof GT&&v1 instanceof GT)return true;if(v instanceof EQ&&v1 instanceof EQ)return true;return false}});exports["LT"]=LT;exports["GT"]=GT;exports["EQ"]=EQ;exports["eqOrdering"]=eqOrdering})(PS);(function($PS){"use strict";$PS["Data.Ord"]=$PS["Data.Ord"]||{};var exports=$PS["Data.Ord"],$foreign=$PS["Data.Ord"],Data_Eq=$PS["Data.Eq"],Data_Ordering=$PS["Data.Ordering"],Data_Symbol=$PS["Data.Symbol"],Record_Unsafe=$PS["Record.Unsafe"],Type_Data_RowList=$PS["Type.Data.RowList"],OrdRecord=function(EqRecord0,compareRecord){this.EqRecord0=EqRecord0;this.compareRecord=compareRecord},Ord1=function(Eq10,compare1){this.Eq10=Eq10;this.compare1=compare1},Ord=function(Eq0,compare){this.Eq0=Eq0;this.compare=compare},ordRecordNil=new OrdRecord(function(){return Data_Eq.eqRowNil},function(v){return function(v1){return function(v2){return Data_Ordering.EQ.value}}}),ordInt=new Ord(function(){return Data_Eq.eqInt},$foreign.ordIntImpl(Data_Ordering.LT.value)(Data_Ordering.EQ.value)(Data_Ordering.GT.value)),ordChar=new Ord(function(){return Data_Eq.eqChar},$foreign.ordCharImpl(Data_Ordering.LT.value)(Data_Ordering.EQ.value)(Data_Ordering.GT.value)),compareRecord=function(dict){return dict.compareRecord},ordRecord=function(dictRowToList){return function(dictOrdRecord){return new Ord(function(){return Data_Eq.eqRec()(dictOrdRecord.EqRecord0())},compareRecord(dictOrdRecord)(Type_Data_RowList.RLProxy.value))}},compare1=function(dict){return dict.compare1},compare=function(dict){return dict.compare},max=function(dictOrd){return function(x){return function(y){var v=compare(dictOrd)(x)(y);if(v instanceof Data_Ordering.LT)return y;if(v instanceof Data_Ordering.EQ)return x;if(v instanceof Data_Ordering.GT)return x;throw new Error("Failed pattern match at Data.Ord (line 167, column 3 - line 170, column 12): "+[v.constructor.name])}}},min=function(dictOrd){return function(x){return function(y){var v=compare(dictOrd)(x)(y);if(v instanceof Data_Ordering.LT)return x;if(v instanceof Data_Ordering.EQ)return x;if(v instanceof Data_Ordering.GT)return y;throw new Error("Failed pattern match at Data.Ord (line 158, column 3 - line 161, column 12): "+[v.constructor.name])}}},ordRecordCons=function(dictOrdRecord){return function(dictCons){return function(dictIsSymbol){return function(dictOrd){return new OrdRecord(function(){return Data_Eq.eqRowCons(dictOrdRecord.EqRecord0())()(dictIsSymbol)(dictOrd.Eq0())},function(v){return function(ra){return function(rb){var key=Data_Symbol.reflectSymbol(dictIsSymbol)(Data_Symbol.SProxy.value),left=compare(dictOrd)(Record_Unsafe.unsafeGet(key)(ra))(Record_Unsafe.unsafeGet(key)(rb)),$49=Data_Eq.notEq(Data_Ordering.eqOrdering)(left)(Data_Ordering.EQ.value);if($49)return left;return compareRecord(dictOrdRecord)(Type_Data_RowList.RLProxy.value)(ra)(rb)}}})}}}};exports["Ord"]=Ord;exports["compare"]=compare;exports["Ord1"]=Ord1;exports["compare1"]=compare1;exports["min"]=min;exports["max"]=max;exports["ordInt"]=ordInt;exports["ordChar"]=ordChar;exports["ordRecordNil"]=ordRecordNil;exports["ordRecordCons"]=ordRecordCons;exports["ordRecord"]=ordRecord})(PS);(function($PS){"use strict";$PS["Data.Bounded"]=$PS["Data.Bounded"]||{};var exports=$PS["Data.Bounded"],$foreign=$PS["Data.Bounded"],Data_Ord=$PS["Data.Ord"],Bounded=function(Ord0,bottom,top){this.Ord0=Ord0;this.bottom=bottom;this.top=top},top=function(dict){return dict.top},boundedInt=new Bounded(function(){return Data_Ord.ordInt},$foreign.bottomInt,$foreign.topInt),boundedChar=new Bounded(function(){return Data_Ord.ordChar},$foreign.bottomChar,$foreign.topChar),bottom=function(dict){return dict.bottom};exports["bottom"]=bottom;exports["top"]=top;exports["boundedInt"]=boundedInt;exports["boundedChar"]=boundedChar})(PS);(function(exports){"use strict";exports.intSub=function(x){return function(y){return x-y|0}}})(PS["Data.Ring"]=PS["Data.Ring"]||{});(function($PS){"use strict";$PS["Data.Ring"]=$PS["Data.Ring"]||{};var exports=$PS["Data.Ring"],$foreign=$PS["Data.Ring"],Data_Semiring=$PS["Data.Semiring"],Ring=function(Semiring0,sub){this.Semiring0=Semiring0;this.sub=sub},ringInt=new Ring(function(){return Data_Semiring.semiringInt},$foreign.intSub);exports["ringInt"]=ringInt})(PS);(function($PS){"use strict";$PS["Data.CommutativeRing"]=$PS["Data.CommutativeRing"]||{};var exports=$PS["Data.CommutativeRing"],Data_Ring=$PS["Data.Ring"],CommutativeRing=function(Ring0){this.Ring0=Ring0},commutativeRingInt=new CommutativeRing(function(){return Data_Ring.ringInt});exports["commutativeRingInt"]=commutativeRingInt})(PS);(function(exports){"use strict";exports.toCharCode=function(c){return c.charCodeAt(0)};exports.fromCharCode=function(c){return String.fromCharCode(c)}})(PS["Data.Enum"]=PS["Data.Enum"]||{});(function($PS){"use strict";$PS["Data.Enum"]=$PS["Data.Enum"]||{};var exports=$PS["Data.Enum"],$foreign=$PS["Data.Enum"],Data_Bounded=$PS["Data.Bounded"],Data_Maybe=$PS["Data.Maybe"],Data_Ord=$PS["Data.Ord"],Enum=function(Ord0,pred,succ){this.Ord0=Ord0;this.pred=pred;this.succ=succ},BoundedEnum=function(Bounded0,Enum1,cardinality,fromEnum,toEnum){this.Bounded0=Bounded0;this.Enum1=Enum1;this.cardinality=cardinality;this.fromEnum=fromEnum;this.toEnum=toEnum},toEnum=function(dict){return dict.toEnum},fromEnum=function(dict){return dict.fromEnum},toEnumWithDefaults=function(dictBoundedEnum){return function(low){return function(high){return function(x){var v=toEnum(dictBoundedEnum)(x);if(v instanceof Data_Maybe.Just)return v.value0;if(v instanceof Data_Maybe.Nothing){var $54=x<fromEnum(dictBoundedEnum)(Data_Bounded.bottom(dictBoundedEnum.Bounded0()));if($54)return low;return high};throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[v.constructor.name])}}}},defaultSucc=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)+1|0)}}},defaultPred=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)-1|0)}}},charToEnum=function(v){if(v>=Data_Bounded.bottom(Data_Bounded.boundedInt)&&v<=Data_Bounded.top(Data_Bounded.boundedInt))return new Data_Maybe.Just($foreign.fromCharCode(v));return Data_Maybe.Nothing.value},enumChar=new Enum(function(){return Data_Ord.ordChar},defaultPred(charToEnum)($foreign.toCharCode),defaultSucc(charToEnum)($foreign.toCharCode)),boundedEnumChar=new BoundedEnum(function(){return Data_Bounded.boundedChar},function(){return enumChar},$foreign.toCharCode(Data_Bounded.top(Data_Bounded.boundedChar))-$foreign.toCharCode(Data_Bounded.bottom(Data_Bounded.boundedChar))|0,$foreign.toCharCode,charToEnum);exports["fromEnum"]=fromEnum;exports["toEnumWithDefaults"]=toEnumWithDefaults;exports["boundedEnumChar"]=boundedEnumChar})(PS);(function(exports){"use strict";exports.intDegree=function(x){return Math.min(Math.abs(x),2147483647)};exports.intDiv=function(x){return function(y){if(y===0)return 0;return y>0?Math.floor(x/y):-Math.floor(x/-y)}};exports.intMod=function(x){return function(y){if(y===0)return 0;var yy=Math.abs(y);return((x%yy)+yy)%yy}}})(PS["Data.EuclideanRing"]=PS["Data.EuclideanRing"]||{});(function($PS){"use strict";$PS["Data.EuclideanRing"]=$PS["Data.EuclideanRing"]||{};var exports=$PS["Data.EuclideanRing"],$foreign=$PS["Data.EuclideanRing"],Data_CommutativeRing=$PS["Data.CommutativeRing"],EuclideanRing=function(CommutativeRing0,degree,div,mod){this.CommutativeRing0=CommutativeRing0;this.degree=degree;this.div=div;this.mod=mod},mod=function(dict){return dict.mod},euclideanRingInt=new EuclideanRing(function(){return Data_CommutativeRing.commutativeRingInt},$foreign.intDegree,$foreign.intDiv,$foreign.intMod),div=function(dict){return dict.div};exports["div"]=div;exports["mod"]=mod;exports["euclideanRingInt"]=euclideanRingInt})(PS);(function($PS){"use strict";$PS["Data.FoldableWithIndex"]=$PS["Data.FoldableWithIndex"]||{};var exports=$PS["Data.FoldableWithIndex"],FoldableWithIndex=function(Foldable0,foldMapWithIndex,foldlWithIndex,foldrWithIndex){this.Foldable0=Foldable0;this.foldMapWithIndex=foldMapWithIndex;this.foldlWithIndex=foldlWithIndex;this.foldrWithIndex=foldrWithIndex},foldrWithIndex=function(dict){return dict.foldrWithIndex};exports["FoldableWithIndex"]=FoldableWithIndex;exports["foldrWithIndex"]=foldrWithIndex})(PS);(function(exports){"use strict";exports.runFn2=function(fn){return function(a){return function(b){return fn(a,b)}}};exports.runFn4=function(fn){return function(a){return function(b){return function(c){return function(d){return fn(a,b,c,d)}}}}}})(PS["Data.Function.Uncurried"]=PS["Data.Function.Uncurried"]||{});(function($PS){"use strict";$PS["Data.Function.Uncurried"]=$PS["Data.Function.Uncurried"]||{};var exports=$PS["Data.Function.Uncurried"],$foreign=$PS["Data.Function.Uncurried"];exports["runFn2"]=$foreign.runFn2;exports["runFn4"]=$foreign.runFn4})(PS);(function(exports){"use strict";exports.pow=function(x){return function(y){return Math.pow(x,y)|0}}})(PS["Data.Int"]=PS["Data.Int"]||{});(function($PS){"use strict";$PS["Data.Int"]=$PS["Data.Int"]||{};var exports=$PS["Data.Int"],$foreign=$PS["Data.Int"];exports["pow"]=$foreign.pow})(PS);(function(exports){"use strict";exports.defer=function(thunk){var v=null;return function(){if(thunk===undefined)return v;v=thunk();thunk=undefined;return v}};exports.force=function(l){return l()}})(PS["Data.Lazy"]=PS["Data.Lazy"]||{});(function($PS){"use strict";$PS["Data.Lazy"]=$PS["Data.Lazy"]||{};var exports=$PS["Data.Lazy"],$foreign=$PS["Data.Lazy"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Data_Functor=$PS["Data.Functor"],functorLazy=new Data_Functor.Functor(function(f){return function(l){return $foreign.defer(function(v){return f($foreign.force(l))})}}),applyLazy=new Control_Apply.Apply(function(){return functorLazy},function(f){return function(x){return $foreign.defer(function(v){return $foreign.force(f)($foreign.force(x))})}}),bindLazy=new Control_Bind.Bind(function(){return applyLazy},function(l){return function(f){return $foreign.defer(function(v){return $foreign.force(f($foreign.force(l)))})}}),applicativeLazy=new Control_Applicative.Applicative(function(){return applyLazy},function(a){return $foreign.defer(function(v){return a})});exports["functorLazy"]=functorLazy;exports["applyLazy"]=applyLazy;exports["applicativeLazy"]=applicativeLazy;exports["bindLazy"]=bindLazy;exports["defer"]=$foreign.defer;exports["force"]=$foreign.force})(PS);(function(exports){"use strict";exports.unfoldrArrayImpl=function(isNothing){return function(fromJust){return function(fst){return function(snd){return function(f){return function(b){var result=[],value=b;while(true){var maybe=f(value);if(isNothing(maybe))return result;var tuple=fromJust(maybe);result.push(fst(tuple));value=snd(tuple)}}}}}}}})(PS["Data.Unfoldable"]=PS["Data.Unfoldable"]||{});(function($PS){"use strict";$PS["Data.Tuple"]=$PS["Data.Tuple"]||{};var exports=$PS["Data.Tuple"],Data_Bifunctor=$PS["Data.Bifunctor"],Data_Eq=$PS["Data.Eq"],Data_Functor=$PS["Data.Functor"],Tuple=(function(){function Tuple(value0,value1){this.value0=value0;this.value1=value1};Tuple.create=function(value0){return function(value1){return new Tuple(value0,value1)}};return Tuple})(),uncurry=function(f){return function(v){return f(v.value0)(v.value1)}},snd=function(v){return v.value1},functorTuple=new Data_Functor.Functor(function(f){return function(m){return new Tuple(m.value0,f(m.value1))}}),fst=function(v){return v.value0},eqTuple=function(dictEq){return function(dictEq1){return new Data_Eq.Eq(function(x){return function(y){return Data_Eq.eq(dictEq)(x.value0)(y.value0)&&Data_Eq.eq(dictEq1)(x.value1)(y.value1)}})}},bifunctorTuple=new Data_Bifunctor.Bifunctor(function(f){return function(g){return function(v){return new Tuple(f(v.value0),g(v.value1))}}});exports["Tuple"]=Tuple;exports["fst"]=fst;exports["snd"]=snd;exports["uncurry"]=uncurry;exports["eqTuple"]=eqTuple;exports["functorTuple"]=functorTuple;exports["bifunctorTuple"]=bifunctorTuple})(PS);(function(exports){"use strict";exports.unfoldr1ArrayImpl=function(isNothing){return function(fromJust){return function(fst){return function(snd){return function(f){return function(b){var result=[],value=b;while(true){var tuple=f(value);result.push(fst(tuple));var maybe=snd(tuple);if(isNothing(maybe))return result;value=fromJust(maybe)}}}}}}}})(PS["Data.Unfoldable1"]=PS["Data.Unfoldable1"]||{});(function($PS){"use strict";$PS["Data.Unfoldable1"]=$PS["Data.Unfoldable1"]||{};var exports=$PS["Data.Unfoldable1"],$foreign=$PS["Data.Unfoldable1"],Data_Maybe=$PS["Data.Maybe"],Data_Tuple=$PS["Data.Tuple"],Unfoldable1=function(unfoldr1){this.unfoldr1=unfoldr1},unfoldable1Array=new Unfoldable1($foreign.unfoldr1ArrayImpl(Data_Maybe.isNothing)(Data_Maybe.fromJust())(Data_Tuple.fst)(Data_Tuple.snd));exports["Unfoldable1"]=Unfoldable1;exports["unfoldable1Array"]=unfoldable1Array})(PS);(function($PS){"use strict";$PS["Data.Unfoldable"]=$PS["Data.Unfoldable"]||{};var exports=$PS["Data.Unfoldable"],$foreign=$PS["Data.Unfoldable"],Data_Maybe=$PS["Data.Maybe"],Data_Tuple=$PS["Data.Tuple"],Data_Unfoldable1=$PS["Data.Unfoldable1"],Unfoldable=function(Unfoldable10,unfoldr){this.Unfoldable10=Unfoldable10;this.unfoldr=unfoldr},unfoldr=function(dict){return dict.unfoldr},unfoldableArray=new Unfoldable(function(){return Data_Unfoldable1.unfoldable1Array},$foreign.unfoldrArrayImpl(Data_Maybe.isNothing)(Data_Maybe.fromJust())(Data_Tuple.fst)(Data_Tuple.snd));exports["Unfoldable"]=Unfoldable;exports["unfoldr"]=unfoldr;exports["unfoldableArray"]=unfoldableArray})(PS);(function($PS){"use strict";$PS["Data.List.Lazy.Types"]=$PS["Data.List.Lazy.Types"]||{};var exports=$PS["Data.List.Lazy.Types"],Control_Alt=$PS["Control.Alt"],Control_Alternative=$PS["Control.Alternative"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Control_Lazy=$PS["Control.Lazy"],Control_Monad=$PS["Control.Monad"],Control_MonadZero=$PS["Control.MonadZero"],Control_Plus=$PS["Control.Plus"],Data_Foldable=$PS["Data.Foldable"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Data_Lazy=$PS["Data.Lazy"],Data_Maybe=$PS["Data.Maybe"],Data_Monoid=$PS["Data.Monoid"],Data_Newtype=$PS["Data.Newtype"],Data_Semigroup=$PS["Data.Semigroup"],Data_Unfoldable=$PS["Data.Unfoldable"],Data_Unfoldable1=$PS["Data.Unfoldable1"],List=function(x){return x},Nil=(function(){function Nil(){};Nil.value=new Nil();return Nil})(),Cons=(function(){function Cons(value0,value1){this.value0=value0;this.value1=value1};Cons.create=function(value0){return function(value1){return new Cons(value0,value1)}};return Cons})(),nil=List(Data_Lazy.defer(function(v){return Nil.value})),newtypeList=new Data_Newtype.Newtype(function(n){return n},List),step=(function(){var $215=Data_Newtype.unwrap(newtypeList);return function($216){return Data_Lazy.force($215($216))}})(),semigroupList=new Data_Semigroup.Semigroup(function(xs){return function(ys){var go=function(v){if(v instanceof Nil)return step(ys);if(v instanceof Cons)return new Cons(v.value0,Data_Semigroup.append(semigroupList)(v.value1)(ys));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 98, column 5 - line 98, column 21): "+[v.constructor.name])};return Data_Functor.map(Data_Lazy.functorLazy)(go)(Data_Newtype.unwrap(newtypeList)(xs))}}),monoidList=new Data_Monoid.Monoid(function(){return semigroupList},nil),lazyList=new Control_Lazy.Lazy(function(f){return List(Data_Lazy.defer(function($217){return step(f($217))}))}),functorList=new Data_Functor.Functor(function(f){return function(xs){var go=function(v){if(v instanceof Nil)return Nil.value;if(v instanceof Cons)return new Cons(f(v.value0),Data_Functor.map(functorList)(f)(v.value1));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 107, column 5 - line 107, column 17): "+[v.constructor.name])};return Data_Functor.map(Data_Lazy.functorLazy)(go)(Data_Newtype.unwrap(newtypeList)(xs))}}),cons=function(x){return function(xs){return List(Data_Lazy.defer(function(v){return new Cons(x,xs)}))}},foldableList=new Data_Foldable.Foldable(function(dictMonoid){return function(f){return Data_Foldable.foldl(foldableList)(function(b){return function(a){return Data_Semigroup.append(dictMonoid.Semigroup0())(b)(f(a))}})(Data_Monoid.mempty(dictMonoid))}},function(op){var go=function($copy_b){return function($copy_xs){var $tco_var_b=$copy_b,$tco_done=false,$tco_result;function $tco_loop(b,xs){var v=step(xs);if(v instanceof Nil){$tco_done=true;return b};if(v instanceof Cons){$tco_var_b=op(b)(v.value0);$copy_xs=v.value1;return};throw new Error("Failed pattern match at Data.List.Lazy.Types (line 122, column 7 - line 124, column 40): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_b,$copy_xs);return $tco_result}};return go},function(op){return function(z){return function(xs){var rev=Data_Foldable.foldl(foldableList)(Data_Function.flip(cons))(nil);return Data_Foldable.foldl(foldableList)(Data_Function.flip(op))(z)(rev(xs))}}}),unfoldable1List=new Data_Unfoldable1.Unfoldable1((function(){var go=function(f){return function(b){return Control_Lazy.defer(lazyList)(function(v){var v1=f(b);if(v1.value1 instanceof Data_Maybe.Just)return cons(v1.value0)(go(f)(v1.value1.value0));if(v1.value1 instanceof Data_Maybe.Nothing)return cons(v1.value0)(nil);throw new Error("Failed pattern match at Data.List.Lazy.Types (line 146, column 28 - line 148, column 33): "+[v1.constructor.name])})}};return go})()),unfoldableList=new Data_Unfoldable.Unfoldable(function(){return unfoldable1List},(function(){var go=function(f){return function(b){return Control_Lazy.defer(lazyList)(function(v){var v1=f(b);if(v1 instanceof Data_Maybe.Nothing)return nil;if(v1 instanceof Data_Maybe.Just)return cons(v1.value0.value0)(go(f)(v1.value0.value1));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 152, column 28 - line 154, column 39): "+[v1.constructor.name])})}};return go})()),monadList=new Control_Monad.Monad(function(){return applicativeList},function(){return bindList}),bindList=new Control_Bind.Bind(function(){return applyList},function(xs){return function(f){var go=function(v){if(v instanceof Nil)return Nil.value;if(v instanceof Cons)return step(Data_Semigroup.append(semigroupList)(f(v.value0))(Control_Bind.bind(bindList)(v.value1)(f)));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 175, column 5 - line 175, column 17): "+[v.constructor.name])};return Data_Functor.map(Data_Lazy.functorLazy)(go)(Data_Newtype.unwrap(newtypeList)(xs))}}),applyList=new Control_Apply.Apply(function(){return functorList},Control_Monad.ap(monadList)),applicativeList=new Control_Applicative.Applicative(function(){return applyList},function(a){return cons(a)(nil)}),altList=new Control_Alt.Alt(function(){return functorList},Data_Semigroup.append(semigroupList)),plusList=new Control_Plus.Plus(function(){return altList},nil),alternativeList=new Control_Alternative.Alternative(function(){return applicativeList},function(){return plusList}),monadZeroList=new Control_MonadZero.MonadZero(function(){return alternativeList},function(){return monadList});exports["List"]=List;exports["Nil"]=Nil;exports["Cons"]=Cons;exports["step"]=step;exports["nil"]=nil;exports["cons"]=cons;exports["newtypeList"]=newtypeList;exports["lazyList"]=lazyList;exports["semigroupList"]=semigroupList;exports["monoidList"]=monoidList;exports["functorList"]=functorList;exports["foldableList"]=foldableList;exports["unfoldableList"]=unfoldableList;exports["applicativeList"]=applicativeList;exports["bindList"]=bindList;exports["monadZeroList"]=monadZeroList})(PS);(function($PS){"use strict";$PS["Data.List.Lazy"]=$PS["Data.List.Lazy"]||{};var exports=$PS["Data.List.Lazy"],Control_Apply=$PS["Control.Apply"],Control_Lazy=$PS["Control.Lazy"],Data_Boolean=$PS["Data.Boolean"],Data_Foldable=$PS["Data.Foldable"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Data_Lazy=$PS["Data.Lazy"],Data_List_Lazy_Types=$PS["Data.List.Lazy.Types"],Data_Maybe=$PS["Data.Maybe"],Data_Newtype=$PS["Data.Newtype"],Data_Tuple=$PS["Data.Tuple"],Data_Unfoldable=$PS["Data.Unfoldable"],zipWith=function(f){return function(xs){return function(ys){var go=function(v){return function(v1){if(v instanceof Data_List_Lazy_Types.Nil)return Data_List_Lazy_Types.Nil.value;if(v1 instanceof Data_List_Lazy_Types.Nil)return Data_List_Lazy_Types.Nil.value;if(v instanceof Data_List_Lazy_Types.Cons&&v1 instanceof Data_List_Lazy_Types.Cons)return new Data_List_Lazy_Types.Cons(f(v.value0)(v1.value0),zipWith(f)(v.value1)(v1.value1));throw new Error("Failed pattern match at Data.List.Lazy (line 693, column 3 - line 693, column 35): "+[v.constructor.name,v1.constructor.name])}};return Control_Apply.apply(Data_Lazy.applyLazy)(Data_Functor.map(Data_Lazy.functorLazy)(go)(Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList)(xs)))(Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList)(ys))}}},zip=zipWith(Data_Tuple.Tuple.create),uncons=function(xs){var v=Data_List_Lazy_Types.step(xs);if(v instanceof Data_List_Lazy_Types.Nil)return Data_Maybe.Nothing.value;if(v instanceof Data_List_Lazy_Types.Cons)return new Data_Maybe.Just({head:v.value0,tail:v.value1});throw new Error("Failed pattern match at Data.List.Lazy (line 285, column 13 - line 287, column 44): "+[v.constructor.name])},take=function(n){var go=function(v){return function(v1){if(v1 instanceof Data_List_Lazy_Types.Nil)return Data_List_Lazy_Types.Nil.value;if(v1 instanceof Data_List_Lazy_Types.Cons)return new Data_List_Lazy_Types.Cons(v1.value0,take(v-1|0)(v1.value1));throw new Error("Failed pattern match at Data.List.Lazy (line 517, column 3 - line 517, column 32): "+[v.constructor.name,v1.constructor.name])}},$119=n<=0;if($119)return Data_Function["const"](Data_List_Lazy_Types.nil);var $242=Data_Functor.map(Data_Lazy.functorLazy)(go(n)),$243=Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList);return function($244){return Data_List_Lazy_Types.List($242($243($244)))}},tail=function(xs){return Data_Functor.map(Data_Maybe.functorMaybe)(function(v){return v.tail})(uncons(xs))},singleton=function(a){return Data_List_Lazy_Types.cons(a)(Data_List_Lazy_Types.nil)},reverse=function(xs){return Control_Lazy.defer(Data_List_Lazy_Types.lazyList)(function(v){return Data_Foldable.foldl(Data_List_Lazy_Types.foldableList)(Data_Function.flip(Data_List_Lazy_Types.cons))(Data_List_Lazy_Types.nil)(xs)})},repeat=function(x){return Control_Lazy.fix(Data_List_Lazy_Types.lazyList)(function(xs){return Data_List_Lazy_Types.cons(x)(xs)})},range=function(start){return function(end){if(start>end){var g=function(x){if(x>=end)return new Data_Maybe.Just(new Data_Tuple.Tuple(x,x-1|0));if(Data_Boolean.otherwise)return Data_Maybe.Nothing.value;throw new Error("Failed pattern match at Data.List.Lazy (line 148, column 13 - line 149, column 38): "+[x.constructor.name])};return Data_Unfoldable.unfoldr(Data_List_Lazy_Types.unfoldableList)(g)(start)};if(Data_Boolean.otherwise){var f=function(x){if(x<=end)return new Data_Maybe.Just(new Data_Tuple.Tuple(x,x+1|0));if(Data_Boolean.otherwise)return Data_Maybe.Nothing.value;throw new Error("Failed pattern match at Data.List.Lazy (line 153, column 5 - line 154, column 30): "+[x.constructor.name])};return Data_Unfoldable.unfoldr(Data_List_Lazy_Types.unfoldableList)(f)(start)};throw new Error("Failed pattern match at Data.List.Lazy (line 145, column 1 - line 145, column 32): "+[start.constructor.name,end.constructor.name])}},mapMaybe=function(f){var go=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Data_List_Lazy_Types.Nil){$tco_done=true;return Data_List_Lazy_Types.Nil.value};if(v instanceof Data_List_Lazy_Types.Cons){var v1=f(v.value0);if(v1 instanceof Data_Maybe.Nothing){$copy_v=Data_List_Lazy_Types.step(v.value1);return};if(v1 instanceof Data_Maybe.Just){$tco_done=true;return new Data_List_Lazy_Types.Cons(v1.value0,mapMaybe(f)(v.value1))};throw new Error("Failed pattern match at Data.List.Lazy (line 460, column 5 - line 462, column 39): "+[v1.constructor.name])};throw new Error("Failed pattern match at Data.List.Lazy (line 458, column 3 - line 458, column 15): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result},$246=Data_Functor.map(Data_Lazy.functorLazy)(go),$247=Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList);return function($248){return Data_List_Lazy_Types.List($246($247($248)))}},iterate=function(f){return function(x){return Control_Lazy.fix(Data_List_Lazy_Types.lazyList)(function(xs){return Data_List_Lazy_Types.cons(x)(Data_Functor.map(Data_List_Lazy_Types.functorList)(f)(xs))})}},head=function(xs){return Data_Functor.map(Data_Maybe.functorMaybe)(function(v){return v.head})(uncons(xs))},transpose=function(xs){var v=uncons(xs);if(v instanceof Data_Maybe.Nothing)return xs;if(v instanceof Data_Maybe.Just){var v1=uncons(v.value0.head);if(v1 instanceof Data_Maybe.Nothing)return transpose(v.value0.tail);if(v1 instanceof Data_Maybe.Just)return Data_List_Lazy_Types.cons(Data_List_Lazy_Types.cons(v1.value0.head)(mapMaybe(head)(v.value0.tail)))(transpose(Data_List_Lazy_Types.cons(v1.value0.tail)(mapMaybe(tail)(v.value0.tail))));throw new Error("Failed pattern match at Data.List.Lazy (line 734, column 7 - line 738, column 72): "+[v1.constructor.name])};throw new Error("Failed pattern match at Data.List.Lazy (line 730, column 3 - line 738, column 72): "+[v.constructor.name])},fromFoldable=function(dictFoldable){return Data_Foldable.foldr(dictFoldable)(Data_List_Lazy_Types.cons)(Data_List_Lazy_Types.nil)},drop=function(n){var go=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v,$tco_done=false,$tco_result;function $tco_loop(v,v1){if(v===0){$tco_done=true;return v1};if(v1 instanceof Data_List_Lazy_Types.Nil){$tco_done=true;return Data_List_Lazy_Types.Nil.value};if(v1 instanceof Data_List_Lazy_Types.Cons){$tco_var_v=v-1|0;$copy_v1=Data_List_Lazy_Types.step(v1.value1);return};throw new Error("Failed pattern match at Data.List.Lazy (line 536, column 3 - line 536, column 15): "+[v.constructor.name,v1.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$copy_v1);return $tco_result}},$263=Data_Functor.map(Data_Lazy.functorLazy)(go(n)),$264=Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList);return function($265){return Data_List_Lazy_Types.List($263($264($265)))}};exports["fromFoldable"]=fromFoldable;exports["singleton"]=singleton;exports["range"]=range;exports["repeat"]=repeat;exports["iterate"]=iterate;exports["reverse"]=reverse;exports["mapMaybe"]=mapMaybe;exports["take"]=take;exports["drop"]=drop;exports["zipWith"]=zipWith;exports["zip"]=zip;exports["transpose"]=transpose})(PS);(function($PS){"use strict";$PS["Data.List.Types"]=$PS["Data.List.Types"]||{};var exports=$PS["Data.List.Types"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Data_Eq=$PS["Data.Eq"],Data_Foldable=$PS["Data.Foldable"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Data_Maybe=$PS["Data.Maybe"],Data_Monoid=$PS["Data.Monoid"],Data_Ord=$PS["Data.Ord"],Data_Ordering=$PS["Data.Ordering"],Data_Semigroup=$PS["Data.Semigroup"],Data_Unfoldable=$PS["Data.Unfoldable"],Data_Unfoldable1=$PS["Data.Unfoldable1"],Nil=(function(){function Nil(){};Nil.value=new Nil();return Nil})(),Cons=(function(){function Cons(value0,value1){this.value0=value0;this.value1=value1};Cons.create=function(value0){return function(value1){return new Cons(value0,value1)}};return Cons})(),listMap=function(f){var chunkedRevMap=function($copy_chunksAcc){return function($copy_v){var $tco_var_chunksAcc=$copy_chunksAcc,$tco_done=false,$tco_result;function $tco_loop(chunksAcc,v){if(v instanceof Cons&&(v.value1 instanceof Cons&&v.value1.value1 instanceof Cons)){$tco_var_chunksAcc=new Cons(v,chunksAcc);$copy_v=v.value1.value1.value1;return};var unrolledMap=function(v1){if(v1 instanceof Cons&&(v1.value1 instanceof Cons&&v1.value1.value1 instanceof Nil))return new Cons(f(v1.value0),new Cons(f(v1.value1.value0),Nil.value));if(v1 instanceof Cons&&v1.value1 instanceof Nil)return new Cons(f(v1.value0),Nil.value);return Nil.value},reverseUnrolledMap=function($copy_v1){return function($copy_acc){var $tco_var_v1=$copy_v1,$tco_done=false,$tco_result;function $tco_loop(v1,acc){if(v1 instanceof Cons&&(v1.value0 instanceof Cons&&(v1.value0.value1 instanceof Cons&&v1.value0.value1.value1 instanceof Cons))){$tco_var_v1=v1.value1;$copy_acc=new Cons(f(v1.value0.value0),new Cons(f(v1.value0.value1.value0),new Cons(f(v1.value0.value1.value1.value0),acc)));return};$tco_done=true;return acc};while(!$tco_done)$tco_result=$tco_loop($tco_var_v1,$copy_acc);return $tco_result}};$tco_done=true;return reverseUnrolledMap(chunksAcc)(unrolledMap(v))};while(!$tco_done)$tco_result=$tco_loop($tco_var_chunksAcc,$copy_v);return $tco_result}};return chunkedRevMap(Nil.value)},functorList=new Data_Functor.Functor(listMap),foldableList=new Data_Foldable.Foldable(function(dictMonoid){return function(f){return Data_Foldable.foldl(foldableList)(function(acc){var $202=Data_Semigroup.append(dictMonoid.Semigroup0())(acc);return function($203){return $202(f($203))}})(Data_Monoid.mempty(dictMonoid))}},function(f){var go=function($copy_b){return function($copy_v){var $tco_var_b=$copy_b,$tco_done=false,$tco_result;function $tco_loop(b,v){if(v instanceof Nil){$tco_done=true;return b};if(v instanceof Cons){$tco_var_b=f(b)(v.value0);$copy_v=v.value1;return};throw new Error("Failed pattern match at Data.List.Types (line 109, column 12 - line 111, column 30): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_b,$copy_v);return $tco_result}};return go},function(f){return function(b){var rev=Data_Foldable.foldl(foldableList)(Data_Function.flip(Cons.create))(Nil.value),$204=Data_Foldable.foldl(foldableList)(Data_Function.flip(f))(b);return function($205){return $204(rev($205))}}}),semigroupList=new Data_Semigroup.Semigroup(function(xs){return function(ys){return Data_Foldable.foldr(foldableList)(Cons.create)(ys)(xs)}}),unfoldable1List=new Data_Unfoldable1.Unfoldable1(function(f){return function(b){var go=function($copy_source){return function($copy_memo){var $tco_var_source=$copy_source,$tco_done=false,$tco_result;function $tco_loop(source,memo){var v=f(source);if(v.value1 instanceof Data_Maybe.Just){$tco_var_source=v.value1.value0;$copy_memo=new Cons(v.value0,memo);return};if(v.value1 instanceof Data_Maybe.Nothing){$tco_done=true;return Data_Foldable.foldl(foldableList)(Data_Function.flip(Cons.create))(Nil.value)(new Cons(v.value0,memo))};throw new Error("Failed pattern match at Data.List.Types (line 133, column 22 - line 135, column 61): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_source,$copy_memo);return $tco_result}};return go(b)(Nil.value)}}),unfoldableList=new Data_Unfoldable.Unfoldable(function(){return unfoldable1List},function(f){return function(b){var go=function($copy_source){return function($copy_memo){var $tco_var_source=$copy_source,$tco_done=false,$tco_result;function $tco_loop(source,memo){var v=f(source);if(v instanceof Data_Maybe.Nothing){$tco_done=true;return Data_Foldable.foldl(foldableList)(Data_Function.flip(Cons.create))(Nil.value)(memo)};if(v instanceof Data_Maybe.Just){$tco_var_source=v.value0.value1;$copy_memo=new Cons(v.value0.value0,memo);return};throw new Error("Failed pattern match at Data.List.Types (line 140, column 22 - line 142, column 52): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_source,$copy_memo);return $tco_result}};return go(b)(Nil.value)}}),eq1List=new Data_Eq.Eq1(function(dictEq){return function(xs){return function(ys){var go=function($copy_v){return function($copy_v1){return function($copy_v2){var $tco_var_v=$copy_v,$tco_var_v1=$copy_v1,$tco_done=false,$tco_result;function $tco_loop(v,v1,v2){if(!v2){$tco_done=true;return false};if(v instanceof Nil&&v1 instanceof Nil){$tco_done=true;return v2};if(v instanceof Cons&&v1 instanceof Cons){$tco_var_v=v.value1;$tco_var_v1=v1.value1;$copy_v2=v2&&Data_Eq.eq(dictEq)(v1.value0)(v.value0);return};$tco_done=true;return false};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$tco_var_v1,$copy_v2);return $tco_result}}};return go(xs)(ys)(true)}}}),eqList=function(dictEq){return new Data_Eq.Eq(Data_Eq.eq1(eq1List)(dictEq))},ord1List=new Data_Ord.Ord1(function(){return eq1List},function(dictOrd){return function(xs){return function(ys){var go=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v,$tco_done=false,$tco_result;function $tco_loop(v,v1){if(v instanceof Nil&&v1 instanceof Nil){$tco_done=true;return Data_Ordering.EQ.value};if(v instanceof Nil){$tco_done=true;return Data_Ordering.LT.value};if(v1 instanceof Nil){$tco_done=true;return Data_Ordering.GT.value};if(v instanceof Cons&&v1 instanceof Cons){var v2=Data_Ord.compare(dictOrd)(v.value0)(v1.value0);if(v2 instanceof Data_Ordering.EQ){$tco_var_v=v.value1;$copy_v1=v1.value1;return};$tco_done=true;return v2};throw new Error("Failed pattern match at Data.List.Types (line 61, column 5 - line 61, column 20): "+[v.constructor.name,v1.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$copy_v1);return $tco_result}};return go(xs)(ys)}}}),ordList=function(dictOrd){return new Data_Ord.Ord(function(){return eqList(dictOrd.Eq0())},Data_Ord.compare1(ord1List)(dictOrd))},applyList=new Control_Apply.Apply(function(){return functorList},function(v){return function(v1){if(v instanceof Nil)return Nil.value;if(v instanceof Cons)return Data_Semigroup.append(semigroupList)(Data_Functor.map(functorList)(v.value0)(v1))(Control_Apply.apply(applyList)(v.value1)(v1));throw new Error("Failed pattern match at Data.List.Types (line 155, column 1 - line 157, column 48): "+[v.constructor.name,v1.constructor.name])}}),applicativeList=new Control_Applicative.Applicative(function(){return applyList},function(a){return new Cons(a,Nil.value)});exports["Nil"]=Nil;exports["Cons"]=Cons;exports["ordList"]=ordList;exports["semigroupList"]=semigroupList;exports["foldableList"]=foldableList;exports["unfoldableList"]=unfoldableList;exports["applicativeList"]=applicativeList})(PS);(function($PS){"use strict";$PS["Data.Map.Internal"]=$PS["Data.Map.Internal"]||{};var exports=$PS["Data.Map.Internal"],Control_Applicative=$PS["Control.Applicative"],Control_Category=$PS["Control.Category"],Data_Eq=$PS["Data.Eq"],Data_Foldable=$PS["Data.Foldable"],Data_FoldableWithIndex=$PS["Data.FoldableWithIndex"],Data_Function=$PS["Data.Function"],Data_List_Types=$PS["Data.List.Types"],Data_Maybe=$PS["Data.Maybe"],Data_Ord=$PS["Data.Ord"],Data_Ordering=$PS["Data.Ordering"],Data_Semigroup=$PS["Data.Semigroup"],Data_Tuple=$PS["Data.Tuple"],Data_Unfoldable=$PS["Data.Unfoldable"],Leaf=(function(){function Leaf(){};Leaf.value=new Leaf();return Leaf})(),Two=(function(){function Two(value0,value1,value2,value3){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3};Two.create=function(value0){return function(value1){return function(value2){return function(value3){return new Two(value0,value1,value2,value3)}}}};return Two})(),Three=(function(){function Three(value0,value1,value2,value3,value4,value5,value6){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3;this.value4=value4;this.value5=value5;this.value6=value6};Three.create=function(value0){return function(value1){return function(value2){return function(value3){return function(value4){return function(value5){return function(value6){return new Three(value0,value1,value2,value3,value4,value5,value6)}}}}}}};return Three})(),TwoLeft=(function(){function TwoLeft(value0,value1,value2){this.value0=value0;this.value1=value1;this.value2=value2};TwoLeft.create=function(value0){return function(value1){return function(value2){return new TwoLeft(value0,value1,value2)}}};return TwoLeft})(),TwoRight=(function(){function TwoRight(value0,value1,value2){this.value0=value0;this.value1=value1;this.value2=value2};TwoRight.create=function(value0){return function(value1){return function(value2){return new TwoRight(value0,value1,value2)}}};return TwoRight})(),ThreeLeft=(function(){function ThreeLeft(value0,value1,value2,value3,value4,value5){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3;this.value4=value4;this.value5=value5};ThreeLeft.create=function(value0){return function(value1){return function(value2){return function(value3){return function(value4){return function(value5){return new ThreeLeft(value0,value1,value2,value3,value4,value5)}}}}}};return ThreeLeft})(),ThreeMiddle=(function(){function ThreeMiddle(value0,value1,value2,value3,value4,value5){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3;this.value4=value4;this.value5=value5};ThreeMiddle.create=function(value0){return function(value1){return function(value2){return function(value3){return function(value4){return function(value5){return new ThreeMiddle(value0,value1,value2,value3,value4,value5)}}}}}};return ThreeMiddle})(),ThreeRight=(function(){function ThreeRight(value0,value1,value2,value3,value4,value5){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3;this.value4=value4;this.value5=value5};ThreeRight.create=function(value0){return function(value1){return function(value2){return function(value3){return function(value4){return function(value5){return new ThreeRight(value0,value1,value2,value3,value4,value5)}}}}}};return ThreeRight})(),KickUp=(function(){function KickUp(value0,value1,value2,value3){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3};KickUp.create=function(value0){return function(value1){return function(value2){return function(value3){return new KickUp(value0,value1,value2,value3)}}}};return KickUp})(),values=function(v){if(v instanceof Leaf)return Data_List_Types.Nil.value;if(v instanceof Two)return Data_Semigroup.append(Data_List_Types.semigroupList)(values(v.value0))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value2))(values(v.value3)));if(v instanceof Three)return Data_Semigroup.append(Data_List_Types.semigroupList)(values(v.value0))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value2))(Data_Semigroup.append(Data_List_Types.semigroupList)(values(v.value3))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value5))(values(v.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 612, column 1 - line 612, column 40): "+[v.constructor.name])},singleton=function(k){return function(v){return new Two(Leaf.value,k,v,Leaf.value)}},toUnfoldable=function(dictUnfoldable){return function(m){var go=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Data_List_Types.Nil){$tco_done=true;return Data_Maybe.Nothing.value};if(v instanceof Data_List_Types.Cons){if(v.value0 instanceof Leaf){$copy_v=v.value1;return};if(v.value0 instanceof Two&&(v.value0.value0 instanceof Leaf&&v.value0.value3 instanceof Leaf)){$tco_done=true;return Data_Maybe.Just.create(new Data_Tuple.Tuple(new Data_Tuple.Tuple(v.value0.value1,v.value0.value2),v.value1))};if(v.value0 instanceof Two&&v.value0.value0 instanceof Leaf){$tco_done=true;return Data_Maybe.Just.create(new Data_Tuple.Tuple(new Data_Tuple.Tuple(v.value0.value1,v.value0.value2),new Data_List_Types.Cons(v.value0.value3,v.value1)))};if(v.value0 instanceof Two){$copy_v=new Data_List_Types.Cons(v.value0.value0,new Data_List_Types.Cons(singleton(v.value0.value1)(v.value0.value2),new Data_List_Types.Cons(v.value0.value3,v.value1)));return};if(v.value0 instanceof Three){$copy_v=new Data_List_Types.Cons(v.value0.value0,new Data_List_Types.Cons(singleton(v.value0.value1)(v.value0.value2),new Data_List_Types.Cons(v.value0.value3,new Data_List_Types.Cons(singleton(v.value0.value4)(v.value0.value5),new Data_List_Types.Cons(v.value0.value6,v.value1)))));return};throw new Error("Failed pattern match at Data.Map.Internal (line 577, column 18 - line 586, column 71): "+[v.value0.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 576, column 3 - line 576, column 19): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result};return Data_Unfoldable.unfoldr(dictUnfoldable)(go)(new Data_List_Types.Cons(m,Data_List_Types.Nil.value))}},toAscArray=toUnfoldable(Data_Unfoldable.unfoldableArray),toUnfoldableUnordered=function(dictUnfoldable){return function(m){var go=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Data_List_Types.Nil){$tco_done=true;return Data_Maybe.Nothing.value};if(v instanceof Data_List_Types.Cons){if(v.value0 instanceof Leaf){$copy_v=v.value1;return};if(v.value0 instanceof Two){$tco_done=true;return Data_Maybe.Just.create(new Data_Tuple.Tuple(new Data_Tuple.Tuple(v.value0.value1,v.value0.value2),new Data_List_Types.Cons(v.value0.value0,new Data_List_Types.Cons(v.value0.value3,v.value1))))};if(v.value0 instanceof Three){$tco_done=true;return Data_Maybe.Just.create(new Data_Tuple.Tuple(new Data_Tuple.Tuple(v.value0.value1,v.value0.value2),new Data_List_Types.Cons(singleton(v.value0.value4)(v.value0.value5),new Data_List_Types.Cons(v.value0.value0,new Data_List_Types.Cons(v.value0.value3,new Data_List_Types.Cons(v.value0.value6,v.value1))))))};throw new Error("Failed pattern match at Data.Map.Internal (line 598, column 18 - line 603, column 77): "+[v.value0.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 597, column 3 - line 597, column 19): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result};return Data_Unfoldable.unfoldr(dictUnfoldable)(go)(new Data_List_Types.Cons(m,Data_List_Types.Nil.value))}},lookup=function(dictOrd){return function(k){var comp=Data_Ord.compare(dictOrd),go=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Leaf){$tco_done=true;return Data_Maybe.Nothing.value};if(v instanceof Two){var v2=comp(k)(v.value1);if(v2 instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(v.value2)};if(v2 instanceof Data_Ordering.LT){$copy_v=v.value0;return};$copy_v=v.value3;return};if(v instanceof Three){var v3=comp(k)(v.value1);if(v3 instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(v.value2)};var v4=comp(k)(v.value4);if(v4 instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(v.value5)};if(v3 instanceof Data_Ordering.LT){$copy_v=v.value0;return};if(v4 instanceof Data_Ordering.GT){$copy_v=v.value6;return};$copy_v=v.value3;return};throw new Error("Failed pattern match at Data.Map.Internal (line 200, column 5 - line 200, column 22): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result};return go}},keys=function(v){if(v instanceof Leaf)return Data_List_Types.Nil.value;if(v instanceof Two)return Data_Semigroup.append(Data_List_Types.semigroupList)(keys(v.value0))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value1))(keys(v.value3)));if(v instanceof Three)return Data_Semigroup.append(Data_List_Types.semigroupList)(keys(v.value0))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value1))(Data_Semigroup.append(Data_List_Types.semigroupList)(keys(v.value3))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value4))(keys(v.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 606, column 1 - line 606, column 38): "+[v.constructor.name])},isEmpty=function(v){if(v instanceof Leaf)return true;return false},fromZipper=function($copy_dictOrd){return function($copy_v){return function($copy_tree){var $tco_var_dictOrd=$copy_dictOrd,$tco_var_v=$copy_v,$tco_done=false,$tco_result;function $tco_loop(dictOrd,v,tree){if(v instanceof Data_List_Types.Nil){$tco_done=true;return tree};if(v instanceof Data_List_Types.Cons){if(v.value0 instanceof TwoLeft){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Two(tree,v.value0.value0,v.value0.value1,v.value0.value2);return};if(v.value0 instanceof TwoRight){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Two(v.value0.value0,v.value0.value1,v.value0.value2,tree);return};if(v.value0 instanceof ThreeLeft){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Three(tree,v.value0.value0,v.value0.value1,v.value0.value2,v.value0.value3,v.value0.value4,v.value0.value5);return};if(v.value0 instanceof ThreeMiddle){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Three(v.value0.value0,v.value0.value1,v.value0.value2,tree,v.value0.value3,v.value0.value4,v.value0.value5);return};if(v.value0 instanceof ThreeRight){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Three(v.value0.value0,v.value0.value1,v.value0.value2,v.value0.value3,v.value0.value4,v.value0.value5,tree);return};throw new Error("Failed pattern match at Data.Map.Internal (line 418, column 3 - line 423, column 88): "+[v.value0.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 415, column 1 - line 415, column 80): "+[v.constructor.name,tree.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_dictOrd,$tco_var_v,$copy_tree);return $tco_result}}},insert=function(dictOrd){return function(k){return function(v){var up=function($copy_v1){return function($copy_v2){var $tco_var_v1=$copy_v1,$tco_done=false,$tco_result;function $tco_loop(v1,v2){if(v1 instanceof Data_List_Types.Nil){$tco_done=true;return new Two(v2.value0,v2.value1,v2.value2,v2.value3)};if(v1 instanceof Data_List_Types.Cons){if(v1.value0 instanceof TwoLeft){$tco_done=true;return fromZipper(dictOrd)(v1.value1)(new Three(v2.value0,v2.value1,v2.value2,v2.value3,v1.value0.value0,v1.value0.value1,v1.value0.value2))};if(v1.value0 instanceof TwoRight){$tco_done=true;return fromZipper(dictOrd)(v1.value1)(new Three(v1.value0.value0,v1.value0.value1,v1.value0.value2,v2.value0,v2.value1,v2.value2,v2.value3))};if(v1.value0 instanceof ThreeLeft){$tco_var_v1=v1.value1;$copy_v2=new KickUp(new Two(v2.value0,v2.value1,v2.value2,v2.value3),v1.value0.value0,v1.value0.value1,new Two(v1.value0.value2,v1.value0.value3,v1.value0.value4,v1.value0.value5));return};if(v1.value0 instanceof ThreeMiddle){$tco_var_v1=v1.value1;$copy_v2=new KickUp(new Two(v1.value0.value0,v1.value0.value1,v1.value0.value2,v2.value0),v2.value1,v2.value2,new Two(v2.value3,v1.value0.value3,v1.value0.value4,v1.value0.value5));return};if(v1.value0 instanceof ThreeRight){$tco_var_v1=v1.value1;$copy_v2=new KickUp(new Two(v1.value0.value0,v1.value0.value1,v1.value0.value2,v1.value0.value3),v1.value0.value4,v1.value0.value5,new Two(v2.value0,v2.value1,v2.value2,v2.value3));return};throw new Error("Failed pattern match at Data.Map.Internal (line 454, column 5 - line 459, column 108): "+[v1.value0.constructor.name,v2.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 451, column 3 - line 451, column 56): "+[v1.constructor.name,v2.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_v1,$copy_v2);return $tco_result}},comp=Data_Ord.compare(dictOrd),down=function($copy_ctx){return function($copy_v1){var $tco_var_ctx=$copy_ctx,$tco_done=false,$tco_result;function $tco_loop(ctx,v1){if(v1 instanceof Leaf){$tco_done=true;return up(ctx)(new KickUp(Leaf.value,k,v,Leaf.value))};if(v1 instanceof Two){var v2=comp(k)(v1.value1);if(v2 instanceof Data_Ordering.EQ){$tco_done=true;return fromZipper(dictOrd)(ctx)(new Two(v1.value0,k,v,v1.value3))};if(v2 instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new TwoLeft(v1.value1,v1.value2,v1.value3),ctx);$copy_v1=v1.value0;return};$tco_var_ctx=new Data_List_Types.Cons(new TwoRight(v1.value0,v1.value1,v1.value2),ctx);$copy_v1=v1.value3;return};if(v1 instanceof Three){var v3=comp(k)(v1.value1);if(v3 instanceof Data_Ordering.EQ){$tco_done=true;return fromZipper(dictOrd)(ctx)(new Three(v1.value0,k,v,v1.value3,v1.value4,v1.value5,v1.value6))};var v4=comp(k)(v1.value4);if(v4 instanceof Data_Ordering.EQ){$tco_done=true;return fromZipper(dictOrd)(ctx)(new Three(v1.value0,v1.value1,v1.value2,v1.value3,k,v,v1.value6))};if(v3 instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new ThreeLeft(v1.value1,v1.value2,v1.value3,v1.value4,v1.value5,v1.value6),ctx);$copy_v1=v1.value0;return};if(v3 instanceof Data_Ordering.GT&&v4 instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new ThreeMiddle(v1.value0,v1.value1,v1.value2,v1.value4,v1.value5,v1.value6),ctx);$copy_v1=v1.value3;return};$tco_var_ctx=new Data_List_Types.Cons(new ThreeRight(v1.value0,v1.value1,v1.value2,v1.value3,v1.value4,v1.value5),ctx);$copy_v1=v1.value6;return};throw new Error("Failed pattern match at Data.Map.Internal (line 434, column 3 - line 434, column 55): "+[ctx.constructor.name,v1.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_ctx,$copy_v1);return $tco_result}};return down(Data_List_Types.Nil.value)}}},pop=function(dictOrd){return function(k){var up=function($copy_ctxs){return function($copy_tree){var $tco_var_ctxs=$copy_ctxs,$tco_done=false,$tco_result;function $tco_loop(ctxs,tree){if(ctxs instanceof Data_List_Types.Nil){$tco_done=true;return tree};if(ctxs instanceof Data_List_Types.Cons){if(ctxs.value0 instanceof TwoLeft&&(ctxs.value0.value2 instanceof Leaf&&tree instanceof Leaf)){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(Leaf.value,ctxs.value0.value0,ctxs.value0.value1,Leaf.value))};if(ctxs.value0 instanceof TwoRight&&(ctxs.value0.value0 instanceof Leaf&&tree instanceof Leaf)){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(Leaf.value,ctxs.value0.value1,ctxs.value0.value2,Leaf.value))};if(ctxs.value0 instanceof TwoLeft&&ctxs.value0.value2 instanceof Two){$tco_var_ctxs=ctxs.value1;$copy_tree=new Three(tree,ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2.value0,ctxs.value0.value2.value1,ctxs.value0.value2.value2,ctxs.value0.value2.value3);return};if(ctxs.value0 instanceof TwoRight&&ctxs.value0.value0 instanceof Two){$tco_var_ctxs=ctxs.value1;$copy_tree=new Three(ctxs.value0.value0.value0,ctxs.value0.value0.value1,ctxs.value0.value0.value2,ctxs.value0.value0.value3,ctxs.value0.value1,ctxs.value0.value2,tree);return};if(ctxs.value0 instanceof TwoLeft&&ctxs.value0.value2 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(new Two(tree,ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2.value0),ctxs.value0.value2.value1,ctxs.value0.value2.value2,new Two(ctxs.value0.value2.value3,ctxs.value0.value2.value4,ctxs.value0.value2.value5,ctxs.value0.value2.value6)))};if(ctxs.value0 instanceof TwoRight&&ctxs.value0.value0 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(new Two(ctxs.value0.value0.value0,ctxs.value0.value0.value1,ctxs.value0.value0.value2,ctxs.value0.value0.value3),ctxs.value0.value0.value4,ctxs.value0.value0.value5,new Two(ctxs.value0.value0.value6,ctxs.value0.value1,ctxs.value0.value2,tree)))};if(ctxs.value0 instanceof ThreeLeft&&(ctxs.value0.value2 instanceof Leaf&&(ctxs.value0.value5 instanceof Leaf&&tree instanceof Leaf))){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(Leaf.value,ctxs.value0.value0,ctxs.value0.value1,Leaf.value,ctxs.value0.value3,ctxs.value0.value4,Leaf.value))};if(ctxs.value0 instanceof ThreeMiddle&&(ctxs.value0.value0 instanceof Leaf&&(ctxs.value0.value5 instanceof Leaf&&tree instanceof Leaf))){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(Leaf.value,ctxs.value0.value1,ctxs.value0.value2,Leaf.value,ctxs.value0.value3,ctxs.value0.value4,Leaf.value))};if(ctxs.value0 instanceof ThreeRight&&(ctxs.value0.value0 instanceof Leaf&&(ctxs.value0.value3 instanceof Leaf&&tree instanceof Leaf))){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(Leaf.value,ctxs.value0.value1,ctxs.value0.value2,Leaf.value,ctxs.value0.value4,ctxs.value0.value5,Leaf.value))};if(ctxs.value0 instanceof ThreeLeft&&ctxs.value0.value2 instanceof Two){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(new Three(tree,ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2.value0,ctxs.value0.value2.value1,ctxs.value0.value2.value2,ctxs.value0.value2.value3),ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5))};if(ctxs.value0 instanceof ThreeMiddle&&ctxs.value0.value0 instanceof Two){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(new Three(ctxs.value0.value0.value0,ctxs.value0.value0.value1,ctxs.value0.value0.value2,ctxs.value0.value0.value3,ctxs.value0.value1,ctxs.value0.value2,tree),ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5))};if(ctxs.value0 instanceof ThreeMiddle&&ctxs.value0.value5 instanceof Two){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2,new Three(tree,ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5.value0,ctxs.value0.value5.value1,ctxs.value0.value5.value2,ctxs.value0.value5.value3)))};if(ctxs.value0 instanceof ThreeRight&&ctxs.value0.value3 instanceof Two){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2,new Three(ctxs.value0.value3.value0,ctxs.value0.value3.value1,ctxs.value0.value3.value2,ctxs.value0.value3.value3,ctxs.value0.value4,ctxs.value0.value5,tree)))};if(ctxs.value0 instanceof ThreeLeft&&ctxs.value0.value2 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(new Two(tree,ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2.value0),ctxs.value0.value2.value1,ctxs.value0.value2.value2,new Two(ctxs.value0.value2.value3,ctxs.value0.value2.value4,ctxs.value0.value2.value5,ctxs.value0.value2.value6),ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5))};if(ctxs.value0 instanceof ThreeMiddle&&ctxs.value0.value0 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(new Two(ctxs.value0.value0.value0,ctxs.value0.value0.value1,ctxs.value0.value0.value2,ctxs.value0.value0.value3),ctxs.value0.value0.value4,ctxs.value0.value0.value5,new Two(ctxs.value0.value0.value6,ctxs.value0.value1,ctxs.value0.value2,tree),ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5))};if(ctxs.value0 instanceof ThreeMiddle&&ctxs.value0.value5 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2,new Two(tree,ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5.value0),ctxs.value0.value5.value1,ctxs.value0.value5.value2,new Two(ctxs.value0.value5.value3,ctxs.value0.value5.value4,ctxs.value0.value5.value5,ctxs.value0.value5.value6)))};if(ctxs.value0 instanceof ThreeRight&&ctxs.value0.value3 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2,new Two(ctxs.value0.value3.value0,ctxs.value0.value3.value1,ctxs.value0.value3.value2,ctxs.value0.value3.value3),ctxs.value0.value3.value4,ctxs.value0.value3.value5,new Two(ctxs.value0.value3.value6,ctxs.value0.value4,ctxs.value0.value5,tree)))};throw new Error("Failed pattern match at Data.Map.Internal (line 511, column 9 - line 528, column 136): "+[ctxs.value0.constructor.name,tree.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 508, column 5 - line 528, column 136): "+[ctxs.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_ctxs,$copy_tree);return $tco_result}},removeMaxNode=function($copy_ctx){return function($copy_m){var $tco_var_ctx=$copy_ctx,$tco_done=false,$tco_result;function $tco_loop(ctx,m){if(m instanceof Two&&(m.value0 instanceof Leaf&&m.value3 instanceof Leaf)){$tco_done=true;return up(ctx)(Leaf.value)};if(m instanceof Two){$tco_var_ctx=new Data_List_Types.Cons(new TwoRight(m.value0,m.value1,m.value2),ctx);$copy_m=m.value3;return};if(m instanceof Three&&(m.value0 instanceof Leaf&&(m.value3 instanceof Leaf&&m.value6 instanceof Leaf))){$tco_done=true;return up(new Data_List_Types.Cons(new TwoRight(Leaf.value,m.value1,m.value2),ctx))(Leaf.value)};if(m instanceof Three){$tco_var_ctx=new Data_List_Types.Cons(new ThreeRight(m.value0,m.value1,m.value2,m.value3,m.value4,m.value5),ctx);$copy_m=m.value6;return};throw new Error("Failed pattern match at Data.Map.Internal (line 540, column 5 - line 544, column 107): "+[m.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_ctx,$copy_m);return $tco_result}},maxNode=function($copy_m){var $tco_done=false,$tco_result;function $tco_loop(m){if(m instanceof Two&&m.value3 instanceof Leaf){$tco_done=true;return{key:m.value1,value:m.value2}};if(m instanceof Two){$copy_m=m.value3;return};if(m instanceof Three&&m.value6 instanceof Leaf){$tco_done=true;return{key:m.value4,value:m.value5}};if(m instanceof Three){$copy_m=m.value6;return};throw new Error("Failed pattern match at Data.Map.Internal (line 531, column 33 - line 535, column 45): "+[m.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_m);return $tco_result},comp=Data_Ord.compare(dictOrd),down=function($copy_ctx){return function($copy_m){var $tco_var_ctx=$copy_ctx,$tco_done=false,$tco_result;function $tco_loop(ctx,m){if(m instanceof Leaf){$tco_done=true;return Data_Maybe.Nothing.value};if(m instanceof Two){var v=comp(k)(m.value1);if(m.value3 instanceof Leaf&&v instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value2,up(ctx)(Leaf.value)))};if(v instanceof Data_Ordering.EQ){var max=maxNode(m.value0);$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value2,removeMaxNode(new Data_List_Types.Cons(new TwoLeft(max.key,max.value,m.value3),ctx))(m.value0)))};if(v instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new TwoLeft(m.value1,m.value2,m.value3),ctx);$copy_m=m.value0;return};$tco_var_ctx=new Data_List_Types.Cons(new TwoRight(m.value0,m.value1,m.value2),ctx);$copy_m=m.value3;return};if(m instanceof Three){var leaves=(function(){if(m.value0 instanceof Leaf&&(m.value3 instanceof Leaf&&m.value6 instanceof Leaf))return true;return false})(),v=comp(k)(m.value4),v3=comp(k)(m.value1);if(leaves&&v3 instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value2,fromZipper(dictOrd)(ctx)(new Two(Leaf.value,m.value4,m.value5,Leaf.value))))};if(leaves&&v instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value5,fromZipper(dictOrd)(ctx)(new Two(Leaf.value,m.value1,m.value2,Leaf.value))))};if(v3 instanceof Data_Ordering.EQ){var max=maxNode(m.value0);$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value2,removeMaxNode(new Data_List_Types.Cons(new ThreeLeft(max.key,max.value,m.value3,m.value4,m.value5,m.value6),ctx))(m.value0)))};if(v instanceof Data_Ordering.EQ){var max=maxNode(m.value3);$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value5,removeMaxNode(new Data_List_Types.Cons(new ThreeMiddle(m.value0,m.value1,m.value2,max.key,max.value,m.value6),ctx))(m.value3)))};if(v3 instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new ThreeLeft(m.value1,m.value2,m.value3,m.value4,m.value5,m.value6),ctx);$copy_m=m.value0;return};if(v3 instanceof Data_Ordering.GT&&v instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new ThreeMiddle(m.value0,m.value1,m.value2,m.value4,m.value5,m.value6),ctx);$copy_m=m.value3;return};$tco_var_ctx=new Data_List_Types.Cons(new ThreeRight(m.value0,m.value1,m.value2,m.value3,m.value4,m.value5),ctx);$copy_m=m.value6;return};throw new Error("Failed pattern match at Data.Map.Internal (line 481, column 34 - line 504, column 80): "+[m.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_ctx,$copy_m);return $tco_result}};return down(Data_List_Types.Nil.value)}},foldableMap=new Data_Foldable.Foldable(function(dictMonoid){return function(f){return function(m){return Data_Foldable.foldMap(Data_List_Types.foldableList)(dictMonoid)(f)(values(m))}}},function(f){return function(z){return function(m){return Data_Foldable.foldl(Data_List_Types.foldableList)(f)(z)(values(m))}}},function(f){return function(z){return function(m){return Data_Foldable.foldr(Data_List_Types.foldableList)(f)(z)(values(m))}}}),eqMap=function(dictEq){return function(dictEq1){return new Data_Eq.Eq(function(m1){return function(m2){return Data_Eq.eq(Data_Eq.eqArray(Data_Tuple.eqTuple(dictEq)(dictEq1)))(toAscArray(m1))(toAscArray(m2))}})}},empty=Leaf.value,fromFoldable=function(dictOrd){return function(dictFoldable){return Data_Foldable.foldl(dictFoldable)(function(m){return function(v){return insert(dictOrd)(v.value0)(v.value1)(m)}})(empty)}},$$delete=function(dictOrd){return function(k){return function(m){return Data_Maybe.maybe(m)(Data_Tuple.snd)(pop(dictOrd)(k)(m))}}},asList=Control_Category.identity(Control_Category.categoryFn),foldableWithIndexMap=new Data_FoldableWithIndex.FoldableWithIndex(function(){return foldableMap},function(dictMonoid){return function(f){return function(m){return Data_Foldable.foldMap(Data_List_Types.foldableList)(dictMonoid)(Data_Tuple.uncurry(f))(asList(toUnfoldable(Data_List_Types.unfoldableList)(m)))}}},function(f){return function(z){return function(m){return Data_Foldable.foldl(Data_List_Types.foldableList)((function(){var $763=Data_Function.flip(f);return function($764){return Data_Tuple.uncurry($763($764))}})())(z)(asList(toUnfoldable(Data_List_Types.unfoldableList)(m)))}}},function(f){return function(z){return function(m){return Data_Foldable.foldr(Data_List_Types.foldableList)(Data_Tuple.uncurry(f))(z)(asList(toUnfoldable(Data_List_Types.unfoldableList)(m)))}}}),mapMaybeWithKey=function(dictOrd){return function(f){return Data_FoldableWithIndex.foldrWithIndex(foldableWithIndexMap)(function(k){return function(a){return function(acc){return Data_Maybe.maybe(acc)(function(b){return insert(dictOrd)(k)(b)(acc)})(f(k)(a))}}})(empty)}},mapMaybe=function(dictOrd){var $765=mapMaybeWithKey(dictOrd);return function($766){return $765(Data_Function["const"]($766))}},alter=function(dictOrd){return function(f){return function(k){return function(m){var v=f(lookup(dictOrd)(k)(m));if(v instanceof Data_Maybe.Nothing)return $$delete(dictOrd)(k)(m);if(v instanceof Data_Maybe.Just)return insert(dictOrd)(k)(v.value0)(m);throw new Error("Failed pattern match at Data.Map.Internal (line 549, column 15 - line 551, column 25): "+[v.constructor.name])}}}},fromFoldableWith=function(dictOrd){return function(dictFoldable){return function(f){var combine=function(v){return function(v1){if(v1 instanceof Data_Maybe.Just)return Data_Maybe.Just.create(f(v)(v1.value0));if(v1 instanceof Data_Maybe.Nothing)return new Data_Maybe.Just(v);throw new Error("Failed pattern match at Data.Map.Internal (line 566, column 3 - line 566, column 38): "+[v.constructor.name,v1.constructor.name])}};return Data_Foldable.foldl(dictFoldable)(function(m){return function(v){return alter(dictOrd)(combine(v.value1))(v.value0)(m)}})(empty)}}},unionWith=function(dictOrd){return function(f){return function(m1){return function(m2){var go=function(m){return function(v){return alter(dictOrd)((function(){var $769=Data_Maybe.maybe(v.value1)(f(v.value1));return function($770){return Data_Maybe.Just.create($769($770))}})())(v.value0)(m)}};return Data_Foldable.foldl(Data_List_Types.foldableList)(go)(m2)(toUnfoldable(Data_List_Types.unfoldableList)(m1))}}}};exports["empty"]=empty;exports["isEmpty"]=isEmpty;exports["singleton"]=singleton;exports["insert"]=insert;exports["lookup"]=lookup;exports["fromFoldable"]=fromFoldable;exports["fromFoldableWith"]=fromFoldableWith;exports["toUnfoldableUnordered"]=toUnfoldableUnordered;exports["keys"]=keys;exports["unionWith"]=unionWith;exports["mapMaybe"]=mapMaybe;exports["eqMap"]=eqMap;exports["foldableMap"]=foldableMap})(PS);(function($PS){"use strict";$PS["Data.Monoid.Additive"]=$PS["Data.Monoid.Additive"]||{};var exports=$PS["Data.Monoid.Additive"],Data_Semigroup=$PS["Data.Semigroup"],Data_Semiring=$PS["Data.Semiring"],Additive=function(x){return x},semigroupAdditive=function(dictSemiring){return new Data_Semigroup.Semigroup(function(v){return function(v1){return Data_Semiring.add(dictSemiring)(v)(v1)}})};exports["Additive"]=Additive;exports["semigroupAdditive"]=semigroupAdditive})(PS);(function(exports){"use strict";exports["null"]=null;exports.nullable=function(a,r,f){return a==null?r:f(a)};exports.notNull=function(x){return x}})(PS["Data.Nullable"]=PS["Data.Nullable"]||{});(function($PS){"use strict";$PS["Data.Nullable"]=$PS["Data.Nullable"]||{};var exports=$PS["Data.Nullable"],$foreign=$PS["Data.Nullable"],Data_Maybe=$PS["Data.Maybe"],toNullable=Data_Maybe.maybe($foreign["null"])($foreign.notNull),toMaybe=function(n){return $foreign.nullable(n,Data_Maybe.Nothing.value,Data_Maybe.Just.create)};exports["toMaybe"]=toMaybe;exports["toNullable"]=toNullable;exports["null"]=$foreign["null"];exports["notNull"]=$foreign.notNull})(PS);(function($PS){"use strict";$PS["Data.Set"]=$PS["Data.Set"]||{};var exports=$PS["Data.Set"],Data_Eq=$PS["Data.Eq"],Data_Foldable=$PS["Data.Foldable"],Data_List_Types=$PS["Data.List.Types"],Data_Map_Internal=$PS["Data.Map.Internal"],Data_Ord=$PS["Data.Ord"],Data_Unit=$PS["Data.Unit"],toList=function(v){return Data_Map_Internal.keys(v)},singleton=function(a){return Data_Map_Internal.singleton(a)(Data_Unit.unit)},isEmpty=function(v){return Data_Map_Internal.isEmpty(v)},insert=function(dictOrd){return function(a){return function(v){return Data_Map_Internal.insert(dictOrd)(a)(Data_Unit.unit)(v)}}},foldableSet=new Data_Foldable.Foldable(function(dictMonoid){return function(f){var $65=Data_Foldable.foldMap(Data_List_Types.foldableList)(dictMonoid)(f);return function($66){return $65(toList($66))}}},function(f){return function(x){var $67=Data_Foldable.foldl(Data_List_Types.foldableList)(f)(x);return function($68){return $67(toList($68))}}},function(f){return function(x){var $69=Data_Foldable.foldr(Data_List_Types.foldableList)(f)(x);return function($70){return $69(toList($70))}}}),eqSet=function(dictEq){return new Data_Eq.Eq(function(v){return function(v1){return Data_Eq.eq(Data_Map_Internal.eqMap(dictEq)(Data_Eq.eqUnit))(v)(v1)}})},ordSet=function(dictOrd){return new Data_Ord.Ord(function(){return eqSet(dictOrd.Eq0())},function(s1){return function(s2){return Data_Ord.compare(Data_List_Types.ordList(dictOrd))(toList(s1))(toList(s2))}})},empty=Data_Map_Internal.empty,fromFoldable=function(dictFoldable){return function(dictOrd){return Data_Foldable.foldl(dictFoldable)(function(m){return function(a){return insert(dictOrd)(a)(m)}})(empty)}};exports["fromFoldable"]=fromFoldable;exports["isEmpty"]=isEmpty;exports["singleton"]=singleton;exports["ordSet"]=ordSet;exports["foldableSet"]=foldableSet})(PS);(function($PS){"use strict";$PS["Data.Set.NonEmpty"]=$PS["Data.Set.NonEmpty"]||{};var exports=$PS["Data.Set.NonEmpty"],Data_Maybe=$PS["Data.Maybe"],Data_Set=$PS["Data.Set"],singleton=function(a){return Data_Set.singleton(a)},ordNonEmptySet=function(dictOrd){return Data_Set.ordSet(dictOrd)},fromSet=function(s){var $77=Data_Set.isEmpty(s);if($77)return Data_Maybe.Nothing.value;return new Data_Maybe.Just(s)},fromFoldable=function(dictFoldable){return function(dictOrd){var $86=Data_Set.fromFoldable(dictFoldable)(dictOrd);return function($87){return fromSet($86($87))}}},foldableNonEmptySet=Data_Set.foldableSet;exports["singleton"]=singleton;exports["fromFoldable"]=fromFoldable;exports["ordNonEmptySet"]=ordNonEmptySet;exports["foldableNonEmptySet"]=foldableNonEmptySet})(PS);(function(exports){"use strict";exports.showIntImpl=function(n){return n.toString()};exports.cons=function(head){return function(tail){return[head].concat(tail)}};exports.join=function(separator){return function(xs){return xs.join(separator)}}})(PS["Data.Show"]=PS["Data.Show"]||{});(function($PS){"use strict";$PS["Data.Show"]=$PS["Data.Show"]||{};var exports=$PS["Data.Show"],$foreign=$PS["Data.Show"],Data_Symbol=$PS["Data.Symbol"],Record_Unsafe=$PS["Record.Unsafe"],Type_Data_RowList=$PS["Type.Data.RowList"],ShowRecordFields=function(showRecordFields){this.showRecordFields=showRecordFields},Show=function(show){this.show=show},showRecordFieldsNil=new ShowRecordFields(function(v){return function(v1){return[]}}),showRecordFields=function(dict){return dict.showRecordFields},showRecord=function(dictRowToList){return function(dictShowRecordFields){return new Show(function(record){var v=showRecordFields(dictShowRecordFields)(Type_Data_RowList.RLProxy.value)(record);if(v.length===0)return"{}";return $foreign.join(" ")(["{",$foreign.join(", ")(v),"}"])})}},showInt=new Show($foreign.showIntImpl),showBoolean=new Show(function(v){if(v)return"true";if(!v)return"false";throw new Error("Failed pattern match at Data.Show (line 20, column 1 - line 22, column 23): "+[v.constructor.name])}),show=function(dict){return dict.show},showRecordFieldsCons=function(dictIsSymbol){return function(dictShowRecordFields){return function(dictShow){return new ShowRecordFields(function(v){return function(record){var tail=showRecordFields(dictShowRecordFields)(Type_Data_RowList.RLProxy.value)(record),key=Data_Symbol.reflectSymbol(dictIsSymbol)(Data_Symbol.SProxy.value),focus=Record_Unsafe.unsafeGet(key)(record);return $foreign.cons($foreign.join(": ")([key,show(dictShow)(focus)]))(tail)}})}}};exports["Show"]=Show;exports["show"]=show;exports["showBoolean"]=showBoolean;exports["showInt"]=showInt;exports["showRecord"]=showRecord;exports["showRecordFieldsNil"]=showRecordFieldsNil;exports["showRecordFieldsCons"]=showRecordFieldsCons})(PS);(function(exports){"use strict";var hasArrayFrom=typeof Array.from==="function",hasStringIterator=typeof Symbol!=="undefined"&&Symbol!=null&&typeof Symbol.iterator!=="undefined"&&typeof String.prototype[Symbol.iterator]==="function",hasFromCodePoint=typeof String.prototype.fromCodePoint==="function",hasCodePointAt=typeof String.prototype.codePointAt==="function";exports._unsafeCodePointAt0=function(fallback){return hasCodePointAt?function(str){return str.codePointAt(0)}:fallback};exports._countPrefix=function(fallback){return function(unsafeCodePointAt0){if(hasStringIterator)return function(pred){return function(str){var iter=str[Symbol.iterator]();for(var cpCount=0;;++cpCount){var o=iter.next();if(o.done)return cpCount;var cp=unsafeCodePointAt0(o.value);if(!pred(cp))return cpCount}}};return fallback}};exports._singleton=function(fallback){return hasFromCodePoint?String.fromCodePoint:fallback};exports._take=function(fallback){return function(n){if(hasStringIterator)return function(str){var accum="",iter=str[Symbol.iterator]();for(var i=0;i<n;++i){var o=iter.next();if(o.done)return accum;accum+=o.value};return accum};return fallback(n)}};exports._toCodePointArray=function(fallback){return function(unsafeCodePointAt0){if(hasArrayFrom)return function(str){return Array.from(str,unsafeCodePointAt0)};return fallback}}})(PS["Data.String.CodePoints"]=PS["Data.String.CodePoints"]||{});(function(exports){"use strict";exports.toCharArray=function(s){return s.split("")};exports.singleton=function(c){return c};exports.length=function(s){return s.length};exports.drop=function(n){return function(s){return s.substring(n)}}})(PS["Data.String.CodeUnits"]=PS["Data.String.CodeUnits"]||{});(function($PS){"use strict";$PS["Data.String.CodeUnits"]=$PS["Data.String.CodeUnits"]||{};var exports=$PS["Data.String.CodeUnits"],$foreign=$PS["Data.String.CodeUnits"];exports["singleton"]=$foreign.singleton;exports["toCharArray"]=$foreign.toCharArray;exports["length"]=$foreign.length;exports["drop"]=$foreign.drop})(PS);(function(exports){"use strict";exports.charAt=function(i){return function(s){if(i>=0&&i<s.length)return s.charAt(i);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}}})(PS["Data.String.Unsafe"]=PS["Data.String.Unsafe"]||{});(function($PS){"use strict";$PS["Data.String.Unsafe"]=$PS["Data.String.Unsafe"]||{};var exports=$PS["Data.String.Unsafe"],$foreign=$PS["Data.String.Unsafe"];exports["charAt"]=$foreign.charAt})(PS);(function($PS){"use strict";$PS["Data.String.CodePoints"]=$PS["Data.String.CodePoints"]||{};var exports=$PS["Data.String.CodePoints"],$foreign=$PS["Data.String.CodePoints"],Data_Array=$PS["Data.Array"],Data_Bounded=$PS["Data.Bounded"],Data_Enum=$PS["Data.Enum"],Data_Eq=$PS["Data.Eq"],Data_EuclideanRing=$PS["Data.EuclideanRing"],Data_Functor=$PS["Data.Functor"],Data_Maybe=$PS["Data.Maybe"],Data_String_CodeUnits=$PS["Data.String.CodeUnits"],Data_String_Unsafe=$PS["Data.String.Unsafe"],Data_Tuple=$PS["Data.Tuple"],Data_Unfoldable=$PS["Data.Unfoldable"],CodePoint=function(x){return x},unsurrogate=function(lead){return function(trail){return(((lead-55296|0)*1024|0)+(trail-56320|0)|0)+65536|0}},isTrail=function(cu){return 56320<=cu&&cu<=57343},isLead=function(cu){return 55296<=cu&&cu<=56319},uncons=function(s){var v=Data_String_CodeUnits.length(s);if(v===0)return Data_Maybe.Nothing.value;if(v===1)return new Data_Maybe.Just({head:Data_Enum.fromEnum(Data_Enum.boundedEnumChar)(Data_String_Unsafe.charAt(0)(s)),tail:""});var cu1=Data_Enum.fromEnum(Data_Enum.boundedEnumChar)(Data_String_Unsafe.charAt(1)(s)),cu0=Data_Enum.fromEnum(Data_Enum.boundedEnumChar)(Data_String_Unsafe.charAt(0)(s)),$21=isLead(cu0)&&isTrail(cu1);if($21)return new Data_Maybe.Just({head:unsurrogate(cu0)(cu1),tail:Data_String_CodeUnits.drop(2)(s)});return new Data_Maybe.Just({head:cu0,tail:Data_String_CodeUnits.drop(1)(s)})},unconsButWithTuple=function(s){return Data_Functor.map(Data_Maybe.functorMaybe)(function(v){return new Data_Tuple.Tuple(v.head,v.tail)})(uncons(s))},toCodePointArrayFallback=function(s){return Data_Unfoldable.unfoldr(Data_Unfoldable.unfoldableArray)(unconsButWithTuple)(s)},unsafeCodePointAt0Fallback=function(s){var cu0=Data_Enum.fromEnum(Data_Enum.boundedEnumChar)(Data_String_Unsafe.charAt(0)(s)),$25=isLead(cu0)&&Data_String_CodeUnits.length(s)>1;if($25){var cu1=Data_Enum.fromEnum(Data_Enum.boundedEnumChar)(Data_String_Unsafe.charAt(1)(s)),$26=isTrail(cu1);if($26)return unsurrogate(cu0)(cu1);return cu0};return cu0},unsafeCodePointAt0=$foreign["_unsafeCodePointAt0"](unsafeCodePointAt0Fallback),toCodePointArray=$foreign["_toCodePointArray"](toCodePointArrayFallback)(unsafeCodePointAt0),length=function($52){return Data_Array.length(toCodePointArray($52))},fromCharCode=(function(){var $53=Data_Enum.toEnumWithDefaults(Data_Enum.boundedEnumChar)(Data_Bounded.bottom(Data_Bounded.boundedChar))(Data_Bounded.top(Data_Bounded.boundedChar));return function($54){return Data_String_CodeUnits.singleton($53($54))}})(),singletonFallback=function(v){if(v<=65535)return fromCharCode(v);var lead=Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(v-65536|0)(1024)+55296|0,trail=Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v-65536|0)(1024)+56320|0;return fromCharCode(lead)+fromCharCode(trail)},singleton=$foreign["_singleton"](singletonFallback),takeFallback=function(n){return function(v){if(n<1)return"";var v1=uncons(v);if(v1 instanceof Data_Maybe.Just)return singleton(v1.value0.head)+takeFallback(n-1|0)(v1.value0.tail);return v}},take=$foreign["_take"](takeFallback),eqCodePoint=new Data_Eq.Eq(function(x){return function(y){return x===y}}),drop=function(n){return function(s){return Data_String_CodeUnits.drop(Data_String_CodeUnits.length(take(n)(s)))(s)}},countTail=function($copy_p){return function($copy_s){return function($copy_accum){var $tco_var_p=$copy_p,$tco_var_s=$copy_s,$tco_done=false,$tco_result;function $tco_loop(p,s,accum){var v=uncons(s);if(v instanceof Data_Maybe.Just){var $39=p(v.value0.head);if($39){$tco_var_p=p;$tco_var_s=v.value0.tail;$copy_accum=accum+1|0;return};$tco_done=true;return accum};$tco_done=true;return accum};while(!$tco_done)$tco_result=$tco_loop($tco_var_p,$tco_var_s,$copy_accum);return $tco_result}}},countFallback=function(p){return function(s){return countTail(p)(s)(0)}},countPrefix=$foreign["_countPrefix"](countFallback)(unsafeCodePointAt0),dropWhile=function(p){return function(s){return drop(countPrefix(p)(s))(s)}},codePointFromChar=(function(){var $55=Data_Enum.fromEnum(Data_Enum.boundedEnumChar);return function($56){return CodePoint($55($56))}})();exports["codePointFromChar"]=codePointFromChar;exports["drop"]=drop;exports["dropWhile"]=dropWhile;exports["eqCodePoint"]=eqCodePoint})(PS);(function(exports){"use strict";exports.split=function(sep){return function(s){return s.split(sep)}}})(PS["Data.String.Common"]=PS["Data.String.Common"]||{});(function($PS){"use strict";$PS["Data.String.Common"]=$PS["Data.String.Common"]||{};var exports=$PS["Data.String.Common"],$foreign=$PS["Data.String.Common"];exports["split"]=$foreign.split})(PS);(function(exports){"use strict";exports.traverseArrayImpl=function(){function array1(a){return[a]}
function array2(a){return function(b){return[a,b]}}
function array3(a){return function(b){return function(c){return[a,b,c]}}}
function concat2(xs){return function(ys){return xs.concat(ys)}};return function(apply){return function(map){return function(pure){return function(f){return function(array){function go(bot,top){switch(top-bot){case 0:return pure([]);case 1:return map(array1)(f(array[bot]));case 2:return apply(map(array2)(f(array[bot])))(f(array[bot+1]));case 3:return apply(apply(map(array3)(f(array[bot])))(f(array[bot+1])))(f(array[bot+2]));default:var pivot=bot+Math.floor((top-bot)/4)*2;return apply(map(concat2)(go(bot,pivot)))(go(pivot,top))}};return go(0,array.length)}}}}}}()})(PS["Data.Traversable"]=PS["Data.Traversable"]||{});(function($PS){"use strict";$PS["Data.Traversable"]=$PS["Data.Traversable"]||{};var exports=$PS["Data.Traversable"],$foreign=$PS["Data.Traversable"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Category=$PS["Control.Category"],Data_Foldable=$PS["Data.Foldable"],Data_Functor=$PS["Data.Functor"],Traversable=function(Foldable1,Functor0,sequence,traverse){this.Foldable1=Foldable1;this.Functor0=Functor0;this.sequence=sequence;this.traverse=traverse},traverse=function(dict){return dict.traverse},sequenceDefault=function(dictTraversable){return function(dictApplicative){return traverse(dictTraversable)(dictApplicative)(Control_Category.identity(Control_Category.categoryFn))}},traversableArray=new Traversable(function(){return Data_Foldable.foldableArray},function(){return Data_Functor.functorArray},function(dictApplicative){return sequenceDefault(traversableArray)(dictApplicative)},function(dictApplicative){return $foreign.traverseArrayImpl(Control_Apply.apply(dictApplicative.Apply0()))(Data_Functor.map((dictApplicative.Apply0()).Functor0()))(Control_Applicative.pure(dictApplicative))}),$$for=function(dictApplicative){return function(dictTraversable){return function(x){return function(f){return traverse(dictTraversable)(dictApplicative)(f)(x)}}}};exports["Traversable"]=Traversable;exports["traverse"]=traverse;exports["sequenceDefault"]=sequenceDefault;exports["for"]=$$for;exports["traversableArray"]=traversableArray})(PS);(function(exports){"use strict";exports.error=function(msg){return new Error(msg)};exports.throwException=function(e){return function(){throw e}}})(PS["Effect.Exception"]=PS["Effect.Exception"]||{});(function($PS){"use strict";$PS["Effect.Exception"]=$PS["Effect.Exception"]||{};var exports=$PS["Effect.Exception"],$foreign=$PS["Effect.Exception"];exports["error"]=$foreign.error;exports["throwException"]=$foreign.throwException})(PS);(function(exports){"use strict";exports.unsafePerformEffect=function(f){return f()}})(PS["Effect.Unsafe"]=PS["Effect.Unsafe"]||{});(function($PS){"use strict";$PS["Effect.Unsafe"]=$PS["Effect.Unsafe"]||{};var exports=$PS["Effect.Unsafe"],$foreign=$PS["Effect.Unsafe"];exports["unsafePerformEffect"]=$foreign.unsafePerformEffect})(PS);(function($PS){"use strict";$PS["Effect.Exception.Unsafe"]=$PS["Effect.Exception.Unsafe"]||{};var exports=$PS["Effect.Exception.Unsafe"],Effect_Exception=$PS["Effect.Exception"],Effect_Unsafe=$PS["Effect.Unsafe"],unsafeThrowException=function($0){return Effect_Unsafe.unsafePerformEffect(Effect_Exception.throwException($0))},unsafeThrow=function($1){return unsafeThrowException(Effect_Exception.error($1))};exports["unsafeThrow"]=unsafeThrow})(PS);(function(exports){"use strict";exports.new=function(val){return function(){return{value:val}}};exports.read=function(ref){return function(){return ref.value}};exports.write=function(val){return function(ref){return function(){ref.value=val;return{}}}}})(PS["Effect.Ref"]=PS["Effect.Ref"]||{});(function($PS){"use strict";$PS["Effect.Ref"]=$PS["Effect.Ref"]||{};var exports=$PS["Effect.Ref"],$foreign=$PS["Effect.Ref"];exports["new"]=$foreign["new"];exports["read"]=$foreign.read;exports["write"]=$foreign.write})(PS);(function(exports){"use strict";exports.runEffectFn1=function runEffectFn1(fn){return function(a){return function(){return fn(a)}}}})(PS["Effect.Uncurried"]=PS["Effect.Uncurried"]||{});(function($PS){"use strict";$PS["Effect.Uncurried"]=$PS["Effect.Uncurried"]||{};var exports=$PS["Effect.Uncurried"],$foreign=$PS["Effect.Uncurried"];exports["runEffectFn1"]=$foreign.runEffectFn1})(PS);(function(exports){"use strict";const sansSerif="Helvetica Neue,Helvetica,Arial,sans-serif",sameArray=function(xs,ys){const lx=xs.length,ly=ys.length;if(lx==ly){for(const i of d3.range(lx))if(xs[i]!=ys[i])return false;return true}else return false};exports.logMe=function(x){return function(){console.log(x)}};const binom=function(n,k){let x=1;let i=1;while(i<=k){x=x*(n+1-i)/i;i=i+1};return x};exports._binom=binom;exports.factorial=function(n){let i=2;let x=1;while(i<=n){x=x*i;i=i+1};return x};exports._chompPascal=function(q0,n,k0,f){let i=0;let q=q0;let k=k0;while(k>0){const x=binom(n+k-1,n-1);if(q>=x){i=i+1;q=q-x;k=k-1}else break};return f(i)(q)(k)};const ixChomper=function(n,x,f){let k=0;let z=0;while(true){const z2=binom(n+k,n);if(z2>x){return f(x-z)(k)}else{k=k+1;z=z2}}},ixPascal=function(n,x){let y=x;let i=0;let res=[];while(true)if(i<n){ixChomper(n-i,y,y2=>function(s){y=y2;i=i+1;res.unshift(s)})}else return res};exports._ixPascal=ixPascal;const pascalIx=function(ps){let res=0;ps.forEach(function(p,i){if(p>0)res+=binom(p+i,p-1)});return res};exports.pascalIx=pascalIx;const maxBinom=function(n,lim){let i=0;while(true){if(binom(n+i,i)>lim)return i;i=i+1}};exports._maxBinom=maxBinom;exports.memoInt=function(f){let table=[];return function(x){if(x in table){return table[x]}else{const res=f(x);table[x]=res;return res}}};exports._toIntMap=function(extractor,merger,bazaar){let res=[];bazaar(x=>function(){extractor(x)(i=>y=>function(){if(i in res){res[i]=merger(res[i])(y)}else res[i]=y})()})();return res};const holeyForEach=function(xs,f){for(const i in xs)f(i,xs[i])};exports._unionsIntMap=function(merger,bazaar){let res=[];bazaar(xs=>function(){holeyForEach(xs,function(i,x){if(i in res){res[i]=merger(res[i])(x)}else res[i]=x})})();return res};exports._filterIntMap=function(f,xs){let res=[];holeyForEach(xs,function(i,x){if(f(x))res[i]=x});return res};exports.intMapKeys=function(xs){let res=[];holeyForEach(xs,(i,x)=>res.push(i));return res};exports._singletonIntMap=function(i,x){let res=[];res[i]=x;return res};exports.trace=function(tr){return function(x){console.log(tr);return x}};const MODE={OFF:0,CLEAR:1,SET:2};exports._setupDrawer=function(sel,size,dispPts,callback){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10};return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width,window_size.height]).style("max-width","15em").style("margin","auto").style("display","block"),copyForm=d3.select(sel).append("form").style("max-width","15em").style("margin","1em auto 0 auto").style("display","block").append("input").attr("id","copyblock").style("width","100%");copyForm.on("click",function(e){esel=e.srcElement;esel.select();esel.setSelectionRange(0,999999);document.execCommand("copy")});let activePts=[];let currx=null;let curry=null;let grid={};const mkOutput=function(){return activePts.flatMap((ys,x)=>ys.flatMap((b,y)=>((b)?[{x,y,val:1}]:[])))},drawGrid=function(){grid.drawer(mkOutput())},setCopy=function(){copyForm.attr("value",window.location.origin+window.location.pathname+"?points="+dispPts(mkOutput().map(({x,y})=>({x,y}))))},setGrid=function(xs){activePts=d3.range(size.width).map(()=>d3.range(size.height).map(()=>false));if(xs)xs.forEach(function({x,y}){activePts[x][y]=true});setCopy();drawGrid()};let mode=MODE.OFF;const drawer=function(x,y){currx=x;curry=y;if(mode>MODE.OFF)if(!(x==null||y==null)){const oldset=activePts[x][y],newset=(mode==MODE.SET);activePts[x][y]=newset;if(oldset!=newset)drawGrid()}},gridbox=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);grid=setupGrid(gridbox,"",size.width,size.height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:((x,y)=>drawer(x,y)),onleave:(function(){mode=MODE.OFF})});const clickon=function(e){e.preventDefault();if(!(currx==null||curry==null)){mode=(activePts[currx][curry])?MODE.CLEAR:MODE.SET}else mode=MODE.SET;drawer(currx,curry)},clickoff=function(e){e.preventDefault();mode=MODE.OFF;setCopy();callback(mkOutput().map(({x,y})=>({x,y})))()};grid.grid.on("mousedown",clickon).on("touchstart",clickon).on("mouseup",clickoff).on("touchend",clickoff);setGrid([]);return function(xs){return function(){setGrid(xs);callback(mkOutput().map(({x,y})=>({x,y})))()}}}};const slider_size={height:40,width:200},neighbs2d=[{x:0,y:0},{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:-1,y:-1},{x:-1,y:1},{x:1,y:0},{x:1,y:-1},{x:1,y:1}],inRange=function(mn,mx,x){return(x>=mn&&x<mx)};exports._setupGolFlat=function(sel,showPts,{height,width,maxT,maxDim}){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10},cell_size={height:(window_size.height-margin.top-margin.bottom)/height,width:(window_size.width-margin.left-margin.right)/width};return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width,window_size.height]).style("max-width","15em").style("margin","auto").style("display","block");let dimslidersvg=null;if(maxDim)dimslidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","1em auto 0 auto").style("display","block").style("overflow","visible");const slidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","1em auto 0 auto").style("display","block").style("overflow","visible");let ptsdisp=null;if(showPts)ptsdisp=d3.select(sel).append("div").style("max-width","20em").style("height","10em").style("margin","1em auto 0 auto").style("display","block").append("p").style("text-align","center").style("font-size","90%").style("line-height","125%");let currTime=0;let currDim=0;let currSel=undefined;let locked=false;let ptcache=[];let snapshots=d3.range(maxDim+1).map(()=>d3.range(maxT+1).map(()=>(()=>[])));const grid=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);let gridSetup={};const drawBoxes=function(t,d,sel_,forceNew){const newCells=forceNew||(t!=currTime)||(d!=currDim),sel=locked?currSel:sel_;if(newCells){ptcache=[];const cells=snapshots[t][d]().map(function({x,y,pts}){if(x in ptcache){ptcache[x][y]=pts}else{ptcache[x]=[];ptcache[x][y]=pts};return{x,y,val:pts.length}});gridSetup.drawer(cells)};if(sel!=currSel||newCells)if(sel){const{x,y}=sel,pts=(x in ptcache)?((y in ptcache[x])?ptcache[x][y]:[]):[];if(showPts)if(d>0){const ptsstring=(pts.length==0)?"(no points)":pts.map(pt=>"<"+ixPascal(d,pt).join(",")+">").join(", ");ptsdisp.text(ptsstring).style("font-style",(pts.length==0)?"italic":"normal")}else ptsdisp.text((pts.length==0)?"(no point)":"(single point)").style("font-style","italic");const equivGroup=snapshots[t][d]().flatMap(function(testpt){if(sameArray(testpt.pts,pts)){return[{x:testpt.x,y:testpt.y,val:1}]}else return[]});gridSetup.highlighter(equivGroup)}else{gridSetup.highlighter([]);if(showPts)ptsdisp.text("Hover to view points").style("font-style","italic")};currTime=t;currDim=d;currSel=sel};gridSetup=setupGrid(grid,"",width,height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:((x,y)=>drawBoxes(currTime,currDim,{x,y},false)),onleave:(()=>drawBoxes(currTime,currDim,undefined,false))});if(showPts)gridSetup.grid.on("click",function(e){e.preventDefault();locked=!locked;if(locked){gridSetup.underlighter(0.05)}else gridSetup.underlighter(0)});if(maxDim){const dimselbox=dimslidersvg.append("g").attr("transform","translate(15,0)"),dimslider=d3.sliderBottom().min(0).max(maxDim).step(1).width(slider_size.width-30).ticks(maxDim+1).tickFormat(v=>(v+2)+"").displayFormat(v=>"d="+(v+2)).on("onchange",d=>drawBoxes(currTime,d,currSel,false));dimselbox.call(dimslider);dimslider.value(3)};const controller=setupTimer(slidersvg,maxT+1,slider_size.width,i=>drawBoxes(i,currDim,currSel,false));return function(newsnaps){return function(){snapshots=newsnaps;locked=false;controller.value(0);drawBoxes(0,currDim,undefined,true)}}}};exports._setupGol3D=function(sel,{height,width,maxT}){return function(){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10};d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width*(maxT*2+1),window_size.height]).attr("width","100%").style("margin","auto").style("display","block"),slidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","1em auto").style("display","block").style("overflow","visible"),symmetries=d3.range(0,maxT+1).map(z=>(z>0)?[-z,z]:[z]),cell_size={height:(window_size.height-margin.top-margin.bottom)/height,width:(window_size.width-margin.left-margin.right)/width},grid=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);let fullGrid=[];let clearHighlights=[];let grids=[];const clearAllHighlights=function(){clearHighlights.forEach(highlighter=>highlighter([]));clearHighlights=[]},highlightNeighbs=function(x,y,z,i){clearAllHighlights();[-1,0,1].forEach(function(dz){if(inRange(-maxT,maxT+1,z+dz)){const hltr=fullGrid[z+dz+maxT].highlighter,baseNeighbs=(dz==0)?neighbs2d.slice(1):neighbs2d;hltr(baseNeighbs.map(dxy=>({x:x+dxy.x,y:y+dxy.y,val:1})).filter(xy=>(inRange(0,width,xy.x)&&inRange(0,height,xy.y))));clearHighlights.push(()=>hltr([]))}});grids[i].forEach(function(g){g.underlighter(0.25);clearHighlights.push(()=>g.underlighter(0))})};grids=symmetries.map(function(pos,i){return pos.map(function(z){const res=setupGrid(grid,"z = "+z,width,height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(x,y){highlightNeighbs(x,y,z,i)},onleave:clearAllHighlights});res.grid.attr("transform",`translate(${(maxT+z)*window_size.width},0)`);fullGrid[z+maxT]={drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter};return{drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter}})});let splitCache=[];let refresh=[];let snapshots=d3.range(maxT+1).map(()=>(()=>[]));const drawBoxes=function(j){refresh.forEach(drawer=>drawer([]));refresh=[];let splitCells=[];if(j in splitCache){splitCells=splitCache[j]}else{const cells=snapshots[j]();cells.map(function({x,y,zs}){zs.map(function(z){if(z in splitCells){splitCells[z].push({x,y,val:1})}else splitCells[z]=[{x,y,val:1}]})});splitCache[j]=splitCells};holeyForEach(splitCells,function(z,ps){grids[z].forEach(function({drawer}){drawer(ps);refresh.push(drawer)})})},controller=setupTimer(slidersvg,maxT+1,slider_size.width,drawBoxes);return function(newsnaps){return function(){snapshots=newsnaps;splitCache=[];controller.value(0);drawBoxes(0)}}}};exports._setupGol4D=function(sel,{height,width,maxT}){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10},maxPascal=binom(2+maxT,maxT),symmetries=d3.range(0,maxPascal).map(function(i){const zw=ixPascal(2,i),z0=zw[0],w0=zw[1];let pos=[{z:z0,w:w0}];if(z0!=w0)pos.push({z:w0,w:z0});pos.forEach(function({z,w}){if(z>0)pos.push({z:-z,w:w});if(w>0)pos.push({z:z,w:-w});if(z>0&&w>0)pos.push({z:-z,w:-w})});return pos}),cell_size={height:(window_size.height-margin.top-margin.bottom)/height,width:(window_size.width-margin.left-margin.right)/width};return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width*(maxT*2+1),window_size.height*(maxT*2+1)]).attr("width","100%").style("margin","auto").style("display","block"),slidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","1em auto").style("display","block").style("overflow","visible"),grid=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);let fullGrid=d3.range(2*maxT+1).map(c=>[]);let clearHighlights=[];let grids=[];const clearAllHighlights=function(){clearHighlights.forEach(highlighter=>highlighter([]));clearHighlights=[]},highlightNeighbs=function(x,y,z,w,i){clearAllHighlights();neighbs2d.forEach(function(dzw){if(inRange(-maxT,maxT+1,z+dzw.x)&&inRange(-maxT,maxT+1,w+dzw.y)){const hltr=fullGrid[z+dzw.x+maxT][w+dzw.y+maxT].highlighter,baseNeighbs=(dzw.x==0&&dzw.y==0)?neighbs2d.slice(1):neighbs2d;hltr(baseNeighbs.map(dxy=>({x:x+dxy.x,y:y+dxy.y,val:1})).filter(xy=>(inRange(0,width,xy.x)&&inRange(0,height,xy.y))));clearHighlights.push(()=>hltr([]))}});grids[i].forEach(function(g){const intensity=(Math.abs(z)==Math.abs(g.point.z)&&Math.abs(w)==Math.abs(g.point.w))?0.5:0.25;g.underlighter(intensity);clearHighlights.push(()=>g.underlighter(0))})};grids=symmetries.map(function(pos,i){return pos.map(function({z,w}){const res=setupGrid(grid,z+","+w,width,height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(x,y){highlightNeighbs(x,y,z,w,i)},onleave:clearAllHighlights});res.grid.attr("transform",`translate(${(maxT+z)*window_size.width},${(maxT+w)*window_size.height})`);fullGrid[z+maxT][w+maxT]={drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter};return{drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter,point:{z,w}}})});let snapshots=d3.range(maxT+1).map(()=>(()=>[]));let splitCache=[];let refresh=[];const drawBoxes=function(j){refresh.forEach(drawer=>drawer([]));refresh=[];let splitCells=[];if(j in splitCache){splitCells=splitCache[j]}else{const cells=snapshots[j]();cells.map(function({x,y,zws}){zws.map(function(zw){if(zw in splitCells){splitCells[zw].push({x,y,val:1})}else splitCells[zw]=[{x,y,val:1}]})});splitCache[j]=splitCells};holeyForEach(splitCells,function(zw,ps){grids[zw].forEach(function({drawer}){drawer(ps);refresh.push(drawer)})})},controller=setupTimer(slidersvg,maxT+1,slider_size.width,drawBoxes);return function(newsnaps){return function(){snapshots=newsnaps;splitCache=[];controller.value(0);drawBoxes(0)}}}};const normalize4d=function({x,y}){const x_=Math.abs(x),y_=Math.abs(y);return(x_>y_)?{x:y_,y:x_}:{x:x_,y:y_}},pascalIx2d=({x,y})=>pascalIx([x,y]),pushOrAdd=function(xs,i,x){if(i in xs){xs[i].push(x)}else xs[i]=[x]},compressVals=function(ps){let xs=[];ps.forEach(function({x,y,val}){if(x in xs){if(!(y in xs[x]))xs[x][y]=0}else{xs[x]=[];xs[x][y]=0};xs[x][y]+=val});let out=[];holeyForEach(xs,function(x,ys){holeyForEach(ys,function(y,val){out.push({x,y,val})})});return out},neighbsArray=function(dim,maxZW,mkPt,reversed){const maxPascal=binom(dim+maxZW,maxZW),neighbDeltas=d3.cross(...d3.range(dim).map(()=>[0,-1,1])).slice(1);let res=d3.range(0,maxPascal).map(()=>({neighbBox:[],neighbHighlight:[]}));d3.range(0,maxPascal).forEach(function(i){const pos=ixPascal(dim,i);neighbDeltas.forEach(function(dp){const npos=d3.zip(pos,dp).map(([p,dp])=>Math.abs(p+dp));npos.sort();const j=pascalIx(npos),newPt=mkPt(dp);if(j<maxPascal)if(reversed){pushOrAdd(res[j].neighbHighlight,j,newPt);pushOrAdd(res[j].neighbBox,i,newPt)}else{pushOrAdd(res[i].neighbBox,j,newPt);pushOrAdd(res[i].neighbHighlight,i,newPt)}})});return res.map(({neighbBox,neighbHighlight})=>({neighbBox:neighbBox.map(compressVals),neighbHighlight:neighbHighlight.map(compressVals)}))};exports._drawGolSyms=function(sel,maxZ,{dim,gridSize,ptPos},reversed){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10},maxPascal=binom(dim+maxZ,maxZ),neighbs=neighbsArray(dim,maxZ,(function(x){const p=ptPos(x.map((y)=>y+1));return{x:p.x,y:gridSize.height-1-p.y,val:1}}),reversed),topBorder=ptPos(ixPascal(dim,maxPascal-1));return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width*(topBorder.x+1),window_size.height*(topBorder.y+1)]).style("max-width","30em").style("margin","auto").style("display","block").style("overflow","visible"),allBoxes=svg.append("g");let boxes=[];let clearHighlights=[];const clearAllHighlights=function(){clearHighlights.forEach(clr=>clr());clearHighlights=[]},highlightNeighbs=function(i){clearAllHighlights();holeyForEach(neighbs[i].neighbBox,function(j,ps){boxes[j].drawer(ps);boxes[j].settext(ps.length+"");boxes[j].underlighter(ps.length/8);clearHighlights.push(()=>boxes[j].drawer([]));clearHighlights.push(()=>boxes[j].settext(""));clearHighlights.push(()=>boxes[j].underlighter(0))});holeyForEach(neighbs[i].neighbHighlight,function(j,ps){boxes[j].highlighter(ps);clearHighlights.push(()=>boxes[j].highlighter([]))});if(!(i in neighbs[i].neighbBox)){boxes[i].settext("0");clearHighlights.push(()=>boxes[i].settext(""))}};boxes=d3.range(0,maxPascal).map(function(i){const zw=ixPascal(dim,i),pos=ptPos(zw),res=setupGrid(allBoxes,zw.join(", "),gridSize.width,gridSize.height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(){highlightNeighbs(i)},onleave:clearAllHighlights});res.grid.attr("transform",`translate(${window_size.width*pos.x+margin.left},${window_size.height*(topBorder.y-pos.y)+margin.top})`);return{drawer:res.drawer,highlighter:res.highlighter,settext:res.settext,underlighter:res.underlighter}});return svg}};exports._drawGolSyms5D=function(sel,getNeighbs){const window_size={height:200,width:200},maxZWQ=5,margin={top:0,bottom:0,left:0,right:0,inter:30},maxPascal=binom(3+maxZWQ,maxZWQ),windowOffset=i=>(i==0)?0:binom(1+i,i-1),qOffset=i=>window_size.width*windowOffset(i)+margin.inter*i;let neighbs=[];const revNeighbs=d3.range(maxPascal).map(function(i){const ns=getNeighbs(i);holeyForEach(ns,function(j,wt){if(!(j in neighbs))neighbs[j]=[];neighbs[j][i]=wt});return ns});return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,qOffset(maxZWQ+1),window_size.height*(maxZWQ+1)]).attr("width","100%").style("margin","auto").style("overflow","visible").style("display","block"),setupBox=function(g,txt,boxsize,handlers){const box=g.append("g"),underlight=box.append("rect").attr("width",boxsize).attr("height",boxsize).attr("fill","yellow").attr("opacity",0),outline=box.append("rect").attr("width",boxsize).attr("height",boxsize).attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("stroke-opacity",0.75),mover=function(e){e.preventDefault();if("onmove" in handlers)handlers.onmove()},leaver=function(e){if("onleave" in handlers)handlers.onleave()},botlab=box.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",40).attr("font-family",sansSerif).attr("transform",`translate(${boxsize/2},${boxsize*7/8})`).text(txt),mkCircle=function(col){const circcont=box.append("g"),circ=circcont.append("circle").attr("fill",col).attr("r",0).attr("transform",`translate(0,${boxsize/2})`).attr("opacity",0.75).style("transition","r 500ms ease"),lab=circcont.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",50).attr("font-family",sansSerif).attr("font-weight","bold").attr("transform",`translate(0,${boxsize*(3/10)})`),circfunc=function setCirc(d,l){circ.attr("r",Math.sqrt(d)*boxsize/4);lab.text(l)};return{box,circcont,circfunc}},circ1=mkCircle("red");circ1.circcont.attr("transform",`translate(${boxsize/4},0)`);const circ2=mkCircle("blue");circ2.circcont.attr("transform",`translate(${boxsize*3/4},0)`);const capture=box.append("rect").attr("width",boxsize).attr("height",boxsize).attr("fill","white").attr("opacity",0);capture.on("touchstart",mover).on("touchend",leaver).on("mouseenter",mover).on("mouseleave",leaver);const underlighter=function(o){underlight.attr("opacity",o)};return{box,circ1func:circ1.circfunc,circ2func:circ2.circfunc,underlighter}},allboxes=svg.append("g");let boxes=[];let clearHighlights=[];const clearNeighbs=function(){clearHighlights.forEach(clr=>clr());clearHighlights=[]},highlightNeighbs=function(i){clearNeighbs();const to=neighbs[i],from=revNeighbs[i];holeyForEach(to,function(x,weight){if(x in boxes){boxes[x].circ1func(weight/8,weight+"");boxes[x].underlighter(0.2);clearHighlights.push(()=>{boxes[x].circ1func(0,"");boxes[x].underlighter(0)})}});holeyForEach(from,function(x,weight){if(x in boxes){boxes[x].circ2func(weight/8,weight+"");boxes[x].underlighter(0.2);clearHighlights.push(()=>{boxes[x].circ2func(0,"");boxes[x].underlighter(0)})}})};boxes=d3.range(0,maxPascal).map(function(i){const zwq=ixPascal(3,i),z0=zwq[0],w0=zwq[1],q0=zwq[2],boxfuncs=setupBox(allboxes,zwq.join(", "),window_size.width-margin.left-margin.right,{onmove:(()=>highlightNeighbs(i)),onleave:(()=>clearNeighbs())});boxfuncs.box.attr("transform",`translate(${qOffset(q0)+window_size.width*z0+margin.left},${window_size.height*(maxZWQ-w0)+margin.top})`);return boxfuncs});return svg}};const setupGrid=function(svg,label,numx,numy,width,height,handlers){const cell_width=width/numx,cell_height=height/numy,grid=svg.append("g"),underlight=grid.append("rect").attr("width",width).attr("height",height).attr("fill","yellow").attr("opacity",0),boxes=grid.append("g"),xlines=grid.append("g").selectAll("line").data(d3.range(numx-1)).join("line").attr("stroke-opacity",0.3).attr("stroke","black").attr("stroke-width",0.5).attr("x1",d=>(d+1)*cell_width).attr("y1",0).attr("x2",d=>(d+1)*cell_width).attr("y2",height),ylines=grid.append("g").selectAll("line").data(d3.range(numy-1)).join("line").attr("stroke-opacity",0.3).attr("stroke","black").attr("stroke-width",0.5).attr("y1",d=>(d+1)*cell_height).attr("x1",0).attr("y2",d=>(d+1)*cell_height).attr("x2",width),highlights=grid.append("g"),lab=grid.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",(width+height)/10).attr("font-family",sansSerif).attr("transform",`translate(${width/2},${height*9/10})`).attr("opacity",0.85).text(label),hightext=grid.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",(width+height)/6).attr("font-family",sansSerif).attr("transform",`translate(${width/2},${height*(2/3-1/20)})`).attr("opacity",0.85).text(""),outline=grid.append("rect").attr("width",width).attr("height",height).attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("stroke-opacity",0.75),capture=grid.append("rect").attr("width",width).attr("height",height).attr("fill","white").attr("opacity",0),mover=function(e){e.preventDefault();const[mx,my]=d3.pointer(e,this),x=Math.floor(mx/cell_width),y=Math.floor(my/cell_height);if(x>=0&&x<numx&&y>=0&&y<numy)handlers.onmove(x,y)},leaver=function(e){if("onleave" in handlers)handlers.onleave()};if("onmove" in handlers)capture.on("touchmove",mover).on("touchstart",mover).on("mousemove",mover).on("mouseenter",mover);if("onleave" in handlers)capture.on("touchend",()=>handlers.onleave()).on("mouseleave",()=>handlers.onleave());const mkDrawer=function(s,col,o){return function(cells){const max=d3.max(cells,d=>d.val),color=d3.scaleSequential(col).domain([0,max]);s.selectAll("*").remove();s.selectAll("rect").data(cells).join("rect").attr("width",cell_width).attr("height",cell_height).attr("x",d=>d.x*cell_width).attr("y",d=>d.y*cell_height).attr("fill",d=>color(d.val)).style("opacity",o)}};return{grid,drawer:mkDrawer(boxes,d3.interpolateGreens,0.8),highlighter:mkDrawer(highlights,d3.interpolateBlues,0.3),underlighter:function(o){underlight.attr("opacity",o)},settext:function(t){hightext.text(t)}}},setupTimer=function(svg,size,width,callback){const tAxis=function(g){const sliderino=d3.sliderBottom().min(0).max(size-1).step(1).width(width-30).ticks(size).tickFormat(v=>"").displayFormat(v=>"");g.call(sliderino);return sliderino};let timer=null;const subslider=svg.append("g"),slidercont=subslider.append("g").attr("transform","translate(15,0)"),sliderino=tAxis(slidercont.append("g")).on('onchange',callback);callback(sliderino.value());const button=subslider.append("g"),drawButton=function(g,playing,callback){g.select("*").remove();g.append("rect").attr("width",50).attr("height",18).attr("rx",2).style("fill","#eee").attr("stroke","#aaa").attr("stroke-width",0.5).style("margin",0).style("padding",0).attr("transform",`translate(${width/2-25},20)`);const txt=g.append("text").attr("fill","#555").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",10).text(playing?"Pause":"Play"),tbb=txt.node().getBBox();txt.attr("transform",`translate(${width/2},${20+18/2+tbb.height/2-2})`);g.on("click",null).on("click",callback)},play_start=function(){button.call(drawButton,true,play_stop);play_tick();timer=setInterval(play_tick,1000)},play_stop=function(){button.call(drawButton,false,play_start);clearInterval(timer);timer=null},play_tick=function(){const currval=sliderino.value(),nextval=(currval+1)%size;sliderino.value(nextval)};play_stop();return sliderino};exports._buildHierarchy=function(x,f){return d3.hierarchy(x,f)};const expandRun=r=>r.flatMap((d,i)=>d3.range(d).map(()=>i));exports._drawTree=function(sel,vecRun,mkHier,getContrib){const margin={top:10,bottom:10,left:30,right:42},optSizeLim=85,maxZLim=5,expandChosens=function(c){const contlen=c.leftovers.length,choselen=c.chosen.length,pad=d3.range(contlen-choselen).map(()=>0),fullchose=pad.concat(c.chosen),expandLeft=expandRun(c.leftovers),prefix=(expandLeft.length>0)?("["+expandLeft.join(",")+"]"):"",suffix=expandRun(fullchose).join(","),infix=(prefix.length>0&&suffix.length>0)?",":"";return"<"+prefix+infix+suffix+">"},expandParts=function(c){const parts=c.parts;return[parts.left,parts.here,parts.right].filter(x=>!(x===null)).join("+")};return function(){d3.select(sel).selectAll("p").remove();const dimslidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","0.25em auto 0 auto").style("display","block").style("overflow","visible"),formElems=d3.select(sel).append("form").style("max-width","15em").style("margin","0 auto 0 auto").style("display","block"),selbox=formElems.append("select").style("width","100%"),radioopt=[{label:"forward",checked:"false"},{label:"reverse",checked:"true"}];let forward=false;const dirradio=formElems.append("div").style("width","100%").style("text-align","center").style("font-size","90%").style("margin-top","0.25em"),raddivs=dirradio.selectAll("div").data(radioopt).join("div").attr("class","pretty p-default p-round"),radinps=raddivs.append("input").attr("type","radio").attr("name","neighbdir").attr("value",d=>d.label).attr("checked",d=>d.checked?"":null);raddivs.append("div").attr("class","state").append("label").attr("for",d=>d.label).text(d=>d.label);const svg=d3.select(sel).append("svg").attr("width","100%").style("margin","auto").style("overflow","visible").style("display","block"),setupSelect=function(dim){selbox.selectAll("*").remove();const maxZ=Math.min(maxBinom(dim,optSizeLim)-1,maxZLim),numOpts=binom(dim+maxZ,maxZ),ptOpts=d3.range(numOpts).map(function(d){const vr=vecRun(dim)(d).slice(0,-1),pt=ixPascal(dim,d);return{pt:d,disp:"<"+pt.join(",")+"> ("+vr.join("-")+")"}});selbox.selectAll("option").data(ptOpts).join("option").attr("value",d=>d.pt).text(d=>d.disp)},dimselbox=dimslidersvg.append("g").attr("transform","translate(15,0)"),dimslider=d3.sliderBottom().min(1).max(6).step(1).width(slider_size.width-30).ticks(6).tickFormat(v=>(v+2)+"").displayFormat(v=>"d="+(v+2));dimselbox.call(dimslider);let currpt=[];currpt[1]=1;currpt[2]=4;currpt[3]=6;currpt[4]=22;currpt[5]=9;currpt[6]=9;const drawTree=function(){svg.selectAll("*").remove();const dim=dimslider.value(),pt=currpt[dim],hier=mkHier(dim)(pt),numchild=hier.leaves().length,window_size={height:numchild*15+margin.top+margin.bottom,width:400},tree=d3.tree().size([window_size.height-margin.top-margin.bottom,window_size.width-margin.left-margin.right])(hier);svg.attr("viewBox",[0,0,window_size.width,window_size.height]);selbox.property("value",pt);const treecont=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`),link=treecont.append("g");link.selectAll("path").data(tree.links()).join("path").attr("fill","none").attr("stroke","#555").attr("stroke-opacity",0.4).attr("stroke-width",1).attr("d",d3.linkHorizontal().x(d=>d.y).y(d=>d.x));const node=treecont.append("g").attr("stroke-linejoin","round").attr("stroke-width",3).selectAll("g").data(tree.descendants()).join("g").attr("transform",d=>`translate(${d.y},${d.x})`),tooltip=treecont.append("g").style("opacity",0.95).attr("display","none");tooltip.append("rect").attr("width",40).attr("height",19).attr("x",-20).attr("y",6).style("fill","#fff").style("stroke","#666").style("stroke-width","0.5px");const tttext1=tooltip.append("text").attr("text-anchor","middle").style("font-size",6.5).attr("font-family",sansSerif).attr("x",0).attr("y",14),tttext2=tooltip.append("text").attr("text-anchor","middle").style("font-size",6).style("font-style","italic").attr("font-family",sansSerif).attr("x",0).attr("y",21),dots=node.append("circle").attr("opacity",0.75);node.append("text").attr("text-anchor","end").attr("dy",-1.5).attr("x",-4).attr("opacity",d=>("children" in d)?0.9:0.5).text(d=>getContrib(d.data)().leftovers.join("-")).style("font-weight",d=>(d.parent)?"normal":"bold");node.append("text").attr("text-anchor","end").attr("dy",4.5).attr("x",-4).attr("opacity",d=>(d.parent)?0.9:0.5).text(function(d){const c=getContrib(d.data)(),contlen=c.leftovers.length,choselen=c.chosen.length,pad=d3.range(contlen-choselen).map(()=>"_");return pad.concat(c.chosen).join("-")}).style("font-weight",d=>("children" in d)?"normal":"bold").style("text-decoration",d=>("children" in d)?"none":(getContrib(d.data)().allSame?"line-through":"none"));node.append("text").attr("text-anchor","start").attr("dy",2).attr("x",3).attr("opacity",0.9).text(function(d){const c=getContrib(d.data)(),m=forward?c.multQ():c.multP();if("children" in d){return m.here}else{const endMult=c.allSame?0:m.total;return m.here+" → "+endMult}}).style("text-decoration",d=>("children" in d)?"none":(getContrib(d.data)().allSame?"line-through":"none"));node.selectAll("text").attr("font-family",sansSerif).style("font-size",6).clone(true).lower().attr("stroke","white");const highlightNodes=function(d){const c=getContrib(d.data)(),targChosen=c.chosen;dots.filter(d=>sameArray(targChosen,getContrib(d.data)().chosen)).attr("r",4).attr("fill","blue").attr("opacity","0.5");const ancs=d.ancestors(),checkAnc=function(q){for(const a of ancs)if(a==q)return true;return false};link.selectAll("path").filter(d=>checkAnc(d.target)).attr("stroke-opacity",0.9);tooltip.attr("display",null).attr("transform",`translate(${d.y},${d.x})`);tttext1.text(expandChosens(c));tttext2.text(expandParts(c))},clearNodes=function(){dots.attr("r",d=>(("children" in d)&&d.parent)?1.5:2).attr("fill",d=>(("children" in d)&&d.parent)?"#333":"red").attr("opacity","0.75");link.selectAll("path").attr("stroke-opacity",0.4);tooltip.attr("display","none")};node.append("circle").attr("r",8).attr("opacity",0).on("mouseenter",(e,d)=>highlightNodes(d)).on("touchstart",(e,d)=>highlightNodes(d)).on("mouseleave",()=>clearNodes()).on("touchend",()=>clearNodes());clearNodes()};radinps.on("change",function(d){forward=(d.srcElement.value==="forward");drawTree()});dimslider.on("onchange",d=>{setupSelect(d);drawTree()});selbox.on("change",function(d){currpt[dimslider.value()]=d.srcElement.value;drawTree()});dimslider.value(4);drawTree();return svg}};exports.undefined=0;exports._assignWindow=function(p,x){return function(){window[p]=x}};exports._setInnerHTML=function(e,x){return function(){e.innerHTML=x}}})(PS["Gol"]=PS["Gol"]||{});(function($PS){"use strict";$PS["Matryoshka.Class.Corecursive"]=$PS["Matryoshka.Class.Corecursive"]||{};var exports=$PS["Matryoshka.Class.Corecursive"],Corecursive=function(Functor0,embed){this.Functor0=Functor0;this.embed=embed},embed=function(dict){return dict.embed};exports["embed"]=embed;exports["Corecursive"]=Corecursive})(PS);(function($PS){"use strict";$PS["Matryoshka.Class.Recursive"]=$PS["Matryoshka.Class.Recursive"]||{};var exports=$PS["Matryoshka.Class.Recursive"],Recursive=function(Functor0,project){this.Functor0=Functor0;this.project=project},project=function(dict){return dict.project};exports["project"]=project;exports["Recursive"]=Recursive})(PS);(function($PS){"use strict";$PS["Matryoshka.Fold"]=$PS["Matryoshka.Fold"]||{};var exports=$PS["Matryoshka.Fold"],Data_Functor=$PS["Data.Functor"],Matryoshka_Class_Recursive=$PS["Matryoshka.Class.Recursive"],cata=function(dictRecursive){return function(f){var go=function(t){return f(Data_Functor.map(dictRecursive.Functor0())(go)(Matryoshka_Class_Recursive.project(dictRecursive)(t)))};return go}};exports["cata"]=cata})(PS);(function($PS){"use strict";$PS["Matryoshka.Unfold"]=$PS["Matryoshka.Unfold"]||{};var exports=$PS["Matryoshka.Unfold"],Data_Functor=$PS["Data.Functor"],Matryoshka_Class_Corecursive=$PS["Matryoshka.Class.Corecursive"],ana=function(dictCorecursive){return function(f){var go=function(a){return Matryoshka_Class_Corecursive.embed(dictCorecursive)(Data_Functor.map(dictCorecursive.Functor0())(go)(f(a)))};return go}};exports["ana"]=ana})(PS);(function(exports){"use strict";exports.createElement=function(localName){return function(doc){return function(){return doc.createElement(localName)}}}})(PS["Web.DOM.Document"]=PS["Web.DOM.Document"]||{});(function(exports){"use strict";exports.unsafeCoerce=function(x){return x}})(PS["Unsafe.Coerce"]=PS["Unsafe.Coerce"]||{});(function($PS){"use strict";$PS["Unsafe.Coerce"]=$PS["Unsafe.Coerce"]||{};var exports=$PS["Unsafe.Coerce"],$foreign=$PS["Unsafe.Coerce"];exports["unsafeCoerce"]=$foreign.unsafeCoerce})(PS);(function($PS){"use strict";$PS["Web.DOM.Document"]=$PS["Web.DOM.Document"]||{};var exports=$PS["Web.DOM.Document"],$foreign=$PS["Web.DOM.Document"],Unsafe_Coerce=$PS["Unsafe.Coerce"],toParentNode=Unsafe_Coerce.unsafeCoerce,toEventTarget=Unsafe_Coerce.unsafeCoerce;exports["toParentNode"]=toParentNode;exports["toEventTarget"]=toEventTarget;exports["createElement"]=$foreign.createElement})(PS);(function(exports){"use strict";exports.setAttribute=function(name){return function(value){return function(element){return function(){element.setAttribute(name,value);return{}}}}}})(PS["Web.DOM.Element"]=PS["Web.DOM.Element"]||{});(function($PS){"use strict";$PS["Web.DOM.Element"]=$PS["Web.DOM.Element"]||{};var exports=$PS["Web.DOM.Element"],$foreign=$PS["Web.DOM.Element"],Unsafe_Coerce=$PS["Unsafe.Coerce"],toParentNode=Unsafe_Coerce.unsafeCoerce,toNode=Unsafe_Coerce.unsafeCoerce;exports["toNode"]=toNode;exports["toParentNode"]=toParentNode;exports["setAttribute"]=$foreign.setAttribute})(PS);(function(exports){"use strict";var getEffProp=function(name){return function(node){return function(){return node[name]}}};exports.textContent=getEffProp("textContent");exports.setTextContent=function(value){return function(node){return function(){node.textContent=value;return{}}}};exports.insertBefore=function(node1){return function(node2){return function(parent){return function(){return parent.insertBefore(node1,node2)}}}};exports.appendChild=function(node){return function(parent){return function(){return parent.appendChild(node)}}}})(PS["Web.DOM.Node"]=PS["Web.DOM.Node"]||{});(function($PS){"use strict";$PS["Web.DOM.Node"]=$PS["Web.DOM.Node"]||{};var exports=$PS["Web.DOM.Node"],$foreign=$PS["Web.DOM.Node"];exports["textContent"]=$foreign.textContent;exports["setTextContent"]=$foreign.setTextContent;exports["insertBefore"]=$foreign.insertBefore;exports["appendChild"]=$foreign.appendChild})(PS);(function(exports){"use strict";exports._querySelector=function(selector){return function(node){return function(){return node.querySelector(selector)}}}})(PS["Web.DOM.ParentNode"]=PS["Web.DOM.ParentNode"]||{});(function($PS){"use strict";$PS["Web.DOM.ParentNode"]=$PS["Web.DOM.ParentNode"]||{};var exports=$PS["Web.DOM.ParentNode"],$foreign=$PS["Web.DOM.ParentNode"],Data_Functor=$PS["Data.Functor"],Data_Nullable=$PS["Data.Nullable"],Effect=$PS["Effect"],QuerySelector=function(x){return x},querySelector=function(qs){var $3=Data_Functor.map(Effect.functorEffect)(Data_Nullable.toMaybe),$4=$foreign["_querySelector"](qs);return function($5){return $3($4($5))}};exports["QuerySelector"]=QuerySelector;exports["querySelector"]=querySelector})(PS);(function(exports){"use strict";exports.eventListener=function(fn){return function(){return function(event){return fn(event)()}}};exports.addEventListener=function(type){return function(listener){return function(useCapture){return function(target){return function(){return target.addEventListener(type,listener,useCapture)}}}}}})(PS["Web.Event.EventTarget"]=PS["Web.Event.EventTarget"]||{});(function($PS){"use strict";$PS["Web.Event.EventTarget"]=$PS["Web.Event.EventTarget"]||{};var exports=$PS["Web.Event.EventTarget"],$foreign=$PS["Web.Event.EventTarget"];exports["eventListener"]=$foreign.eventListener;exports["addEventListener"]=$foreign.addEventListener})(PS);(function(exports){"use strict";exports.window=function(){return window}})(PS["Web.HTML"]=PS["Web.HTML"]||{});(function($PS){"use strict";$PS["Web.HTML"]=$PS["Web.HTML"]||{};var exports=$PS["Web.HTML"],$foreign=$PS["Web.HTML"];exports["window"]=$foreign.window})(PS);(function($PS){"use strict";$PS["Web.HTML.Event.EventTypes"]=$PS["Web.HTML.Event.EventTypes"]||{};var exports=$PS["Web.HTML.Event.EventTypes"],readystatechange="readystatechange";exports["readystatechange"]=readystatechange})(PS);(function($PS){"use strict";$PS["Web.HTML.HTMLDocument"]=$PS["Web.HTML.HTMLDocument"]||{};var exports=$PS["Web.HTML.HTMLDocument"],Unsafe_Coerce=$PS["Unsafe.Coerce"],toDocument=Unsafe_Coerce.unsafeCoerce;exports["toDocument"]=toDocument})(PS);(function(exports){"use strict";exports.href=function(location){return function(){return location.href}};exports.search=function(location){return function(){return location.search}}})(PS["Web.HTML.Location"]=PS["Web.HTML.Location"]||{});(function($PS){"use strict";$PS["Web.HTML.Location"]=$PS["Web.HTML.Location"]||{};var exports=$PS["Web.HTML.Location"],$foreign=$PS["Web.HTML.Location"];exports["href"]=$foreign.href;exports["search"]=$foreign.search})(PS);(function(exports){"use strict";exports.document=function(window){return function(){return window.document}};exports.location=function(window){return function(){return window.location}}})(PS["Web.HTML.Window"]=PS["Web.HTML.Window"]||{});(function($PS){"use strict";$PS["Web.HTML.Window"]=$PS["Web.HTML.Window"]||{};var exports=$PS["Web.HTML.Window"],$foreign=$PS["Web.HTML.Window"];exports["document"]=$foreign.document;exports["location"]=$foreign.location})(PS);(function(exports){"use strict";exports.newImpl=function newImpl(x){return new URLSearchParams(x)};exports.getImpl=function getImpl(x,k){return x.get(k)}})(PS["Web.URLSearchParams"]=PS["Web.URLSearchParams"]||{});(function($PS){"use strict";$PS["Web.URLSearchParams"]=$PS["Web.URLSearchParams"]||{};var exports=$PS["Web.URLSearchParams"],$foreign=$PS["Web.URLSearchParams"],Data_Functor=$PS["Data.Functor"],Data_Nullable=$PS["Data.Nullable"],Effect=$PS["Effect"],Effect_Uncurried=$PS["Effect.Uncurried"],$$new=Effect_Uncurried.runEffectFn1($foreign.newImpl),get=function(h){return function(k){return Data_Functor.map(Effect.functorEffect)(Data_Nullable.toMaybe)(function(){return $foreign.getImpl(h,k)})}};exports["new"]=$$new;exports["get"]=get})(PS);(function($PS){"use strict";$PS["Gol"]=$PS["Gol"]||{};var exports=$PS["Gol"],$foreign=$PS["Gol"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Control_Monad_Maybe_Trans=$PS["Control.Monad.Maybe.Trans"],Control_MonadZero=$PS["Control.MonadZero"],Data_Array=$PS["Data.Array"],Data_Bifunctor=$PS["Data.Bifunctor"],Data_Boolean=$PS["Data.Boolean"],Data_Eq=$PS["Data.Eq"],Data_EuclideanRing=$PS["Data.EuclideanRing"],Data_Foldable=$PS["Data.Foldable"],Data_Function=$PS["Data.Function"],Data_Function_Uncurried=$PS["Data.Function.Uncurried"],Data_Functor=$PS["Data.Functor"],Data_Int=$PS["Data.Int"],Data_Lazy=$PS["Data.Lazy"],Data_List_Lazy=$PS["Data.List.Lazy"],Data_List_Lazy_Types=$PS["Data.List.Lazy.Types"],Data_Map_Internal=$PS["Data.Map.Internal"],Data_Maybe=$PS["Data.Maybe"],Data_Monoid=$PS["Data.Monoid"],Data_Monoid_Additive=$PS["Data.Monoid.Additive"],Data_Nullable=$PS["Data.Nullable"],Data_Ord=$PS["Data.Ord"],Data_Semigroup=$PS["Data.Semigroup"],Data_Semiring=$PS["Data.Semiring"],Data_Set=$PS["Data.Set"],Data_Set_NonEmpty=$PS["Data.Set.NonEmpty"],Data_Show=$PS["Data.Show"],Data_String_CodePoints=$PS["Data.String.CodePoints"],Data_String_CodeUnits=$PS["Data.String.CodeUnits"],Data_String_Common=$PS["Data.String.Common"],Data_Symbol=$PS["Data.Symbol"],Data_Traversable=$PS["Data.Traversable"],Data_Tuple=$PS["Data.Tuple"],Data_Unfoldable=$PS["Data.Unfoldable"],Effect=$PS["Effect"],Effect_Class=$PS["Effect.Class"],Effect_Exception_Unsafe=$PS["Effect.Exception.Unsafe"],Effect_Ref=$PS["Effect.Ref"],Matryoshka_Class_Corecursive=$PS["Matryoshka.Class.Corecursive"],Matryoshka_Class_Recursive=$PS["Matryoshka.Class.Recursive"],Matryoshka_Fold=$PS["Matryoshka.Fold"],Matryoshka_Unfold=$PS["Matryoshka.Unfold"],Web_DOM_Document=$PS["Web.DOM.Document"],Web_DOM_Element=$PS["Web.DOM.Element"],Web_DOM_Node=$PS["Web.DOM.Node"],Web_DOM_ParentNode=$PS["Web.DOM.ParentNode"],Web_Event_EventTarget=$PS["Web.Event.EventTarget"],Web_HTML=$PS["Web.HTML"],Web_HTML_Event_EventTypes=$PS["Web.HTML.Event.EventTypes"],Web_HTML_HTMLDocument=$PS["Web.HTML.HTMLDocument"],Web_HTML_Location=$PS["Web.HTML.Location"],Web_HTML_Window=$PS["Web.HTML.Window"],Web_URLSearchParams=$PS["Web.URLSearchParams"],NodeF=(function(){function NodeF(value0,value1){this.value0=value0;this.value1=value1};NodeF.create=function(value0){return function(value1){return new NodeF(value0,value1)}};return NodeF})(),Node=(function(){function Node(value0,value1){this.value0=value0;this.value1=value1};Node.create=function(value0){return function(value1){return new Node(value0,value1)}};return Node})(),FourBit=function(x){return x},validLiveCount=function(v){return v>=5&&v<=7},unionsIntMap=function(dictFoldable){return function(dictSemigroup){return function(xs){return $foreign["_unionsIntMap"](Data_Semigroup.append(dictSemigroup),Data_Foldable.for_(Effect.applicativeEffect)(dictFoldable)(xs))}}},toIntMap=function(dictFoldable){return function(dictSemigroup){return function(xs){return $foreign["_toIntMap"](function(v){return function(f){return f(v.value0)(v.value1)}},Data_Semigroup.append(dictSemigroup),Data_Foldable.for_(Effect.applicativeEffect)(dictFoldable)(xs))}}},singletonIntMap=Data_Function_Uncurried.runFn2($foreign["_singletonIntMap"]),showFourBit=new Data_Show.Show(function(v){return Data_Show.show(Data_Show.showRecord()(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function(){return"ne"}))(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function(){return"nw"}))(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function(){return"se"}))(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function(){return"sw"}))(Data_Show.showRecordFieldsNil)(Data_Show.showBoolean))(Data_Show.showBoolean))(Data_Show.showBoolean))(Data_Show.showBoolean)))(v)}),setInnerHTML=Data_Function_Uncurried.runFn2($foreign["_setInnerHTML"]),semigroupFourBit=new Data_Semigroup.Semigroup(function(v){return function(v1){return{nw:v.nw||v1.nw,ne:v.ne||v1.ne,sw:v.sw||v1.sw,se:v.se||v1.se}}}),safeRange=function(x){return function(y){if(y>=x)return Data_List_Lazy.range(x)(y);if(Data_Boolean.otherwise)return Data_List_Lazy_Types.nil;throw new Error("Failed pattern match at Gol (line 308, column 1 - line 308, column 36): "+[x.constructor.name,y.constructor.name])}},point2ToFourBit=function(v){var y$prime=Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(v.y)(2),x$prime=Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(v.x)(2),ly=Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.y)(2),lx=Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.x)(2);return Data_Tuple.Tuple.create({x:x$prime,y:y$prime})({nw:lx===0&&ly===0,ne:lx===1&&ly===0,sw:lx===0&&ly===1,se:lx===1&&ly===1})},onE=function(etype){return function(targ){return function(h){return function __do(){var listener=Web_Event_EventTarget.eventListener(h)();return Web_Event_EventTarget.addEventListener(etype)(listener)(false)(targ)()}}}},neighbsSet=Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_List_Lazy_Types.applicativeList)(function(x){return Data_List_Lazy_Types.cons(x)(Data_List_Lazy_Types.cons(x-1|0)(Data_List_Lazy_Types.cons(x+1|0)(Data_List_Lazy_Types.nil)))}),neighbs2d=function(n){return function(i){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy_Types.cons(0)(Data_List_Lazy_Types.cons(-1|0)(Data_List_Lazy_Types.cons(1)(Data_List_Lazy_Types.nil))))(function(dx){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy_Types.cons(0)(Data_List_Lazy_Types.cons(-1|0)(Data_List_Lazy_Types.cons(1)(Data_List_Lazy_Types.nil))))(function(dy){return Control_Applicative.pure(Data_List_Lazy_Types.applicativeList)((i+dx|0)+(n*dy|0)|0)})})}},monoidFourBit=new Data_Monoid.Monoid(function(){return semigroupFourBit},{nw:false,ne:false,sw:false,se:false}),maxBinom=Data_Function_Uncurried.runFn2($foreign["_maxBinom"]),makeElemLinks=function(doc){return function(elemMap){var linkStrings=Data_Function.flip(Data_Functor.map(Data_Functor.functorArray))(elemMap)(function(v){return new Data_Tuple.Tuple(v.value0,new Data_Tuple.Tuple(v.value1,"<a href=\""+(v.value0+("\">"+(v.value1+"</a>")))))});return Data_Foldable.for_(Effect.applicativeEffect)(Data_Foldable.foldableArray)(elemMap)(function(v){var withoutSelf=Data_Array.filter(function(v1){return v.value0!==v1.value0})(linkStrings),linkString="Jump to: "+Data_Foldable.intercalate(Data_Foldable.foldableArray)(Data_Monoid.monoidString)(" / ")(Data_Function.flip(Data_Functor.map(Data_Functor.functorArray))(linkStrings)(function(v1){var $104=v1.value0===v.value0;if($104)return v1.value1.value0;return v1.value1.value1}));return function __do(){var container=Web_DOM_ParentNode.querySelector(v.value0)(Web_DOM_Document.toParentNode(doc))();return Data_Foldable.for_(Effect.applicativeEffect)(Data_Foldable.foldableMaybe)(container)(function(c){return function __do(){var listp=Web_DOM_Document.createElement("p")(doc)();setInnerHTML(listp)(linkString)();return Web_DOM_Node.appendChild(Web_DOM_Element.toNode(listp))(Web_DOM_Element.toNode(c))()}})()}})}},lowNeighbs=function(v){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy_Types.cons(v.x)(Data_List_Lazy_Types.cons(v.x-1|0)(Data_List_Lazy_Types.cons(v.x+1|0)(Data_List_Lazy_Types.nil))))(function(x$prime){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy_Types.cons(v.y)(Data_List_Lazy_Types.cons(v.y-1|0)(Data_List_Lazy_Types.cons(v.y+1|0)(Data_List_Lazy_Types.nil))))(function(y$prime){return Control_Applicative.pure(Data_List_Lazy_Types.applicativeList)({x:x$prime,y:y$prime})})})},ixPascal=Data_Function_Uncurried.runFn2($foreign["_ixPascal"]),initialPoints=[{x:0,y:2},{x:1,y:0},{x:1,y:2},{x:2,y:1},{x:2,y:2}],functorVecTreeF=function(dictFunctor){return new Data_Functor.Functor(function(f){return function(m){return new NodeF(m.value0,Data_Functor.map(dictFunctor)(f)(m.value1))}})},vecTreeCorec=function(dictFunctor){return new Matryoshka_Class_Corecursive.Corecursive(function(){return functorVecTreeF(dictFunctor)},function(v){return new Node(v.value0,v.value1)})},vecTreeRec=function(dictFunctor){return new Matryoshka_Class_Recursive.Recursive(function(){return functorVecTreeF(dictFunctor)},function(v){return new NodeF(v.value0,v.value1)})},showVecTree=function(dictFunctor){return function(dictFoldable){return function(dictShow){return new Data_Show.Show(Matryoshka_Fold.cata(vecTreeRec(dictFunctor))(function(v){var xshow="["+(Data_Foldable.intercalate(dictFoldable)(Data_Monoid.monoidString)(",")(v.value1)+"]");return"(Node "+(Data_Show.show(dictShow)(v.value0)+(" "+(xshow+")")))}))}}},functorVecTree=function(dictFunctor){return new Data_Functor.Functor(function(f){return function(m){return new Node(f(m.value0),Data_Functor.map(dictFunctor)(Data_Functor.map(functorVecTree(dictFunctor))(f))(m.value1))}})},fourBitList=function(v){return Data_List_Lazy_Types.cons(v.nw)(Data_List_Lazy_Types.cons(v.ne)(Data_List_Lazy_Types.cons(v.sw)(Data_List_Lazy_Types.cons(v.se)(Data_List_Lazy_Types.nil))))},fourBitToPoint2=function(fb){var pts=Data_List_Lazy_Types.cons({x:0,y:0})(Data_List_Lazy_Types.cons({x:1,y:0})(Data_List_Lazy_Types.cons({x:0,y:1})(Data_List_Lazy_Types.cons({x:1,y:1})(Data_List_Lazy_Types.nil))));return Data_List_Lazy.mapMaybe(function(v){if(v.value1)return new Data_Maybe.Just(v.value0);return Data_Maybe.Nothing.value})(Data_List_Lazy.zip(pts)(fourBitList(fb)))},foldableVecTree=function(dictFoldable){return new Data_Foldable.Foldable(function(dictMonoid){return function(f){return function(v){return Data_Semigroup.append(dictMonoid.Semigroup0())(f(v.value0))(Data_Foldable.foldMap(dictFoldable)(dictMonoid)(Data_Foldable.foldMap(foldableVecTree(dictFoldable))(dictMonoid)(f))(v.value1))}}},Data_Foldable.foldlDefault(foldableVecTree(dictFoldable)),Data_Foldable.foldrDefault(foldableVecTree(dictFoldable)))},traversableVecTree=function(dictTraversable){return new Data_Traversable.Traversable(function(){return foldableVecTree(dictTraversable.Foldable1())},function(){return functorVecTree(dictTraversable.Functor0())},function(dictApplicative){return Data_Traversable.sequenceDefault(traversableVecTree(dictTraversable))(dictApplicative)},function(dictApplicative){return function(f){return function(v){return Control_Apply.apply(dictApplicative.Apply0())(Data_Functor.map((dictApplicative.Apply0()).Functor0())(Node.create)(f(v.value0)))(Data_Traversable.traverse(dictTraversable)(dictApplicative)(Data_Traversable.traverse(traversableVecTree(dictTraversable))(dictApplicative)(f))(v.value1))}}})},filterIntMap=Data_Function_Uncurried.runFn2($foreign["_filterIntMap"]),stepper=function(dictOrd){return function(dictShow){return function(expand){return function(syms){return function(cs){var uniqueGroups=Data_Set.fromFoldable(Data_Map_Internal.foldableMap)(Data_Set_NonEmpty.ordNonEmptySet(Data_Ord.ordInt))(cs),prebake=(function(){var $235=Data_Bifunctor.bimap(Data_Tuple.bifunctorTuple)(unionsIntMap(Data_List_Lazy_Types.foldableList)(Data_Monoid_Additive.semigroupAdditive(Data_Semiring.semiringInt)))(unionsIntMap(Data_List_Lazy_Types.foldableList)(Data_Monoid_Additive.semigroupAdditive(Data_Semiring.semiringInt))),$236=Data_Foldable.foldr(Data_Set_NonEmpty.foldableNonEmptySet)(function(pIx){return function(v){var pNeighbs=syms(pIx),there$prime=Data_List_Lazy_Types.cons(singletonIntMap(pIx)(2))(Data_List_Lazy_Types.cons(pNeighbs)(v.value1)),here$prime=Data_List_Lazy_Types.cons(singletonIntMap(pIx)(1))(Data_List_Lazy_Types.cons(pNeighbs)(v.value0));return new Data_Tuple.Tuple(here$prime,there$prime)}})(new Data_Tuple.Tuple(Data_Monoid.mempty(Data_List_Lazy_Types.monoidList),Data_Monoid.mempty(Data_List_Lazy_Types.monoidList)));return function($237){return $235($236($237))}})(),prebaked=Data_Map_Internal.fromFoldable(Data_Set_NonEmpty.ordNonEmptySet(Data_Ord.ordInt))(Data_List_Lazy_Types.foldableList)(Data_Functor.map(Data_List_Lazy_Types.functorList)(function(gr){return new Data_Tuple.Tuple(gr,prebake(gr))})(Data_List_Lazy.fromFoldable(Data_Set.foldableSet)(uniqueGroups)));return Data_Map_Internal.mapMaybe(dictOrd)((function(){var $238=Data_Set_NonEmpty.fromFoldable(Data_Foldable.foldableArray)(Data_Ord.ordInt),$239=filterIntMap(validLiveCount),$240=unionsIntMap(Data_List_Lazy_Types.foldableList)(Data_Monoid_Additive.semigroupAdditive(Data_Semiring.semiringInt));return function($241){return $238($foreign.intMapKeys($239($240($241))))}})())(Data_Foldable.foldl(Data_List_Lazy_Types.foldableList)(function(res){return function(v){var v1=Data_Map_Internal.lookup(Data_Set_NonEmpty.ordNonEmptySet(Data_Ord.ordInt))(v.value1)(prebaked);if(v1 instanceof Data_Maybe.Nothing)return res;if(v1 instanceof Data_Maybe.Just)return Data_Function.flip(Data_Map_Internal.unionWith(dictOrd)(Data_Semigroup.append(Data_List_Lazy_Types.semigroupList)))(res)(Data_Map_Internal.fromFoldable(dictOrd)(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.zip(expand(v.value0))(Data_List_Lazy_Types.cons(Data_List_Lazy.singleton(v1.value0.value0))(Data_List_Lazy.repeat(Data_List_Lazy.singleton(v1.value0.value1))))));throw new Error("Failed pattern match at Gol (line 202, column 11 - line 205, column 100): "+[v1.constructor.name])}})(Data_Map_Internal.empty)(Data_Map_Internal.toUnfoldableUnordered(Data_List_Lazy_Types.unfoldableList)(cs)))}}}}},elements=["#golDrawer","#gol2D","#gol3D","#golSyms3DForward","#golSyms3DReverse","#gol4D","#golSyms4DForward","#golSyms4DReverse","#golSyms5D","#golTree","#golFlat"],dropAlong=function($copy_xs){return function($copy_ys){var $tco_var_xs=$copy_xs,$tco_done=false,$tco_result;function $tco_loop(xs,ys){var v=Data_List_Lazy_Types.step(xs);if(v instanceof Data_List_Lazy_Types.Nil){$tco_done=true;return ys};if(v instanceof Data_List_Lazy_Types.Cons){var v1=Data_List_Lazy_Types.step(ys);if(v1 instanceof Data_List_Lazy_Types.Nil){$tco_done=true;return Data_List_Lazy_Types.nil};if(v1 instanceof Data_List_Lazy_Types.Cons){$tco_var_xs=v.value1;$copy_ys=v1.value1;return};throw new Error("Failed pattern match at Gol (line 361, column 24 - line 363, column 43): "+[v1.constructor.name])};throw new Error("Failed pattern match at Gol (line 359, column 19 - line 363, column 43): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_xs,$copy_ys);return $tco_result}},drawGolSyms4D=function(sel){return function(maxZ){return Data_Function_Uncurried.runFn4($foreign["_drawGolSyms"])(sel)(maxZ)({dim:2,gridSize:{width:3,height:3},ptPos:function(v){if(v.length===2)return{x:v[0],y:v[1]};return Effect_Exception_Unsafe.unsafeThrow("drawGolSyms4D ptPos")}})}},drawGolSyms3D=function(sel){return function(maxZ){return Data_Function_Uncurried.runFn4($foreign["_drawGolSyms"])(sel)(maxZ)({dim:1,gridSize:{width:3,height:1},ptPos:function(v){if(v.length===1)return{x:v[0],y:0};return Effect_Exception_Unsafe.unsafeThrow("drawGolSyms3D ptPos")}})}},doOnce=function(a){return function __do(){var doneRef=Effect_Ref["new"](false)();return function __do(){var done=Effect_Ref.read(doneRef)();return Control_Applicative.unless(Effect.applicativeEffect)(done)(function __do(){a();return Effect_Ref.write(true)(doneRef)()})()}}},chompPascal=function(q){return function(n){return function(k){return $foreign["_chompPascal"](q,n,k,function(i$prime){return function(q$prime){return function(k$prime){return new Data_Tuple.Tuple(new Data_Tuple.Tuple(i$prime,q$prime),k$prime)}}})}}},genVecRunIxPascal=function(n){return function(mx){return function(x){var go=function(q){return function(m){return function(k){var v=chompPascal(q)(m)(k),$168=m===1;if($168)return Data_List_Lazy_Types.cons(v.value0.value0)(Data_List_Lazy_Types.cons(v.value1)(Data_List_Lazy_Types.nil));return Data_List_Lazy_Types.cons(v.value0.value0)(go(v.value0.value1)(m-1|0)(v.value1))}}};return go(x)(mx)(n)}}},vecRunNeighbsTree=function(n){return function(orig){var mx=maxBinom(n)(orig)+1|0,gens=genVecRunIxPascal(n)(mx)(orig),go=function(v){return new NodeF(v.value1,(function(){if(v.value0 instanceof Data_Maybe.Nothing)return Data_List_Lazy_Types.nil;if(v.value0 instanceof Data_Maybe.Just){var v1=Data_List_Lazy_Types.step(v.value0.value0.ls0);if(v1 instanceof Data_List_Lazy_Types.Nil){var contrib=Data_Lazy.defer(function(v2){var r$prime=Data_Maybe.fromMaybe(0)(v.value0.value0.r),res=r$prime+v.value0.value0.x|0,out$prime=Data_List_Lazy_Types.cons(res)(v.value0.value0.out),mulfact=Data_Lazy.defer(function(v3){return $foreign.factorial(v.value0.value0.x)*$foreign.factorial(r$prime)|0}),multP=Control_Bind.bind(Data_Lazy.bindLazy)(v.value0.value0.p)(function(p_){return Control_Bind.bind(Data_Lazy.bindLazy)(mulfact)(function(m_){var pPow=Data_Int.pow(2)(r$prime),here=Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)($foreign.factorial(res))(m_);return Control_Applicative.pure(Data_Lazy.applicativeLazy)({total:(p_*here|0)*pPow|0,here:"\xd7"+(Data_Show.show(Data_Show.showInt)(here)+("\xd7"+Data_Show.show(Data_Show.showInt)(pPow)))})})}),multQ=Control_Bind.bind(Data_Lazy.bindLazy)(v.value0.value0.q)(function(q_){return Control_Bind.bind(Data_Lazy.bindLazy)(mulfact)(function(m_){var qPow=Data_Int.pow(2)(v.value0.value0.x0-v.value0.value0.x|0);return Control_Applicative.pure(Data_Lazy.applicativeLazy)({total:Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(q_*qPow|0)(m_),here:"\xf7"+(Data_Show.show(Data_Show.showInt)(m_)+("\xd7"+Data_Show.show(Data_Show.showInt)(qPow)))})})}),chosen=Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(out$prime),allSame$prime=v.value0.value0.allSame&&v.value0.value0.x===v.value0.value0.x0;return{chosen:chosen,multP:multP,multQ:multQ,allSame:allSame$prime,leftovers:Data_Array.replicate(mx+1|0)(0),parts:{left:Data_Nullable["null"],here:Data_Nullable.notNull(v.value0.value0.x),right:Data_Nullable.toNullable(v.value0.value0.r)}}});return Data_List_Lazy.singleton(new Data_Tuple.Tuple(Data_Maybe.Nothing.value,contrib))};if(v1 instanceof Data_List_Lazy_Types.Cons)return Control_Bind.bind(Data_List_Lazy_Types.bindList)(safeRange(0)(v.value0.value0.x+v1.value0|0))(function(xlContrib){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(safeRange(Data_Ord.max(Data_Ord.ordInt)(0)(xlContrib-v.value0.value0.x|0))(Data_Ord.min(Data_Ord.ordInt)(v1.value0)(xlContrib)))(function(lContrib){var xContrib=xlContrib-lContrib|0,x$prime=v.value0.value0.x-xContrib|0,r$prime=Data_Maybe.fromMaybe(0)(v.value0.value0.r),res=r$prime+xlContrib|0,out$prime=Data_List_Lazy_Types.cons(res)(v.value0.value0.out),mulfact=Data_Lazy.defer(function(v2){return($foreign.factorial(r$prime)*$foreign.factorial(xContrib)|0)*$foreign.factorial(lContrib)|0}),multP=Control_Bind.bind(Data_Lazy.bindLazy)(v.value0.value0.p)(function(p_){return Control_Bind.bind(Data_Lazy.bindLazy)(mulfact)(function(m_){var here=Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)($foreign.factorial(res))(m_);return Control_Applicative.pure(Data_Lazy.applicativeLazy)({total:p_*here|0,here:"\xd7"+Data_Show.show(Data_Show.showInt)(here)})})}),multQ=Control_Bind.bind(Data_Lazy.bindLazy)(v.value0.value0.q)(function(q_){return Control_Bind.bind(Data_Lazy.bindLazy)(mulfact)(function(m_){return Control_Applicative.pure(Data_Lazy.applicativeLazy)({total:Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(q_)(m_),here:"\xf7"+Data_Show.show(Data_Show.showInt)(m_)})})}),l$prime=v1.value0-lContrib|0,j$prime=v.value0.value0.j-res|0,i$prime=v.value0.value0.i-1|0,allSame$prime=v.value0.value0.allSame&&xContrib===v.value0.value0.x0,contrib=Data_Lazy.defer(function(v2){return{chosen:Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(out$prime),multP:multP,multQ:multQ,allSame:allSame$prime,leftovers:Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.take(mx+1|0)((function(v3){return Data_Semigroup.append(Data_List_Lazy_Types.semigroupList)(v3)(Data_List_Lazy.repeat(0))})(Data_List_Lazy.reverse(Data_List_Lazy_Types.cons(x$prime)(Data_List_Lazy_Types.cons(l$prime)(Data_List_Lazy.drop(2)(dropAlong(v.value0.value0.out)(gens)))))))),parts:{left:Data_Nullable.notNull(lContrib),here:Data_Nullable.notNull(xContrib),right:Data_Nullable.toNullable(v.value0.value0.r)}}});return Control_Applicative.pure(Data_List_Lazy_Types.applicativeList)(new Data_Tuple.Tuple(new Data_Maybe.Just({i:i$prime,j:j$prime,out:out$prime,x0:v1.value0,allSame:allSame$prime,p:Data_Functor.map(Data_Lazy.functorLazy)(function(v2){return v2.total})(multP),q:Data_Functor.map(Data_Lazy.functorLazy)(function(v2){return v2.total})(multQ),r:new Data_Maybe.Just(x$prime),x:l$prime,ls0:v1.value1}),contrib))})});throw new Error("Failed pattern match at Gol (line 394, column 48 - line 477, column 26): "+[v1.constructor.name])};throw new Error("Failed pattern match at Gol (line 392, column 53 - line 477, column 26): "+[v.value0.constructor.name])})())},initQ=Data_Lazy.defer(function(v){return Data_Foldable.product(Data_List_Lazy_Types.foldableList)(Data_Semiring.semiringInt)(Data_Functor.map(Data_List_Lazy_Types.functorList)($foreign.factorial)(gens))}),v=Data_List_Lazy_Types.step(gens);if(v instanceof Data_List_Lazy_Types.Nil)return Effect_Exception_Unsafe.unsafeThrow("vecRunNeighbsTree step gens");if(v instanceof Data_List_Lazy_Types.Cons)return Matryoshka_Unfold.ana(vecTreeCorec(Data_List_Lazy_Types.functorList))(go)(new Data_Tuple.Tuple(new Data_Maybe.Just({i:mx,j:n,out:Data_List_Lazy_Types.nil,x0:v.value0,allSame:true,p:Data_Lazy.defer(function(v1){return 1}),q:initQ,r:Data_Maybe.Nothing.value,x:v.value0,ls0:v.value1}),Data_Lazy.defer(function(v1){var leftovers=Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.reverse(gens));return{chosen:[],multP:Data_Lazy.defer(function(v2){return{total:1,here:"=1"}}),multQ:Data_Function.flip(Data_Functor.map(Data_Lazy.functorLazy))(initQ)(function(q){return{total:q,here:"="+Data_Show.show(Data_Show.showInt)(q)}}),leftovers:Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.reverse(gens)),allSame:true,parts:{left:Data_Nullable["null"],here:Data_Nullable["null"],right:Data_Nullable["null"]}}})));throw new Error("Failed pattern match at Gol (line 369, column 28 - line 386, column 14): "+[v.constructor.name])}},buildHierarchy=Data_Function_Uncurried.runFn2($foreign["_buildHierarchy"]),vecTreeHierarchy=function(dictFoldable){return function(xs){return buildHierarchy(xs)(function(v){return Data_Array.fromFoldable(dictFoldable)(v.value1)})}},drawTree=function(sel){var vecRun=function(d){return function(n){var mx=maxBinom(d)(n)+1|0,gens=genVecRunIxPascal(d)(mx)(n);return Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.reverse(gens))}},mkHier=function(d){var $242=vecTreeHierarchy(Data_List_Lazy_Types.foldableList),$243=vecRunNeighbsTree(d);return function($244){return $242($243($244))}};return $foreign["_drawTree"](sel,vecRun,mkHier,function(v){return v.value0})},buildElemMap=function(doc){return function __do(){var baseLoc=Control_Bind.bindFlipped(Effect.bindEffect)(Web_HTML_Location.href)(Control_Bind.bindFlipped(Effect.bindEffect)(Web_HTML_Window.location)(Web_HTML.window))();return Data_Functor.map(Effect.functorEffect)(Data_Array.catMaybes)(Data_Traversable["for"](Effect.applicativeEffect)(Data_Traversable.traversableArray)(elements)(function(e){return Control_Monad_Maybe_Trans.runMaybeT(Control_Bind.bind(Control_Monad_Maybe_Trans.bindMaybeT(Effect.monadEffect))(Control_Monad_Maybe_Trans.MaybeT(Web_DOM_ParentNode.querySelector(Web_DOM_ParentNode.QuerySelector(e+" p"))(Web_DOM_Document.toParentNode(doc))))(function(telem){return Control_Bind.bind(Control_Monad_Maybe_Trans.bindMaybeT(Effect.monadEffect))(Effect_Class.liftEffect(Control_Monad_Maybe_Trans.monadEffectMaybe(Effect_Class.monadEffectEffect))(Data_Functor.map(Effect.functorEffect)((function(){var $245=Data_String_CodePoints.drop(1),$246=Data_String_CodePoints.dropWhile(function(v){return Data_Eq.notEq(Data_String_CodePoints.eqCodePoint)(v)(Data_String_CodePoints.codePointFromChar(":"))});return function($247){return $245($246($247))}})())(Web_DOM_Node.textContent(Web_DOM_Element.toNode(telem)))))(function(ttext){return Control_Bind.bind(Control_Monad_Maybe_Trans.bindMaybeT(Effect.monadEffect))(Data_Functor.map(Control_Monad_Maybe_Trans.functorMaybeT(Effect.functorEffect))(Web_DOM_Element.toNode)(Control_Monad_Maybe_Trans.MaybeT(Web_DOM_ParentNode.querySelector(Web_DOM_ParentNode.QuerySelector(e+" p strong"))(Web_DOM_Element.toParentNode(telem)))))(function(bnode){return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Maybe_Trans.bindMaybeT(Effect.monadEffect))(Effect_Class.liftEffect(Control_Monad_Maybe_Trans.monadEffectMaybe(Effect_Class.monadEffectEffect))(Data_Functor["void"](Effect.functorEffect)(function __do(){var anchor=Web_DOM_Document.createElement("a")(doc)();Web_DOM_Element.setAttribute("href")(baseLoc+e)(anchor)();Web_DOM_Node.setTextContent("#")(Web_DOM_Element.toNode(anchor))();return Web_DOM_Node.insertBefore(Web_DOM_Element.toNode(anchor))(bnode)(Web_DOM_Element.toNode(telem))()})))(function(){return Control_Applicative.pure(Control_Monad_Maybe_Trans.applicativeMaybeT(Effect.monadEffect))(new Data_Tuple.Tuple(e,ttext))})})})}))}))()}},blockTable=["_","\u2598","\u259d","\u2580","\u2596","\u258c","\u259e","\u259b","\u2597","\u259a","\u2590","\u259c","\u2584","\u2599","\u259f","\u2588"],blockToFourBit=function(c){return Data_Function.flip(Data_Functor.map(Data_Maybe.functorMaybe))(Data_Array.elemIndex(Data_Eq.eqChar)(c)(blockTable))(function(n){return{nw:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(n)(2)===1,ne:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(n)(2))(2)===1,sw:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(n)(4))(2)===1,se:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(n)(8))(2)===1}})},blocksToPoint=function(str){return Data_Set.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_Ord.ordRecord()(Data_Ord.ordRecordCons(Data_Ord.ordRecordCons(Data_Ord.ordRecordNil)()(new Data_Symbol.IsSymbol(function(){return"y"}))(Data_Ord.ordInt))()(new Data_Symbol.IsSymbol(function(){return"x"}))(Data_Ord.ordInt)))(Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy.zip(Data_List_Lazy.range(0)(3))(Data_List_Lazy.fromFoldable(Data_Foldable.foldableArray)(Data_String_Common.split("|")(str))))(function(v){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy.zip(Data_List_Lazy.range(0)(3))(Data_List_Lazy.fromFoldable(Data_Foldable.foldableArray)(Data_String_CodeUnits.toCharArray(v.value1))))(function(v1){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_Maybe.maybe(Data_List_Lazy_Types.nil)(Data_List_Lazy.singleton)(blockToFourBit(v1.value1)))(function(fb){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(fourBitToPoint2(fb))(function(dp){var y=(2*v.value0|0)+dp.y|0,x=(2*v1.value0|0)+dp.x|0;return Control_Applicative.pure(Data_List_Lazy_Types.applicativeList)({x:x,y:y})})})})}))},loadUri=Control_Monad_Maybe_Trans.runMaybeT(Control_Bind.bind(Control_Monad_Maybe_Trans.bindMaybeT(Effect.monadEffect))(Effect_Class.liftEffect(Control_Monad_Maybe_Trans.monadEffectMaybe(Effect_Class.monadEffectEffect))(Control_Bind.bindFlipped(Effect.bindEffect)(Web_HTML_Location.search)(Control_Bind.bindFlipped(Effect.bindEffect)(Web_HTML_Window.location)(Web_HTML.window))))(function(searchStr){return Control_Bind.bind(Control_Monad_Maybe_Trans.bindMaybeT(Effect.monadEffect))(Effect_Class.liftEffect(Control_Monad_Maybe_Trans.monadEffectMaybe(Effect_Class.monadEffectEffect))(Web_URLSearchParams["new"](searchStr)))(function(usp){return Control_Bind.bind(Control_Monad_Maybe_Trans.bindMaybeT(Effect.monadEffect))(Control_Monad_Maybe_Trans.MaybeT(Web_URLSearchParams.get(usp)("points")))(function(str){return Control_Applicative.pure(Control_Monad_Maybe_Trans.applicativeMaybeT(Effect.monadEffect))(blocksToPoint(str))})})})),fourBitToBlock=function(fb){var go=function(i){return function(b){if(b)return Data_Int.pow(2)(i);if(Data_Boolean.otherwise)return 0;throw new Error("Failed pattern match at Gol (line 741, column 5 - line 743, column 22): "+[i.constructor.name,b.constructor.name])}};return Data_Maybe.fromMaybe(" ")(Data_Array.index(blockTable)(Data_Foldable.sum(Data_List_Lazy_Types.foldableList)(Data_Semiring.semiringInt)(Data_List_Lazy.zipWith(go)(Data_List_Lazy.iterate(function(v){return v+1|0})(0))(fourBitList(fb)))))},pointsToBlocks=function(pts){var ptMap=Data_Map_Internal.fromFoldableWith(Data_Ord.ordRecord()(Data_Ord.ordRecordCons(Data_Ord.ordRecordCons(Data_Ord.ordRecordNil)()(new Data_Symbol.IsSymbol(function(){return"y"}))(Data_Ord.ordInt))()(new Data_Symbol.IsSymbol(function(){return"x"}))(Data_Ord.ordInt)))(Data_Foldable.foldableArray)(Data_Semigroup.append(semigroupFourBit))(Data_Functor.map(Data_Functor.functorArray)(point2ToFourBit)(Data_Array.fromFoldable(Data_Set.foldableSet)(pts)));return Data_Foldable.intercalate(Data_List_Lazy_Types.foldableList)(Data_Monoid.monoidString)("|")(Data_Function.flip(Data_Functor.map(Data_List_Lazy_Types.functorList))(Data_List_Lazy.range(0)(3))(function(y){return Data_Function.flip(Data_Foldable.foldMap(Data_List_Lazy_Types.foldableList)(Data_Monoid.monoidString))(Data_List_Lazy.range(0)(3))(function(x){return Data_Maybe.maybe("_")(function($248){return Data_String_CodeUnits.singleton(fourBitToBlock($248))})(Data_Map_Internal.lookup(Data_Ord.ordRecord()(Data_Ord.ordRecordCons(Data_Ord.ordRecordCons(Data_Ord.ordRecordNil)()(new Data_Symbol.IsSymbol(function(){return"y"}))(Data_Ord.ordInt))()(new Data_Symbol.IsSymbol(function(){return"x"}))(Data_Ord.ordInt)))({x:x,y:y})(ptMap))})}))},setupDrawer=function(sel){return function(size){return Data_Function_Uncurried.runFn4($foreign["_setupDrawer"])(sel)(size)((function(){var $249=Data_Set.fromFoldable(Data_Foldable.foldableArray)(Data_Ord.ordRecord()(Data_Ord.ordRecordCons(Data_Ord.ordRecordCons(Data_Ord.ordRecordNil)()(new Data_Symbol.IsSymbol(function(){return"y"}))(Data_Ord.ordInt))()(new Data_Symbol.IsSymbol(function(){return"x"}))(Data_Ord.ordInt)));return function($250){return pointsToBlocks($249($250))}})())}},binom=Data_Function_Uncurried.runFn2($foreign["_binom"]),vecRunNeighbs=function(n){return function(orig){var mx=maxBinom(n)(orig)+1|0,go=function(i){return function(j){return function(tot){return function(x0){return function(allSame){return function(p){return function(r){return function(x){return function(ls0){var v=Data_List_Lazy_Types.step(ls0);if(v instanceof Data_List_Lazy_Types.Nil){var res=r+x|0,p$prime=p*Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)($foreign.factorial(res)*Data_Int.pow(2)(r)|0)($foreign.factorial(x)*$foreign.factorial(r)|0)|0;return Data_Functor.voidRight(Data_List_Lazy_Types.functorList)(new Data_Tuple.Tuple(tot,p$prime))(Control_MonadZero.guard(Data_List_Lazy_Types.monadZeroList)(!(allSame&&x===x0)))};if(v instanceof Data_List_Lazy_Types.Cons)return Control_Bind.bind(Data_List_Lazy_Types.bindList)(safeRange(0)(x+v.value0|0))(function(xlContrib){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(safeRange(Data_Ord.max(Data_Ord.ordInt)(0)(xlContrib-x|0))(Data_Ord.min(Data_Ord.ordInt)(v.value0)(xlContrib)))(function(lContrib){var xContrib=xlContrib-lContrib|0,x$prime=x-xContrib|0,res=r+xlContrib|0,tot$prime=tot+Data_Foldable.sum(Data_List_Lazy_Types.foldableList)(Data_Semiring.semiringInt)(Data_Functor.map(Data_List_Lazy_Types.functorList)(function(k){return binom((i+j|0)-k|0)(i-1|0)})(safeRange(1)(res)))|0,p$prime=p*Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)($foreign.factorial(res))(($foreign.factorial(r)*$foreign.factorial(xContrib)|0)*$foreign.factorial(lContrib)|0)|0,l$prime=v.value0-lContrib|0,j$prime=j-res|0,i$prime=i-1|0;return go(i$prime)(j$prime)(tot$prime)(v.value0)(allSame&&xContrib===x0)(p$prime)(x$prime)(l$prime)(v.value1)})});throw new Error("Failed pattern match at Gol (line 285, column 39 - line 306, column 64): "+[v.constructor.name])}}}}}}}}},gens=genVecRunIxPascal(n)(mx)(orig),v=Data_List_Lazy_Types.step(gens);if(v instanceof Data_List_Lazy_Types.Nil)return Data_List_Lazy_Types.nil;if(v instanceof Data_List_Lazy_Types.Cons)return go(mx)(n)(0)(v.value0)(true)(1)(0)(v.value0)(v.value1);throw new Error("Failed pattern match at Gol (line 269, column 24 - line 271, column 48): "+[v.constructor.name])}},drawGolSyms5D=function(sel){return $foreign["_drawGolSyms5D"](sel,(function(){var $251=toIntMap(Data_List_Lazy_Types.foldableList)(Data_Monoid_Additive.semigroupAdditive(Data_Semiring.semiringInt)),$252=Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Tuple.functorTuple)(Data_Monoid_Additive.Additive)),$253=vecRunNeighbs(3);return function($254){return $251($252($253($254)))}})())},runner=function(d){var highNeighbs=$foreign.memoInt((function(){var $255=toIntMap(Data_List_Lazy_Types.foldableList)(Data_Monoid_Additive.semigroupAdditive(Data_Semiring.semiringInt)),$256=Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Tuple.functorTuple)(function(w){return w*2|0})),$257=vecRunNeighbs(d);return function($258){return $255($256($257($258)))}})()),$259=Data_List_Lazy.iterate(function(v){return Control_Bind.bindFlipped(Data_Lazy.bindLazy)((function(){var $265=Control_Applicative.pure(Data_Lazy.applicativeLazy),$266=stepper(Data_Ord.ordRecord()(Data_Ord.ordRecordCons(Data_Ord.ordRecordCons(Data_Ord.ordRecordNil)()(new Data_Symbol.IsSymbol(function(){return"y"}))(Data_Ord.ordInt))()(new Data_Symbol.IsSymbol(function(){return"x"}))(Data_Ord.ordInt)))(Data_Show.showRecord()(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function(){return"x"}))(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function(){return"y"}))(Data_Show.showRecordFieldsNil)(Data_Show.showInt))(Data_Show.showInt)))(lowNeighbs)(highNeighbs);return function($267){return $265($266($267))}})())(v)}),$260=Control_Applicative.pure(Data_Lazy.applicativeLazy),$261=Data_Map_Internal.fromFoldable(Data_Ord.ordRecord()(Data_Ord.ordRecordCons(Data_Ord.ordRecordCons(Data_Ord.ordRecordNil)()(new Data_Symbol.IsSymbol(function(){return"y"}))(Data_Ord.ordInt))()(new Data_Symbol.IsSymbol(function(){return"x"}))(Data_Ord.ordInt)))(Data_List_Lazy_Types.foldableList),$262=Data_Functor.map(Data_List_Lazy_Types.functorList)(function(x){return new Data_Tuple.Tuple(x,Data_Set_NonEmpty.singleton(0))}),$263=Data_List_Lazy.fromFoldable(Data_Set.foldableSet);return function($264){return $259($260($261($262($263($264)))))}},setupGol3D=function(sel){return function(size){var drawer=(function(){var $268=Data_Functor.map(Data_Functor.functorArray)(function(v){return{x:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.x)(size.width),y:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.y)(size.height),zs:Data_Array.fromFoldable(Data_Set_NonEmpty.foldableNonEmptySet)(v.value1)}}),$269=Data_Map_Internal.toUnfoldableUnordered(Data_Unfoldable.unfoldableArray);return function($270){return $268($269($270))}})(),preRun=(function(){var $271=Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList),$272=Data_List_Lazy.take(size.maxT+1|0),$273=Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Lazy.functorLazy)(drawer)),$274=runner(1);return function($275){return $271($272($273($274($275))))}})();return Data_Functor.map(Effect.functorEffect)(function(v){return function($276){return v(preRun($276))}})($foreign["_setupGol3D"](sel,size))}},setupGol4D=function(sel){return function(size){var drawer=(function(){var $277=Data_Functor.map(Data_Functor.functorArray)(function(v){return{x:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.x)(size.width),y:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.y)(size.height),zws:Data_Array.fromFoldable(Data_Set_NonEmpty.foldableNonEmptySet)(v.value1)}}),$278=Data_Map_Internal.toUnfoldableUnordered(Data_Unfoldable.unfoldableArray);return function($279){return $277($278($279))}})(),preRun=(function(){var $280=Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList),$281=Data_List_Lazy.take(size.maxT+1|0),$282=Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Lazy.functorLazy)(drawer)),$283=runner(2);return function($284){return $280($281($282($283($284))))}})();return Data_Functor.map(Effect.functorEffect)(function(v){return function($285){return v(preRun($285))}})($foreign["_setupGol4D"](sel,size))}},setupGolFlat=function(sel){return function(size){var size$prime={height:size.height,width:size.width,maxT:size.maxT,maxDim:Data_Nullable.toNullable(size.maxDim)},drawer=(function(){var $286=Data_Functor.map(Data_Functor.functorArray)(function(v){return{x:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.x)(size.width),y:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.y)(size.height),pts:Data_Array.fromFoldable(Data_Set_NonEmpty.foldableNonEmptySet)(v.value1)}}),$287=Data_Map_Internal.toUnfoldableUnordered(Data_Unfoldable.unfoldableArray);return function($288){return $286($287($288))}})(),preRun=function(pts){if(size.maxDim instanceof Data_Maybe.Nothing)return Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_Functor.map(Data_List_Lazy_Types.functorList)((function(){var $289=Data_Functor.map(Data_Lazy.functorLazy)(drawer);return function($290){return Data_Array.singleton($289($290))}})())(Data_List_Lazy.take(size.maxT+1|0)(runner(0)(pts))));if(size.maxDim instanceof Data_Maybe.Just)return Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList))(Data_List_Lazy.transpose(Data_Function.flip(Data_Functor.map(Data_List_Lazy_Types.functorList))(Data_List_Lazy.range(0)(size.maxDim.value0))(function(d){return Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Lazy.functorLazy)(drawer))(Data_List_Lazy.take(size.maxT+1|0)(runner(d)(pts)))}))));throw new Error("Failed pattern match at Gol (line 550, column 18 - line 554, column 72): "+[size.maxDim.constructor.name])};return Data_Functor.map(Effect.functorEffect)(function(v){return function($291){return v(preRun($291))}})($foreign["_setupGolFlat"](sel,Data_Maybe.isJust(size.maxDim),size$prime))}},main=(function(){var ready=function(doc){return function(a){return function __do(){var a$prime=doOnce(a)();return onE(Web_HTML_Event_EventTypes.readystatechange)(Web_DOM_Document.toEventTarget(doc))(function(v){return a$prime})()}}},bump=function(n){return function(v){return{x:v.x+n|0,y:v.y+n|0}}},initialSet=Data_Set.fromFoldable(Data_Foldable.foldableArray)(Data_Ord.ordRecord()(Data_Ord.ordRecordCons(Data_Ord.ordRecordCons(Data_Ord.ordRecordNil)()(new Data_Symbol.IsSymbol(function(){return"y"}))(Data_Ord.ordInt))()(new Data_Symbol.IsSymbol(function(){return"x"}))(Data_Ord.ordInt)))(Data_Functor.map(Data_Functor.functorArray)(bump(2))(initialPoints));return function __do(){var doc=Control_Bind.bindFlipped(Effect.bindEffect)((function(){var $292=Data_Functor.map(Effect.functorEffect)(Web_HTML_HTMLDocument.toDocument);return function($293){return $292(Web_HTML_Window.document($293))}})())(Web_HTML.window)();return ready(doc)(function __do(){$foreign.logMe(21)();var startingPts=Data_Functor.map(Effect.functorEffect)(Data_Maybe.fromMaybe(initialSet))(loadUri)(),eMap=buildElemMap(doc)();makeElemLinks(doc)(eMap)();var draw2D=setupGolFlat("#gol2DCont")({height:20,width:20,maxT:6,maxDim:Data_Maybe.Nothing.value})(),draw3D=setupGol3D("#gol3DCont")({height:20,width:20,maxT:6})(),draw4D=setupGol4D("#gol4DCont")({height:20,width:20,maxT:6})(),drawFlat=setupGolFlat("#golFlatCont")({height:20,width:20,maxT:6,maxDim:new Data_Maybe.Just(8)})();drawGolSyms3D("#golSyms3DForwardCont")(6)(false)();drawGolSyms3D("#golSyms3DReverseCont")(6)(true)();drawGolSyms4D("#golSyms4DForwardCont")(6)(false)();drawGolSyms4D("#golSyms4DReverseCont")(6)(true)();drawTree("#golTreeCont")();drawGolSyms5D("#golSyms5DCont")();var drawer=setupDrawer("#golDrawerCont")({height:8,width:8})(function(pts){var bumped=Data_Set.fromFoldable(Data_Foldable.foldableArray)(Data_Ord.ordRecord()(Data_Ord.ordRecordCons(Data_Ord.ordRecordCons(Data_Ord.ordRecordNil)()(new Data_Symbol.IsSymbol(function(){return"y"}))(Data_Ord.ordInt))()(new Data_Symbol.IsSymbol(function(){return"x"}))(Data_Ord.ordInt)))(Data_Functor.map(Data_Functor.functorArray)(bump(6))(pts));return function __do(){draw2D(bumped)();draw3D(bumped)();draw4D(bumped)();return drawFlat(bumped)()}})();return drawer(Data_Array.fromFoldable(Data_Set.foldableSet)(startingPts))()})()}})(),assignWindow=Data_Function_Uncurried.runFn2($foreign["_assignWindow"]);exports["main"]=main;exports["elements"]=elements;exports["buildElemMap"]=buildElemMap;exports["makeElemLinks"]=makeElemLinks;exports["loadUri"]=loadUri;exports["initialPoints"]=initialPoints;exports["validLiveCount"]=validLiveCount;exports["neighbs2d"]=neighbs2d;exports["stepper"]=stepper;exports["runner"]=runner;exports["lowNeighbs"]=lowNeighbs;exports["neighbsSet"]=neighbsSet;exports["genVecRunIxPascal"]=genVecRunIxPascal;exports["vecRunNeighbs"]=vecRunNeighbs;exports["safeRange"]=safeRange;exports["Node"]=Node;exports["NodeF"]=NodeF;exports["dropAlong"]=dropAlong;exports["vecRunNeighbsTree"]=vecRunNeighbsTree;exports["vecTreeHierarchy"]=vecTreeHierarchy;exports["toIntMap"]=toIntMap;exports["unionsIntMap"]=unionsIntMap;exports["filterIntMap"]=filterIntMap;exports["singletonIntMap"]=singletonIntMap;exports["buildHierarchy"]=buildHierarchy;exports["setupDrawer"]=setupDrawer;exports["setupGolFlat"]=setupGolFlat;exports["setupGol3D"]=setupGol3D;exports["setupGol4D"]=setupGol4D;exports["drawGolSyms3D"]=drawGolSyms3D;exports["drawGolSyms4D"]=drawGolSyms4D;exports["drawGolSyms5D"]=drawGolSyms5D;exports["drawTree"]=drawTree;exports["binom"]=binom;exports["maxBinom"]=maxBinom;exports["ixPascal"]=ixPascal;exports["chompPascal"]=chompPascal;exports["onE"]=onE;exports["doOnce"]=doOnce;exports["assignWindow"]=assignWindow;exports["setInnerHTML"]=setInnerHTML;exports["blockTable"]=blockTable;exports["FourBit"]=FourBit;exports["fourBitList"]=fourBitList;exports["fourBitToBlock"]=fourBitToBlock;exports["blockToFourBit"]=blockToFourBit;exports["point2ToFourBit"]=point2ToFourBit;exports["fourBitToPoint2"]=fourBitToPoint2;exports["pointsToBlocks"]=pointsToBlocks;exports["blocksToPoint"]=blocksToPoint;exports["functorVecTree"]=functorVecTree;exports["functorVecTreeF"]=functorVecTreeF;exports["vecTreeCorec"]=vecTreeCorec;exports["vecTreeRec"]=vecTreeRec;exports["showVecTree"]=showVecTree;exports["foldableVecTree"]=foldableVecTree;exports["traversableVecTree"]=traversableVecTree;exports["showFourBit"]=showFourBit;exports["semigroupFourBit"]=semigroupFourBit;exports["monoidFourBit"]=monoidFourBit;exports["_toIntMap"]=$foreign["_toIntMap"];exports["_unionsIntMap"]=$foreign["_unionsIntMap"];exports["_filterIntMap"]=$foreign["_filterIntMap"];exports["intMapKeys"]=$foreign.intMapKeys;exports["_singletonIntMap"]=$foreign["_singletonIntMap"];exports["_buildHierarchy"]=$foreign["_buildHierarchy"];exports["logMe"]=$foreign.logMe;exports["trace"]=$foreign.trace;exports["_setupDrawer"]=$foreign["_setupDrawer"];exports["_setupGolFlat"]=$foreign["_setupGolFlat"];exports["_setupGol3D"]=$foreign["_setupGol3D"];exports["_setupGol4D"]=$foreign["_setupGol4D"];exports["_drawGolSyms"]=$foreign["_drawGolSyms"];exports["_drawGolSyms5D"]=$foreign["_drawGolSyms5D"];exports["_drawTree"]=$foreign["_drawTree"];exports["_binom"]=$foreign["_binom"];exports["_maxBinom"]=$foreign["_maxBinom"];exports["_ixPascal"]=$foreign["_ixPascal"];exports["pascalIx"]=$foreign.pascalIx;exports["_chompPascal"]=$foreign["_chompPascal"];exports["factorial"]=$foreign.factorial;exports["memoInt"]=$foreign.memoInt;exports["undefined"]=$foreign["undefined"];exports["_assignWindow"]=$foreign["_assignWindow"];exports["_setInnerHTML"]=$foreign["_setInnerHTML"]})(PS);PS["Gol"].main()