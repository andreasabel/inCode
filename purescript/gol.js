var PS={};(function($PS){"use strict";$PS["Control.Alt"]=$PS["Control.Alt"]||{};var exports=$PS["Control.Alt"],Alt=function(Functor0,alt){this.Functor0=Functor0;this.alt=alt};exports["Alt"]=Alt})(PS);(function($PS){"use strict";$PS["Control.Alternative"]=$PS["Control.Alternative"]||{};var exports=$PS["Control.Alternative"],Alternative=function(Applicative0,Plus1){this.Applicative0=Applicative0;this.Plus1=Plus1};exports["Alternative"]=Alternative})(PS);(function($PS){"use strict";$PS["Control.Semigroupoid"]=$PS["Control.Semigroupoid"]||{};var exports=$PS["Control.Semigroupoid"],Semigroupoid=function(compose){this.compose=compose},semigroupoidFn=new Semigroupoid(function(f){return function(g){return function(x){return f(g(x))}}}),compose=function(dict){return dict.compose};exports["compose"]=compose;exports["semigroupoidFn"]=semigroupoidFn})(PS);(function($PS){"use strict";$PS["Control.Category"]=$PS["Control.Category"]||{};var exports=$PS["Control.Category"],Control_Semigroupoid=$PS["Control.Semigroupoid"],Category=function(Semigroupoid0,identity){this.Semigroupoid0=Semigroupoid0;this.identity=identity},identity=function(dict){return dict.identity},categoryFn=new Category(function(){return Control_Semigroupoid.semigroupoidFn},function(x){return x});exports["identity"]=identity;exports["categoryFn"]=categoryFn})(PS);(function($PS){"use strict";$PS["Data.Function"]=$PS["Data.Function"]||{};var exports=$PS["Data.Function"],flip=function(f){return function(b){return function(a){return f(a)(b)}}},$$const=function(a){return function(v){return a}};exports["flip"]=flip;exports["const"]=$$const})(PS);(function(exports){"use strict";exports.arrayMap=function(f){return function(arr){var l=arr.length,result=new Array(l);for(var i=0;i<l;i++)result[i]=f(arr[i]);return result}}})(PS["Data.Functor"]=PS["Data.Functor"]||{});(function($PS){"use strict";$PS["Data.Functor"]=$PS["Data.Functor"]||{};var exports=$PS["Data.Functor"],$foreign=$PS["Data.Functor"],Data_Function=$PS["Data.Function"],Functor=function(map){this.map=map},map=function(dict){return dict.map},voidRight=function(dictFunctor){return function(x){return map(dictFunctor)(Data_Function["const"](x))}},functorArray=new Functor($foreign.arrayMap);exports["Functor"]=Functor;exports["map"]=map;exports["voidRight"]=voidRight;exports["functorArray"]=functorArray})(PS);(function($PS){"use strict";$PS["Control.Apply"]=$PS["Control.Apply"]||{};var exports=$PS["Control.Apply"],Control_Category=$PS["Control.Category"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Apply=function(Functor0,apply){this.Functor0=Functor0;this.apply=apply},apply=function(dict){return dict.apply},applySecond=function(dictApply){return function(a){return function(b){return apply(dictApply)(Data_Functor.map(dictApply.Functor0())(Data_Function["const"](Control_Category.identity(Control_Category.categoryFn)))(a))(b)}}};exports["Apply"]=Apply;exports["apply"]=apply;exports["applySecond"]=applySecond})(PS);(function(exports){"use strict";exports.unit={}})(PS["Data.Unit"]=PS["Data.Unit"]||{});(function($PS){"use strict";$PS["Data.Unit"]=$PS["Data.Unit"]||{};var exports=$PS["Data.Unit"],$foreign=$PS["Data.Unit"];exports["unit"]=$foreign.unit})(PS);(function($PS){"use strict";$PS["Control.Applicative"]=$PS["Control.Applicative"]||{};var exports=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Data_Unit=$PS["Data.Unit"],Applicative=function(Apply0,pure){this.Apply0=Apply0;this.pure=pure},pure=function(dict){return dict.pure},unless=function(dictApplicative){return function(v){return function(v1){if(!v)return v1;if(v)return pure(dictApplicative)(Data_Unit.unit);throw new Error("Failed pattern match at Control.Applicative (line 62, column 1 - line 62, column 65): "+[v.constructor.name,v1.constructor.name])}}},when=function(dictApplicative){return function(v){return function(v1){if(v)return v1;if(!v)return pure(dictApplicative)(Data_Unit.unit);throw new Error("Failed pattern match at Control.Applicative (line 57, column 1 - line 57, column 63): "+[v.constructor.name,v1.constructor.name])}}},liftA1=function(dictApplicative){return function(f){return function(a){return Control_Apply.apply(dictApplicative.Apply0())(pure(dictApplicative)(f))(a)}}};exports["Applicative"]=Applicative;exports["pure"]=pure;exports["liftA1"]=liftA1;exports["unless"]=unless;exports["when"]=when})(PS);(function($PS){"use strict";$PS["Control.Bind"]=$PS["Control.Bind"]||{};var exports=$PS["Control.Bind"],Data_Function=$PS["Data.Function"],Discard=function(discard){this.discard=discard},Bind=function(Apply0,bind){this.Apply0=Apply0;this.bind=bind},discard=function(dict){return dict.discard},bind=function(dict){return dict.bind},bindFlipped=function(dictBind){return Data_Function.flip(bind(dictBind))},discardUnit=new Discard(function(dictBind){return bind(dictBind)});exports["Bind"]=Bind;exports["bind"]=bind;exports["bindFlipped"]=bindFlipped;exports["discard"]=discard;exports["discardUnit"]=discardUnit})(PS);(function($PS){"use strict";$PS["Control.Lazy"]=$PS["Control.Lazy"]||{};var exports=$PS["Control.Lazy"],Lazy=function(defer){this.defer=defer},defer=function(dict){return dict.defer},fix=function(dictLazy){return function(f){var go=defer(dictLazy)(function(v){return f(go)});return go}};exports["defer"]=defer;exports["Lazy"]=Lazy;exports["fix"]=fix})(PS);(function($PS){"use strict";$PS["Control.Monad"]=$PS["Control.Monad"]||{};var exports=$PS["Control.Monad"],Control_Applicative=$PS["Control.Applicative"],Control_Bind=$PS["Control.Bind"],Monad=function(Applicative0,Bind1){this.Applicative0=Applicative0;this.Bind1=Bind1},ap=function(dictMonad){return function(f){return function(a){return Control_Bind.bind(dictMonad.Bind1())(f)(function(f$prime){return Control_Bind.bind(dictMonad.Bind1())(a)(function(a$prime){return Control_Applicative.pure(dictMonad.Applicative0())(f$prime(a$prime))})})}}};exports["Monad"]=Monad;exports["ap"]=ap})(PS);(function($PS){"use strict";$PS["Control.Plus"]=$PS["Control.Plus"]||{};var exports=$PS["Control.Plus"],Plus=function(Alt0,empty){this.Alt0=Alt0;this.empty=empty},empty=function(dict){return dict.empty};exports["Plus"]=Plus;exports["empty"]=empty})(PS);(function($PS){"use strict";$PS["Control.MonadZero"]=$PS["Control.MonadZero"]||{};var exports=$PS["Control.MonadZero"],Control_Applicative=$PS["Control.Applicative"],Control_Plus=$PS["Control.Plus"],Data_Unit=$PS["Data.Unit"],MonadZero=function(Alternative1,Monad0){this.Alternative1=Alternative1;this.Monad0=Monad0},guard=function(dictMonadZero){return function(v){if(v)return Control_Applicative.pure((dictMonadZero.Alternative1()).Applicative0())(Data_Unit.unit);if(!v)return Control_Plus.empty((dictMonadZero.Alternative1()).Plus1());throw new Error("Failed pattern match at Control.MonadZero (line 54, column 1 - line 54, column 52): "+[v.constructor.name])}};exports["MonadZero"]=MonadZero;exports["guard"]=guard})(PS);(function(exports){"use strict";var replicateFill=function(count){return function(value){if(count<1)return[];var result=new Array(count);return result.fill(value)}},replicatePolyfill=function(count){return function(value){var result=[],n=0;for(var i=0;i<count;i++)result[n++]=value;return result}};exports.replicate=typeof Array.prototype.fill==="function"?replicateFill:replicatePolyfill;exports.fromFoldableImpl=(function(){function Cons(head,tail){this.head=head;this.tail=tail};var emptyList={};function curryCons(head){return function(tail){return new Cons(head,tail)}}
function listToArray(list){var result=[],count=0,xs=list;while(xs!==emptyList){result[count++]=xs.head;xs=xs.tail};return result};return function(foldr){return function(xs){return listToArray(foldr(curryCons)(emptyList)(xs))}}})();exports.indexImpl=function(just){return function(nothing){return function(xs){return function(i){return i<0||i>=xs.length?nothing:just(xs[i])}}}}})(PS["Data.Array"]=PS["Data.Array"]||{});(function(exports){"use strict";exports.foldrArray=function(f){return function(init){return function(xs){var acc=init,len=xs.length;for(var i=len-1;i>=0;i--)acc=f(xs[i])(acc);return acc}}};exports.foldlArray=function(f){return function(init){return function(xs){var acc=init,len=xs.length;for(var i=0;i<len;i++)acc=f(acc)(xs[i]);return acc}}}})(PS["Data.Foldable"]=PS["Data.Foldable"]||{});(function(exports){"use strict";exports.concatString=function(s1){return function(s2){return s1+s2}}})(PS["Data.Semigroup"]=PS["Data.Semigroup"]||{});(function($PS){"use strict";$PS["Data.Semigroup"]=$PS["Data.Semigroup"]||{};var exports=$PS["Data.Semigroup"],$foreign=$PS["Data.Semigroup"],Semigroup=function(append){this.append=append},semigroupString=new Semigroup($foreign.concatString),append=function(dict){return dict.append};exports["Semigroup"]=Semigroup;exports["append"]=append;exports["semigroupString"]=semigroupString})(PS);(function($PS){"use strict";$PS["Data.Monoid"]=$PS["Data.Monoid"]||{};var exports=$PS["Data.Monoid"],Data_Semigroup=$PS["Data.Semigroup"],Monoid=function(Semigroup0,mempty){this.Semigroup0=Semigroup0;this.mempty=mempty},monoidString=new Monoid(function(){return Data_Semigroup.semigroupString},""),mempty=function(dict){return dict.mempty};exports["Monoid"]=Monoid;exports["mempty"]=mempty;exports["monoidString"]=monoidString})(PS);(function($PS){"use strict";$PS["Data.Monoid.Dual"]=$PS["Data.Monoid.Dual"]||{};var exports=$PS["Data.Monoid.Dual"],Data_Monoid=$PS["Data.Monoid"],Data_Semigroup=$PS["Data.Semigroup"],Dual=function(x){return x},semigroupDual=function(dictSemigroup){return new Data_Semigroup.Semigroup(function(v){return function(v1){return Data_Semigroup.append(dictSemigroup)(v1)(v)}})},monoidDual=function(dictMonoid){return new Data_Monoid.Monoid(function(){return semigroupDual(dictMonoid.Semigroup0())},Data_Monoid.mempty(dictMonoid))};exports["Dual"]=Dual;exports["monoidDual"]=monoidDual})(PS);(function($PS){"use strict";$PS["Data.Monoid.Endo"]=$PS["Data.Monoid.Endo"]||{};var exports=$PS["Data.Monoid.Endo"],Control_Category=$PS["Control.Category"],Control_Semigroupoid=$PS["Control.Semigroupoid"],Data_Monoid=$PS["Data.Monoid"],Data_Semigroup=$PS["Data.Semigroup"],Endo=function(x){return x},semigroupEndo=function(dictSemigroupoid){return new Data_Semigroup.Semigroup(function(v){return function(v1){return Control_Semigroupoid.compose(dictSemigroupoid)(v)(v1)}})},monoidEndo=function(dictCategory){return new Data_Monoid.Monoid(function(){return semigroupEndo(dictCategory.Semigroupoid0())},Control_Category.identity(dictCategory))};exports["Endo"]=Endo;exports["monoidEndo"]=monoidEndo})(PS);(function($PS){"use strict";$PS["Data.Newtype"]=$PS["Data.Newtype"]||{};var exports=$PS["Data.Newtype"],Data_Monoid_Dual=$PS["Data.Monoid.Dual"],Data_Monoid_Endo=$PS["Data.Monoid.Endo"],Newtype=function(unwrap,wrap){this.unwrap=unwrap;this.wrap=wrap},unwrap=function(dict){return dict.unwrap},newtypeEndo=new Newtype(function(v){return v},Data_Monoid_Endo.Endo),newtypeDual=new Newtype(function(v){return v},Data_Monoid_Dual.Dual);exports["unwrap"]=unwrap;exports["Newtype"]=Newtype;exports["newtypeDual"]=newtypeDual;exports["newtypeEndo"]=newtypeEndo})(PS);(function(exports){"use strict";exports.intAdd=function(x){return function(y){return x+y|0}};exports.intMul=function(x){return function(y){return x*y|0}}})(PS["Data.Semiring"]=PS["Data.Semiring"]||{});(function($PS){"use strict";$PS["Data.Semiring"]=$PS["Data.Semiring"]||{};var exports=$PS["Data.Semiring"],$foreign=$PS["Data.Semiring"],Semiring=function(add,mul,one,zero){this.add=add;this.mul=mul;this.one=one;this.zero=zero},zero=function(dict){return dict.zero},semiringInt=new Semiring($foreign.intAdd,$foreign.intMul,1,0),one=function(dict){return dict.one},mul=function(dict){return dict.mul},add=function(dict){return dict.add};exports["add"]=add;exports["zero"]=zero;exports["mul"]=mul;exports["one"]=one;exports["semiringInt"]=semiringInt})(PS);(function($PS){"use strict";$PS["Data.Foldable"]=$PS["Data.Foldable"]||{};var exports=$PS["Data.Foldable"],$foreign=$PS["Data.Foldable"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Category=$PS["Control.Category"],Data_Function=$PS["Data.Function"],Data_Monoid=$PS["Data.Monoid"],Data_Monoid_Dual=$PS["Data.Monoid.Dual"],Data_Monoid_Endo=$PS["Data.Monoid.Endo"],Data_Newtype=$PS["Data.Newtype"],Data_Semigroup=$PS["Data.Semigroup"],Data_Semiring=$PS["Data.Semiring"],Data_Unit=$PS["Data.Unit"],Foldable=function(foldMap,foldl,foldr){this.foldMap=foldMap;this.foldl=foldl;this.foldr=foldr},foldr=function(dict){return dict.foldr},traverse_=function(dictApplicative){return function(dictFoldable){return function(f){return foldr(dictFoldable)((function(){var $197=Control_Apply.applySecond(dictApplicative.Apply0());return function($198){return $197(f($198))}})())(Control_Applicative.pure(dictApplicative)(Data_Unit.unit))}}},for_=function(dictApplicative){return function(dictFoldable){return Data_Function.flip(traverse_(dictApplicative)(dictFoldable))}},foldl=function(dict){return dict.foldl},intercalate=function(dictFoldable){return function(dictMonoid){return function(sep){return function(xs){var go=function(v){return function(x){if(v.init)return{init:false,acc:x};return{init:false,acc:Data_Semigroup.append(dictMonoid.Semigroup0())(v.acc)(Data_Semigroup.append(dictMonoid.Semigroup0())(sep)(x))}}};return(foldl(dictFoldable)(go)({init:true,acc:Data_Monoid.mempty(dictMonoid)})(xs)).acc}}}},product=function(dictFoldable){return function(dictSemiring){return foldl(dictFoldable)(Data_Semiring.mul(dictSemiring))(Data_Semiring.one(dictSemiring))}},sum=function(dictFoldable){return function(dictSemiring){return foldl(dictFoldable)(Data_Semiring.add(dictSemiring))(Data_Semiring.zero(dictSemiring))}},foldMapDefaultR=function(dictFoldable){return function(dictMonoid){return function(f){return foldr(dictFoldable)(function(x){return function(acc){return Data_Semigroup.append(dictMonoid.Semigroup0())(f(x))(acc)}})(Data_Monoid.mempty(dictMonoid))}}},foldableArray=new Foldable(function(dictMonoid){return foldMapDefaultR(foldableArray)(dictMonoid)},$foreign.foldlArray,$foreign.foldrArray),foldMap=function(dict){return dict.foldMap},foldlDefault=function(dictFoldable){return function(c){return function(u){return function(xs){return Data_Newtype.unwrap(Data_Newtype.newtypeEndo)(Data_Newtype.unwrap(Data_Newtype.newtypeDual)(foldMap(dictFoldable)(Data_Monoid_Dual.monoidDual(Data_Monoid_Endo.monoidEndo(Control_Category.categoryFn)))((function(){var $201=Data_Function.flip(c);return function($202){return Data_Monoid_Dual.Dual(Data_Monoid_Endo.Endo($201($202)))}})())(xs)))(u)}}}},foldrDefault=function(dictFoldable){return function(c){return function(u){return function(xs){return Data_Newtype.unwrap(Data_Newtype.newtypeEndo)(foldMap(dictFoldable)(Data_Monoid_Endo.monoidEndo(Control_Category.categoryFn))(function($203){return Data_Monoid_Endo.Endo(c($203))})(xs))(u)}}}};exports["Foldable"]=Foldable;exports["foldr"]=foldr;exports["foldl"]=foldl;exports["foldMap"]=foldMap;exports["foldrDefault"]=foldrDefault;exports["foldlDefault"]=foldlDefault;exports["for_"]=for_;exports["intercalate"]=intercalate;exports["sum"]=sum;exports["product"]=product;exports["foldableArray"]=foldableArray})(PS);(function($PS){"use strict";$PS["Data.Maybe"]=$PS["Data.Maybe"]||{};var exports=$PS["Data.Maybe"],Control_Category=$PS["Control.Category"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Nothing=(function(){function Nothing(){};Nothing.value=new Nothing();return Nothing})(),Just=(function(){function Just(value0){this.value0=value0};Just.create=function(value0){return new Just(value0)};return Just})(),maybe=function(v){return function(v1){return function(v2){if(v2 instanceof Nothing)return v;if(v2 instanceof Just)return v1(v2.value0);throw new Error("Failed pattern match at Data.Maybe (line 217, column 1 - line 217, column 51): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}},isNothing=maybe(true)(Data_Function["const"](false)),functorMaybe=new Data_Functor.Functor(function(v){return function(v1){if(v1 instanceof Just)return new Just(v(v1.value0));return Nothing.value}}),fromMaybe=function(a){return maybe(a)(Control_Category.identity(Control_Category.categoryFn))},fromJust=function(dictPartial){return function(v){if(v instanceof Just)return v.value0;throw new Error("Failed pattern match at Data.Maybe (line 268, column 1 - line 268, column 46): "+[v.constructor.name])}};exports["Nothing"]=Nothing;exports["Just"]=Just;exports["maybe"]=maybe;exports["fromMaybe"]=fromMaybe;exports["isNothing"]=isNothing;exports["fromJust"]=fromJust;exports["functorMaybe"]=functorMaybe})(PS);(function($PS){"use strict";$PS["Data.Array"]=$PS["Data.Array"]||{};var exports=$PS["Data.Array"],$foreign=$PS["Data.Array"],Data_Foldable=$PS["Data.Foldable"],Data_Maybe=$PS["Data.Maybe"],index=$foreign.indexImpl(Data_Maybe.Just.create)(Data_Maybe.Nothing.value),fromFoldable=function(dictFoldable){return $foreign.fromFoldableImpl(Data_Foldable.foldr(dictFoldable))};exports["fromFoldable"]=fromFoldable;exports["index"]=index;exports["replicate"]=$foreign.replicate})(PS);(function($PS){"use strict";$PS["Data.Bifunctor"]=$PS["Data.Bifunctor"]||{};var exports=$PS["Data.Bifunctor"],Bifunctor=function(bimap){this.bimap=bimap},bimap=function(dict){return dict.bimap};exports["bimap"]=bimap;exports["Bifunctor"]=Bifunctor})(PS);(function($PS){"use strict";$PS["Data.Boolean"]=$PS["Data.Boolean"]||{};var exports=$PS["Data.Boolean"],otherwise=true;exports["otherwise"]=otherwise})(PS);(function(exports){"use strict";exports.intSub=function(x){return function(y){return x-y|0}}})(PS["Data.Ring"]=PS["Data.Ring"]||{});(function($PS){"use strict";$PS["Data.Ring"]=$PS["Data.Ring"]||{};var exports=$PS["Data.Ring"],$foreign=$PS["Data.Ring"],Data_Semiring=$PS["Data.Semiring"],Ring=function(Semiring0,sub){this.Semiring0=Semiring0;this.sub=sub},ringInt=new Ring(function(){return Data_Semiring.semiringInt},$foreign.intSub);exports["ringInt"]=ringInt})(PS);(function($PS){"use strict";$PS["Data.CommutativeRing"]=$PS["Data.CommutativeRing"]||{};var exports=$PS["Data.CommutativeRing"],Data_Ring=$PS["Data.Ring"],CommutativeRing=function(Ring0){this.Ring0=Ring0},commutativeRingInt=new CommutativeRing(function(){return Data_Ring.ringInt});exports["commutativeRingInt"]=commutativeRingInt})(PS);(function($PS){"use strict";$PS["Data.DateTime.Instant"]=$PS["Data.DateTime.Instant"]||{};var exports=$PS["Data.DateTime.Instant"],unInstant=function(v){return v};exports["unInstant"]=unInstant})(PS);(function($PS){"use strict";$PS["Data.Either"]=$PS["Data.Either"]||{};var exports=$PS["Data.Either"],Right=(function(){function Right(value0){this.value0=value0};Right.create=function(value0){return new Right(value0)};return Right})();exports["Right"]=Right})(PS);(function(exports){"use strict";var refEq=function(r1){return function(r2){return r1===r2}};exports.eqIntImpl=refEq;exports.eqArrayImpl=function(f){return function(xs){return function(ys){if(xs===ys)return true;if(xs.length!==ys.length)return false;for(var i=0;i<xs.length;i++)if(!f(xs[i])(ys[i]))return false;return true}}}})(PS["Data.Eq"]=PS["Data.Eq"]||{});(function($PS){"use strict";$PS["Data.Eq"]=$PS["Data.Eq"]||{};var exports=$PS["Data.Eq"],$foreign=$PS["Data.Eq"],Eq1=function(eq1){this.eq1=eq1},Eq=function(eq){this.eq=eq},eqUnit=new Eq(function(v){return function(v1){return true}}),eqInt=new Eq($foreign.eqIntImpl),eq1=function(dict){return dict.eq1},eq=function(dict){return dict.eq},eqArray=function(dictEq){return new Eq($foreign.eqArrayImpl(eq(dictEq)))};exports["Eq"]=Eq;exports["eq"]=eq;exports["Eq1"]=Eq1;exports["eq1"]=eq1;exports["eqInt"]=eqInt;exports["eqUnit"]=eqUnit;exports["eqArray"]=eqArray})(PS);(function(exports){"use strict";exports.intDegree=function(x){return Math.min(Math.abs(x),2147483647)};exports.intDiv=function(x){return function(y){if(y===0)return 0;return y>0?Math.floor(x/y):-Math.floor(x/-y)}};exports.intMod=function(x){return function(y){if(y===0)return 0;var yy=Math.abs(y);return((x%yy)+yy)%yy}}})(PS["Data.EuclideanRing"]=PS["Data.EuclideanRing"]||{});(function($PS){"use strict";$PS["Data.EuclideanRing"]=$PS["Data.EuclideanRing"]||{};var exports=$PS["Data.EuclideanRing"],$foreign=$PS["Data.EuclideanRing"],Data_CommutativeRing=$PS["Data.CommutativeRing"],EuclideanRing=function(CommutativeRing0,degree,div,mod){this.CommutativeRing0=CommutativeRing0;this.degree=degree;this.div=div;this.mod=mod},mod=function(dict){return dict.mod},euclideanRingInt=new EuclideanRing(function(){return Data_CommutativeRing.commutativeRingInt},$foreign.intDegree,$foreign.intDiv,$foreign.intMod),div=function(dict){return dict.div};exports["div"]=div;exports["mod"]=mod;exports["euclideanRingInt"]=euclideanRingInt})(PS);(function($PS){"use strict";$PS["Data.FoldableWithIndex"]=$PS["Data.FoldableWithIndex"]||{};var exports=$PS["Data.FoldableWithIndex"],FoldableWithIndex=function(Foldable0,foldMapWithIndex,foldlWithIndex,foldrWithIndex){this.Foldable0=Foldable0;this.foldMapWithIndex=foldMapWithIndex;this.foldlWithIndex=foldlWithIndex;this.foldrWithIndex=foldrWithIndex},foldrWithIndex=function(dict){return dict.foldrWithIndex};exports["FoldableWithIndex"]=FoldableWithIndex;exports["foldrWithIndex"]=foldrWithIndex})(PS);(function(exports){"use strict";exports.runFn2=function(fn){return function(a){return function(b){return fn(a,b)}}}})(PS["Data.Function.Uncurried"]=PS["Data.Function.Uncurried"]||{});(function($PS){"use strict";$PS["Data.Function.Uncurried"]=$PS["Data.Function.Uncurried"]||{};var exports=$PS["Data.Function.Uncurried"],$foreign=$PS["Data.Function.Uncurried"];exports["runFn2"]=$foreign.runFn2})(PS);(function(exports){"use strict";exports.pow=function(x){return function(y){return Math.pow(x,y)|0}}})(PS["Data.Int"]=PS["Data.Int"]||{});(function($PS){"use strict";$PS["Data.Int"]=$PS["Data.Int"]||{};var exports=$PS["Data.Int"],$foreign=$PS["Data.Int"];exports["pow"]=$foreign.pow})(PS);(function(exports){"use strict";exports.defer=function(thunk){var v=null;return function(){if(thunk===undefined)return v;v=thunk();thunk=undefined;return v}};exports.force=function(l){return l()}})(PS["Data.Lazy"]=PS["Data.Lazy"]||{});(function($PS){"use strict";$PS["Data.Lazy"]=$PS["Data.Lazy"]||{};var exports=$PS["Data.Lazy"],$foreign=$PS["Data.Lazy"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Data_Functor=$PS["Data.Functor"],functorLazy=new Data_Functor.Functor(function(f){return function(l){return $foreign.defer(function(v){return f($foreign.force(l))})}}),applyLazy=new Control_Apply.Apply(function(){return functorLazy},function(f){return function(x){return $foreign.defer(function(v){return $foreign.force(f)($foreign.force(x))})}}),bindLazy=new Control_Bind.Bind(function(){return applyLazy},function(l){return function(f){return $foreign.defer(function(v){return $foreign.force(f($foreign.force(l)))})}}),applicativeLazy=new Control_Applicative.Applicative(function(){return applyLazy},function(a){return $foreign.defer(function(v){return a})});exports["functorLazy"]=functorLazy;exports["applyLazy"]=applyLazy;exports["applicativeLazy"]=applicativeLazy;exports["bindLazy"]=bindLazy;exports["defer"]=$foreign.defer;exports["force"]=$foreign.force})(PS);(function(exports){"use strict";exports.unfoldrArrayImpl=function(isNothing){return function(fromJust){return function(fst){return function(snd){return function(f){return function(b){var result=[],value=b;while(true){var maybe=f(value);if(isNothing(maybe))return result;var tuple=fromJust(maybe);result.push(fst(tuple));value=snd(tuple)}}}}}}}})(PS["Data.Unfoldable"]=PS["Data.Unfoldable"]||{});(function(exports){"use strict";var unsafeCompareImpl=function(lt){return function(eq){return function(gt){return function(x){return function(y){return x<y?lt:x===y?eq:gt}}}}};exports.ordIntImpl=unsafeCompareImpl})(PS["Data.Ord"]=PS["Data.Ord"]||{});(function($PS){"use strict";$PS["Data.Ordering"]=$PS["Data.Ordering"]||{};var exports=$PS["Data.Ordering"],LT=(function(){function LT(){};LT.value=new LT();return LT})(),GT=(function(){function GT(){};GT.value=new GT();return GT})(),EQ=(function(){function EQ(){};EQ.value=new EQ();return EQ})();exports["LT"]=LT;exports["GT"]=GT;exports["EQ"]=EQ})(PS);(function($PS){"use strict";$PS["Data.Ord"]=$PS["Data.Ord"]||{};var exports=$PS["Data.Ord"],$foreign=$PS["Data.Ord"],Data_Eq=$PS["Data.Eq"],Data_Ordering=$PS["Data.Ordering"],Ord1=function(Eq10,compare1){this.Eq10=Eq10;this.compare1=compare1},Ord=function(Eq0,compare){this.Eq0=Eq0;this.compare=compare},ordInt=new Ord(function(){return Data_Eq.eqInt},$foreign.ordIntImpl(Data_Ordering.LT.value)(Data_Ordering.EQ.value)(Data_Ordering.GT.value)),compare1=function(dict){return dict.compare1},compare=function(dict){return dict.compare},max=function(dictOrd){return function(x){return function(y){var v=compare(dictOrd)(x)(y);if(v instanceof Data_Ordering.LT)return y;if(v instanceof Data_Ordering.EQ)return x;if(v instanceof Data_Ordering.GT)return x;throw new Error("Failed pattern match at Data.Ord (line 167, column 3 - line 170, column 12): "+[v.constructor.name])}}},min=function(dictOrd){return function(x){return function(y){var v=compare(dictOrd)(x)(y);if(v instanceof Data_Ordering.LT)return x;if(v instanceof Data_Ordering.EQ)return x;if(v instanceof Data_Ordering.GT)return y;throw new Error("Failed pattern match at Data.Ord (line 158, column 3 - line 161, column 12): "+[v.constructor.name])}}};exports["Ord"]=Ord;exports["compare"]=compare;exports["Ord1"]=Ord1;exports["compare1"]=compare1;exports["min"]=min;exports["max"]=max;exports["ordInt"]=ordInt})(PS);(function(exports){"use strict";exports.showIntImpl=function(n){return n.toString()};exports.showNumberImpl=function(n){var str=n.toString();return isNaN(str+".0")?str:str+".0"}})(PS["Data.Show"]=PS["Data.Show"]||{});(function($PS){"use strict";$PS["Data.Show"]=$PS["Data.Show"]||{};var exports=$PS["Data.Show"],$foreign=$PS["Data.Show"],Show=function(show){this.show=show},showNumber=new Show($foreign.showNumberImpl),showInt=new Show($foreign.showIntImpl),show=function(dict){return dict.show};exports["Show"]=Show;exports["show"]=show;exports["showInt"]=showInt;exports["showNumber"]=showNumber})(PS);(function($PS){"use strict";$PS["Data.Tuple"]=$PS["Data.Tuple"]||{};var exports=$PS["Data.Tuple"],Data_Bifunctor=$PS["Data.Bifunctor"],Data_Eq=$PS["Data.Eq"],Data_Functor=$PS["Data.Functor"],Data_Ord=$PS["Data.Ord"],Data_Ordering=$PS["Data.Ordering"],Data_Show=$PS["Data.Show"],Tuple=(function(){function Tuple(value0,value1){this.value0=value0;this.value1=value1};Tuple.create=function(value0){return function(value1){return new Tuple(value0,value1)}};return Tuple})(),uncurry=function(f){return function(v){return f(v.value0)(v.value1)}},snd=function(v){return v.value1},showTuple=function(dictShow){return function(dictShow1){return new Data_Show.Show(function(v){return"(Tuple "+(Data_Show.show(dictShow)(v.value0)+(" "+(Data_Show.show(dictShow1)(v.value1)+")")))})}},functorTuple=new Data_Functor.Functor(function(f){return function(m){return new Tuple(m.value0,f(m.value1))}}),fst=function(v){return v.value0},eqTuple=function(dictEq){return function(dictEq1){return new Data_Eq.Eq(function(x){return function(y){return Data_Eq.eq(dictEq)(x.value0)(y.value0)&&Data_Eq.eq(dictEq1)(x.value1)(y.value1)}})}},ordTuple=function(dictOrd){return function(dictOrd1){return new Data_Ord.Ord(function(){return eqTuple(dictOrd.Eq0())(dictOrd1.Eq0())},function(x){return function(y){var v=Data_Ord.compare(dictOrd)(x.value0)(y.value0);if(v instanceof Data_Ordering.LT)return Data_Ordering.LT.value;if(v instanceof Data_Ordering.GT)return Data_Ordering.GT.value;return Data_Ord.compare(dictOrd1)(x.value1)(y.value1)}})}},bifunctorTuple=new Data_Bifunctor.Bifunctor(function(f){return function(g){return function(v){return new Tuple(f(v.value0),g(v.value1))}}});exports["Tuple"]=Tuple;exports["fst"]=fst;exports["snd"]=snd;exports["uncurry"]=uncurry;exports["showTuple"]=showTuple;exports["eqTuple"]=eqTuple;exports["ordTuple"]=ordTuple;exports["functorTuple"]=functorTuple;exports["bifunctorTuple"]=bifunctorTuple})(PS);(function(exports){"use strict";exports.unfoldr1ArrayImpl=function(isNothing){return function(fromJust){return function(fst){return function(snd){return function(f){return function(b){var result=[],value=b;while(true){var tuple=f(value);result.push(fst(tuple));var maybe=snd(tuple);if(isNothing(maybe))return result;value=fromJust(maybe)}}}}}}}})(PS["Data.Unfoldable1"]=PS["Data.Unfoldable1"]||{});(function($PS){"use strict";$PS["Data.Unfoldable1"]=$PS["Data.Unfoldable1"]||{};var exports=$PS["Data.Unfoldable1"],$foreign=$PS["Data.Unfoldable1"],Data_Maybe=$PS["Data.Maybe"],Data_Tuple=$PS["Data.Tuple"],Unfoldable1=function(unfoldr1){this.unfoldr1=unfoldr1},unfoldable1Array=new Unfoldable1($foreign.unfoldr1ArrayImpl(Data_Maybe.isNothing)(Data_Maybe.fromJust())(Data_Tuple.fst)(Data_Tuple.snd));exports["Unfoldable1"]=Unfoldable1;exports["unfoldable1Array"]=unfoldable1Array})(PS);(function($PS){"use strict";$PS["Data.Unfoldable"]=$PS["Data.Unfoldable"]||{};var exports=$PS["Data.Unfoldable"],$foreign=$PS["Data.Unfoldable"],Data_Maybe=$PS["Data.Maybe"],Data_Tuple=$PS["Data.Tuple"],Data_Unfoldable1=$PS["Data.Unfoldable1"],Unfoldable=function(Unfoldable10,unfoldr){this.Unfoldable10=Unfoldable10;this.unfoldr=unfoldr},unfoldr=function(dict){return dict.unfoldr},unfoldableArray=new Unfoldable(function(){return Data_Unfoldable1.unfoldable1Array},$foreign.unfoldrArrayImpl(Data_Maybe.isNothing)(Data_Maybe.fromJust())(Data_Tuple.fst)(Data_Tuple.snd));exports["Unfoldable"]=Unfoldable;exports["unfoldr"]=unfoldr;exports["unfoldableArray"]=unfoldableArray})(PS);(function($PS){"use strict";$PS["Data.List.Lazy.Types"]=$PS["Data.List.Lazy.Types"]||{};var exports=$PS["Data.List.Lazy.Types"],Control_Alt=$PS["Control.Alt"],Control_Alternative=$PS["Control.Alternative"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Control_Lazy=$PS["Control.Lazy"],Control_Monad=$PS["Control.Monad"],Control_MonadZero=$PS["Control.MonadZero"],Control_Plus=$PS["Control.Plus"],Data_Foldable=$PS["Data.Foldable"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Data_Lazy=$PS["Data.Lazy"],Data_Maybe=$PS["Data.Maybe"],Data_Monoid=$PS["Data.Monoid"],Data_Newtype=$PS["Data.Newtype"],Data_Semigroup=$PS["Data.Semigroup"],Data_Unfoldable=$PS["Data.Unfoldable"],Data_Unfoldable1=$PS["Data.Unfoldable1"],List=function(x){return x},Nil=(function(){function Nil(){};Nil.value=new Nil();return Nil})(),Cons=(function(){function Cons(value0,value1){this.value0=value0;this.value1=value1};Cons.create=function(value0){return function(value1){return new Cons(value0,value1)}};return Cons})(),nil=List(Data_Lazy.defer(function(v){return Nil.value})),newtypeList=new Data_Newtype.Newtype(function(n){return n},List),step=(function(){var $215=Data_Newtype.unwrap(newtypeList);return function($216){return Data_Lazy.force($215($216))}})(),semigroupList=new Data_Semigroup.Semigroup(function(xs){return function(ys){var go=function(v){if(v instanceof Nil)return step(ys);if(v instanceof Cons)return new Cons(v.value0,Data_Semigroup.append(semigroupList)(v.value1)(ys));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 98, column 5 - line 98, column 21): "+[v.constructor.name])};return Data_Functor.map(Data_Lazy.functorLazy)(go)(Data_Newtype.unwrap(newtypeList)(xs))}}),monoidList=new Data_Monoid.Monoid(function(){return semigroupList},nil),lazyList=new Control_Lazy.Lazy(function(f){return List(Data_Lazy.defer(function($217){return step(f($217))}))}),functorList=new Data_Functor.Functor(function(f){return function(xs){var go=function(v){if(v instanceof Nil)return Nil.value;if(v instanceof Cons)return new Cons(f(v.value0),Data_Functor.map(functorList)(f)(v.value1));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 107, column 5 - line 107, column 17): "+[v.constructor.name])};return Data_Functor.map(Data_Lazy.functorLazy)(go)(Data_Newtype.unwrap(newtypeList)(xs))}}),cons=function(x){return function(xs){return List(Data_Lazy.defer(function(v){return new Cons(x,xs)}))}},foldableList=new Data_Foldable.Foldable(function(dictMonoid){return function(f){return Data_Foldable.foldl(foldableList)(function(b){return function(a){return Data_Semigroup.append(dictMonoid.Semigroup0())(b)(f(a))}})(Data_Monoid.mempty(dictMonoid))}},function(op){var go=function($copy_b){return function($copy_xs){var $tco_var_b=$copy_b,$tco_done=false,$tco_result;function $tco_loop(b,xs){var v=step(xs);if(v instanceof Nil){$tco_done=true;return b};if(v instanceof Cons){$tco_var_b=op(b)(v.value0);$copy_xs=v.value1;return};throw new Error("Failed pattern match at Data.List.Lazy.Types (line 122, column 7 - line 124, column 40): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_b,$copy_xs);return $tco_result}};return go},function(op){return function(z){return function(xs){var rev=Data_Foldable.foldl(foldableList)(Data_Function.flip(cons))(nil);return Data_Foldable.foldl(foldableList)(Data_Function.flip(op))(z)(rev(xs))}}}),unfoldable1List=new Data_Unfoldable1.Unfoldable1((function(){var go=function(f){return function(b){return Control_Lazy.defer(lazyList)(function(v){var v1=f(b);if(v1.value1 instanceof Data_Maybe.Just)return cons(v1.value0)(go(f)(v1.value1.value0));if(v1.value1 instanceof Data_Maybe.Nothing)return cons(v1.value0)(nil);throw new Error("Failed pattern match at Data.List.Lazy.Types (line 146, column 28 - line 148, column 33): "+[v1.constructor.name])})}};return go})()),unfoldableList=new Data_Unfoldable.Unfoldable(function(){return unfoldable1List},(function(){var go=function(f){return function(b){return Control_Lazy.defer(lazyList)(function(v){var v1=f(b);if(v1 instanceof Data_Maybe.Nothing)return nil;if(v1 instanceof Data_Maybe.Just)return cons(v1.value0.value0)(go(f)(v1.value0.value1));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 152, column 28 - line 154, column 39): "+[v1.constructor.name])})}};return go})()),monadList=new Control_Monad.Monad(function(){return applicativeList},function(){return bindList}),bindList=new Control_Bind.Bind(function(){return applyList},function(xs){return function(f){var go=function(v){if(v instanceof Nil)return Nil.value;if(v instanceof Cons)return step(Data_Semigroup.append(semigroupList)(f(v.value0))(Control_Bind.bind(bindList)(v.value1)(f)));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 175, column 5 - line 175, column 17): "+[v.constructor.name])};return Data_Functor.map(Data_Lazy.functorLazy)(go)(Data_Newtype.unwrap(newtypeList)(xs))}}),applyList=new Control_Apply.Apply(function(){return functorList},Control_Monad.ap(monadList)),applicativeList=new Control_Applicative.Applicative(function(){return applyList},function(a){return cons(a)(nil)}),altList=new Control_Alt.Alt(function(){return functorList},Data_Semigroup.append(semigroupList)),plusList=new Control_Plus.Plus(function(){return altList},nil),alternativeList=new Control_Alternative.Alternative(function(){return applicativeList},function(){return plusList}),monadZeroList=new Control_MonadZero.MonadZero(function(){return alternativeList},function(){return monadList});exports["List"]=List;exports["Nil"]=Nil;exports["Cons"]=Cons;exports["step"]=step;exports["nil"]=nil;exports["cons"]=cons;exports["newtypeList"]=newtypeList;exports["lazyList"]=lazyList;exports["semigroupList"]=semigroupList;exports["monoidList"]=monoidList;exports["functorList"]=functorList;exports["foldableList"]=foldableList;exports["unfoldableList"]=unfoldableList;exports["applicativeList"]=applicativeList;exports["bindList"]=bindList;exports["monadZeroList"]=monadZeroList})(PS);(function($PS){"use strict";$PS["Data.List.Lazy"]=$PS["Data.List.Lazy"]||{};var exports=$PS["Data.List.Lazy"],Control_Apply=$PS["Control.Apply"],Control_Lazy=$PS["Control.Lazy"],Data_Boolean=$PS["Data.Boolean"],Data_Foldable=$PS["Data.Foldable"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Data_Lazy=$PS["Data.Lazy"],Data_List_Lazy_Types=$PS["Data.List.Lazy.Types"],Data_Maybe=$PS["Data.Maybe"],Data_Newtype=$PS["Data.Newtype"],Data_Tuple=$PS["Data.Tuple"],Data_Unfoldable=$PS["Data.Unfoldable"],zipWith=function(f){return function(xs){return function(ys){var go=function(v){return function(v1){if(v instanceof Data_List_Lazy_Types.Nil)return Data_List_Lazy_Types.Nil.value;if(v1 instanceof Data_List_Lazy_Types.Nil)return Data_List_Lazy_Types.Nil.value;if(v instanceof Data_List_Lazy_Types.Cons&&v1 instanceof Data_List_Lazy_Types.Cons)return new Data_List_Lazy_Types.Cons(f(v.value0)(v1.value0),zipWith(f)(v.value1)(v1.value1));throw new Error("Failed pattern match at Data.List.Lazy (line 693, column 3 - line 693, column 35): "+[v.constructor.name,v1.constructor.name])}};return Control_Apply.apply(Data_Lazy.applyLazy)(Data_Functor.map(Data_Lazy.functorLazy)(go)(Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList)(xs)))(Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList)(ys))}}},zip=zipWith(Data_Tuple.Tuple.create),uncons=function(xs){var v=Data_List_Lazy_Types.step(xs);if(v instanceof Data_List_Lazy_Types.Nil)return Data_Maybe.Nothing.value;if(v instanceof Data_List_Lazy_Types.Cons)return new Data_Maybe.Just({head:v.value0,tail:v.value1});throw new Error("Failed pattern match at Data.List.Lazy (line 285, column 13 - line 287, column 44): "+[v.constructor.name])},take=function(n){var go=function(v){return function(v1){if(v1 instanceof Data_List_Lazy_Types.Nil)return Data_List_Lazy_Types.Nil.value;if(v1 instanceof Data_List_Lazy_Types.Cons)return new Data_List_Lazy_Types.Cons(v1.value0,take(v-1|0)(v1.value1));throw new Error("Failed pattern match at Data.List.Lazy (line 517, column 3 - line 517, column 32): "+[v.constructor.name,v1.constructor.name])}},$119=n<=0;if($119)return Data_Function["const"](Data_List_Lazy_Types.nil);var $242=Data_Functor.map(Data_Lazy.functorLazy)(go(n)),$243=Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList);return function($244){return Data_List_Lazy_Types.List($242($243($244)))}},tail=function(xs){return Data_Functor.map(Data_Maybe.functorMaybe)(function(v){return v.tail})(uncons(xs))},singleton=function(a){return Data_List_Lazy_Types.cons(a)(Data_List_Lazy_Types.nil)},reverse=function(xs){return Control_Lazy.defer(Data_List_Lazy_Types.lazyList)(function(v){return Data_Foldable.foldl(Data_List_Lazy_Types.foldableList)(Data_Function.flip(Data_List_Lazy_Types.cons))(Data_List_Lazy_Types.nil)(xs)})},repeat=function(x){return Control_Lazy.fix(Data_List_Lazy_Types.lazyList)(function(xs){return Data_List_Lazy_Types.cons(x)(xs)})},range=function(start){return function(end){if(start>end){var g=function(x){if(x>=end)return new Data_Maybe.Just(new Data_Tuple.Tuple(x,x-1|0));if(Data_Boolean.otherwise)return Data_Maybe.Nothing.value;throw new Error("Failed pattern match at Data.List.Lazy (line 148, column 13 - line 149, column 38): "+[x.constructor.name])};return Data_Unfoldable.unfoldr(Data_List_Lazy_Types.unfoldableList)(g)(start)};if(Data_Boolean.otherwise){var f=function(x){if(x<=end)return new Data_Maybe.Just(new Data_Tuple.Tuple(x,x+1|0));if(Data_Boolean.otherwise)return Data_Maybe.Nothing.value;throw new Error("Failed pattern match at Data.List.Lazy (line 153, column 5 - line 154, column 30): "+[x.constructor.name])};return Data_Unfoldable.unfoldr(Data_List_Lazy_Types.unfoldableList)(f)(start)};throw new Error("Failed pattern match at Data.List.Lazy (line 145, column 1 - line 145, column 32): "+[start.constructor.name,end.constructor.name])}},mapMaybe=function(f){var go=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Data_List_Lazy_Types.Nil){$tco_done=true;return Data_List_Lazy_Types.Nil.value};if(v instanceof Data_List_Lazy_Types.Cons){var v1=f(v.value0);if(v1 instanceof Data_Maybe.Nothing){$copy_v=Data_List_Lazy_Types.step(v.value1);return};if(v1 instanceof Data_Maybe.Just){$tco_done=true;return new Data_List_Lazy_Types.Cons(v1.value0,mapMaybe(f)(v.value1))};throw new Error("Failed pattern match at Data.List.Lazy (line 460, column 5 - line 462, column 39): "+[v1.constructor.name])};throw new Error("Failed pattern match at Data.List.Lazy (line 458, column 3 - line 458, column 15): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result},$246=Data_Functor.map(Data_Lazy.functorLazy)(go),$247=Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList);return function($248){return Data_List_Lazy_Types.List($246($247($248)))}},iterate=function(f){return function(x){return Control_Lazy.fix(Data_List_Lazy_Types.lazyList)(function(xs){return Data_List_Lazy_Types.cons(x)(Data_Functor.map(Data_List_Lazy_Types.functorList)(f)(xs))})}},head=function(xs){return Data_Functor.map(Data_Maybe.functorMaybe)(function(v){return v.head})(uncons(xs))},transpose=function(xs){var v=uncons(xs);if(v instanceof Data_Maybe.Nothing)return xs;if(v instanceof Data_Maybe.Just){var v1=uncons(v.value0.head);if(v1 instanceof Data_Maybe.Nothing)return transpose(v.value0.tail);if(v1 instanceof Data_Maybe.Just)return Data_List_Lazy_Types.cons(Data_List_Lazy_Types.cons(v1.value0.head)(mapMaybe(head)(v.value0.tail)))(transpose(Data_List_Lazy_Types.cons(v1.value0.tail)(mapMaybe(tail)(v.value0.tail))));throw new Error("Failed pattern match at Data.List.Lazy (line 734, column 7 - line 738, column 72): "+[v1.constructor.name])};throw new Error("Failed pattern match at Data.List.Lazy (line 730, column 3 - line 738, column 72): "+[v.constructor.name])},fromFoldable=function(dictFoldable){return Data_Foldable.foldr(dictFoldable)(Data_List_Lazy_Types.cons)(Data_List_Lazy_Types.nil)},drop=function(n){var go=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v,$tco_done=false,$tco_result;function $tco_loop(v,v1){if(v===0){$tco_done=true;return v1};if(v1 instanceof Data_List_Lazy_Types.Nil){$tco_done=true;return Data_List_Lazy_Types.Nil.value};if(v1 instanceof Data_List_Lazy_Types.Cons){$tco_var_v=v-1|0;$copy_v1=Data_List_Lazy_Types.step(v1.value1);return};throw new Error("Failed pattern match at Data.List.Lazy (line 536, column 3 - line 536, column 15): "+[v.constructor.name,v1.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$copy_v1);return $tco_result}},$263=Data_Functor.map(Data_Lazy.functorLazy)(go(n)),$264=Data_Newtype.unwrap(Data_List_Lazy_Types.newtypeList);return function($265){return Data_List_Lazy_Types.List($263($264($265)))}};exports["fromFoldable"]=fromFoldable;exports["singleton"]=singleton;exports["range"]=range;exports["repeat"]=repeat;exports["iterate"]=iterate;exports["reverse"]=reverse;exports["take"]=take;exports["drop"]=drop;exports["zip"]=zip;exports["transpose"]=transpose})(PS);(function($PS){"use strict";$PS["Data.List.Types"]=$PS["Data.List.Types"]||{};var exports=$PS["Data.List.Types"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Data_Eq=$PS["Data.Eq"],Data_Foldable=$PS["Data.Foldable"],Data_Function=$PS["Data.Function"],Data_Functor=$PS["Data.Functor"],Data_Maybe=$PS["Data.Maybe"],Data_Monoid=$PS["Data.Monoid"],Data_Ord=$PS["Data.Ord"],Data_Ordering=$PS["Data.Ordering"],Data_Semigroup=$PS["Data.Semigroup"],Data_Unfoldable=$PS["Data.Unfoldable"],Data_Unfoldable1=$PS["Data.Unfoldable1"],Nil=(function(){function Nil(){};Nil.value=new Nil();return Nil})(),Cons=(function(){function Cons(value0,value1){this.value0=value0;this.value1=value1};Cons.create=function(value0){return function(value1){return new Cons(value0,value1)}};return Cons})(),listMap=function(f){var chunkedRevMap=function($copy_chunksAcc){return function($copy_v){var $tco_var_chunksAcc=$copy_chunksAcc,$tco_done=false,$tco_result;function $tco_loop(chunksAcc,v){if(v instanceof Cons&&(v.value1 instanceof Cons&&v.value1.value1 instanceof Cons)){$tco_var_chunksAcc=new Cons(v,chunksAcc);$copy_v=v.value1.value1.value1;return};var unrolledMap=function(v1){if(v1 instanceof Cons&&(v1.value1 instanceof Cons&&v1.value1.value1 instanceof Nil))return new Cons(f(v1.value0),new Cons(f(v1.value1.value0),Nil.value));if(v1 instanceof Cons&&v1.value1 instanceof Nil)return new Cons(f(v1.value0),Nil.value);return Nil.value},reverseUnrolledMap=function($copy_v1){return function($copy_acc){var $tco_var_v1=$copy_v1,$tco_done=false,$tco_result;function $tco_loop(v1,acc){if(v1 instanceof Cons&&(v1.value0 instanceof Cons&&(v1.value0.value1 instanceof Cons&&v1.value0.value1.value1 instanceof Cons))){$tco_var_v1=v1.value1;$copy_acc=new Cons(f(v1.value0.value0),new Cons(f(v1.value0.value1.value0),new Cons(f(v1.value0.value1.value1.value0),acc)));return};$tco_done=true;return acc};while(!$tco_done)$tco_result=$tco_loop($tco_var_v1,$copy_acc);return $tco_result}};$tco_done=true;return reverseUnrolledMap(chunksAcc)(unrolledMap(v))};while(!$tco_done)$tco_result=$tco_loop($tco_var_chunksAcc,$copy_v);return $tco_result}};return chunkedRevMap(Nil.value)},functorList=new Data_Functor.Functor(listMap),foldableList=new Data_Foldable.Foldable(function(dictMonoid){return function(f){return Data_Foldable.foldl(foldableList)(function(acc){var $202=Data_Semigroup.append(dictMonoid.Semigroup0())(acc);return function($203){return $202(f($203))}})(Data_Monoid.mempty(dictMonoid))}},function(f){var go=function($copy_b){return function($copy_v){var $tco_var_b=$copy_b,$tco_done=false,$tco_result;function $tco_loop(b,v){if(v instanceof Nil){$tco_done=true;return b};if(v instanceof Cons){$tco_var_b=f(b)(v.value0);$copy_v=v.value1;return};throw new Error("Failed pattern match at Data.List.Types (line 109, column 12 - line 111, column 30): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_b,$copy_v);return $tco_result}};return go},function(f){return function(b){var rev=Data_Foldable.foldl(foldableList)(Data_Function.flip(Cons.create))(Nil.value),$204=Data_Foldable.foldl(foldableList)(Data_Function.flip(f))(b);return function($205){return $204(rev($205))}}}),semigroupList=new Data_Semigroup.Semigroup(function(xs){return function(ys){return Data_Foldable.foldr(foldableList)(Cons.create)(ys)(xs)}}),unfoldable1List=new Data_Unfoldable1.Unfoldable1(function(f){return function(b){var go=function($copy_source){return function($copy_memo){var $tco_var_source=$copy_source,$tco_done=false,$tco_result;function $tco_loop(source,memo){var v=f(source);if(v.value1 instanceof Data_Maybe.Just){$tco_var_source=v.value1.value0;$copy_memo=new Cons(v.value0,memo);return};if(v.value1 instanceof Data_Maybe.Nothing){$tco_done=true;return Data_Foldable.foldl(foldableList)(Data_Function.flip(Cons.create))(Nil.value)(new Cons(v.value0,memo))};throw new Error("Failed pattern match at Data.List.Types (line 133, column 22 - line 135, column 61): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_source,$copy_memo);return $tco_result}};return go(b)(Nil.value)}}),unfoldableList=new Data_Unfoldable.Unfoldable(function(){return unfoldable1List},function(f){return function(b){var go=function($copy_source){return function($copy_memo){var $tco_var_source=$copy_source,$tco_done=false,$tco_result;function $tco_loop(source,memo){var v=f(source);if(v instanceof Data_Maybe.Nothing){$tco_done=true;return Data_Foldable.foldl(foldableList)(Data_Function.flip(Cons.create))(Nil.value)(memo)};if(v instanceof Data_Maybe.Just){$tco_var_source=v.value0.value1;$copy_memo=new Cons(v.value0.value0,memo);return};throw new Error("Failed pattern match at Data.List.Types (line 140, column 22 - line 142, column 52): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_source,$copy_memo);return $tco_result}};return go(b)(Nil.value)}}),eq1List=new Data_Eq.Eq1(function(dictEq){return function(xs){return function(ys){var go=function($copy_v){return function($copy_v1){return function($copy_v2){var $tco_var_v=$copy_v,$tco_var_v1=$copy_v1,$tco_done=false,$tco_result;function $tco_loop(v,v1,v2){if(!v2){$tco_done=true;return false};if(v instanceof Nil&&v1 instanceof Nil){$tco_done=true;return v2};if(v instanceof Cons&&v1 instanceof Cons){$tco_var_v=v.value1;$tco_var_v1=v1.value1;$copy_v2=v2&&Data_Eq.eq(dictEq)(v1.value0)(v.value0);return};$tco_done=true;return false};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$tco_var_v1,$copy_v2);return $tco_result}}};return go(xs)(ys)(true)}}}),eqList=function(dictEq){return new Data_Eq.Eq(Data_Eq.eq1(eq1List)(dictEq))},ord1List=new Data_Ord.Ord1(function(){return eq1List},function(dictOrd){return function(xs){return function(ys){var go=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v,$tco_done=false,$tco_result;function $tco_loop(v,v1){if(v instanceof Nil&&v1 instanceof Nil){$tco_done=true;return Data_Ordering.EQ.value};if(v instanceof Nil){$tco_done=true;return Data_Ordering.LT.value};if(v1 instanceof Nil){$tco_done=true;return Data_Ordering.GT.value};if(v instanceof Cons&&v1 instanceof Cons){var v2=Data_Ord.compare(dictOrd)(v.value0)(v1.value0);if(v2 instanceof Data_Ordering.EQ){$tco_var_v=v.value1;$copy_v1=v1.value1;return};$tco_done=true;return v2};throw new Error("Failed pattern match at Data.List.Types (line 61, column 5 - line 61, column 20): "+[v.constructor.name,v1.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$copy_v1);return $tco_result}};return go(xs)(ys)}}}),ordList=function(dictOrd){return new Data_Ord.Ord(function(){return eqList(dictOrd.Eq0())},Data_Ord.compare1(ord1List)(dictOrd))},applyList=new Control_Apply.Apply(function(){return functorList},function(v){return function(v1){if(v instanceof Nil)return Nil.value;if(v instanceof Cons)return Data_Semigroup.append(semigroupList)(Data_Functor.map(functorList)(v.value0)(v1))(Control_Apply.apply(applyList)(v.value1)(v1));throw new Error("Failed pattern match at Data.List.Types (line 155, column 1 - line 157, column 48): "+[v.constructor.name,v1.constructor.name])}}),applicativeList=new Control_Applicative.Applicative(function(){return applyList},function(a){return new Cons(a,Nil.value)});exports["Nil"]=Nil;exports["Cons"]=Cons;exports["ordList"]=ordList;exports["semigroupList"]=semigroupList;exports["foldableList"]=foldableList;exports["unfoldableList"]=unfoldableList;exports["applicativeList"]=applicativeList})(PS);(function($PS){"use strict";$PS["Data.Map.Internal"]=$PS["Data.Map.Internal"]||{};var exports=$PS["Data.Map.Internal"],Control_Applicative=$PS["Control.Applicative"],Control_Category=$PS["Control.Category"],Data_Eq=$PS["Data.Eq"],Data_Foldable=$PS["Data.Foldable"],Data_FoldableWithIndex=$PS["Data.FoldableWithIndex"],Data_Function=$PS["Data.Function"],Data_List_Types=$PS["Data.List.Types"],Data_Maybe=$PS["Data.Maybe"],Data_Ord=$PS["Data.Ord"],Data_Ordering=$PS["Data.Ordering"],Data_Semigroup=$PS["Data.Semigroup"],Data_Tuple=$PS["Data.Tuple"],Data_Unfoldable=$PS["Data.Unfoldable"],Leaf=(function(){function Leaf(){};Leaf.value=new Leaf();return Leaf})(),Two=(function(){function Two(value0,value1,value2,value3){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3};Two.create=function(value0){return function(value1){return function(value2){return function(value3){return new Two(value0,value1,value2,value3)}}}};return Two})(),Three=(function(){function Three(value0,value1,value2,value3,value4,value5,value6){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3;this.value4=value4;this.value5=value5;this.value6=value6};Three.create=function(value0){return function(value1){return function(value2){return function(value3){return function(value4){return function(value5){return function(value6){return new Three(value0,value1,value2,value3,value4,value5,value6)}}}}}}};return Three})(),TwoLeft=(function(){function TwoLeft(value0,value1,value2){this.value0=value0;this.value1=value1;this.value2=value2};TwoLeft.create=function(value0){return function(value1){return function(value2){return new TwoLeft(value0,value1,value2)}}};return TwoLeft})(),TwoRight=(function(){function TwoRight(value0,value1,value2){this.value0=value0;this.value1=value1;this.value2=value2};TwoRight.create=function(value0){return function(value1){return function(value2){return new TwoRight(value0,value1,value2)}}};return TwoRight})(),ThreeLeft=(function(){function ThreeLeft(value0,value1,value2,value3,value4,value5){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3;this.value4=value4;this.value5=value5};ThreeLeft.create=function(value0){return function(value1){return function(value2){return function(value3){return function(value4){return function(value5){return new ThreeLeft(value0,value1,value2,value3,value4,value5)}}}}}};return ThreeLeft})(),ThreeMiddle=(function(){function ThreeMiddle(value0,value1,value2,value3,value4,value5){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3;this.value4=value4;this.value5=value5};ThreeMiddle.create=function(value0){return function(value1){return function(value2){return function(value3){return function(value4){return function(value5){return new ThreeMiddle(value0,value1,value2,value3,value4,value5)}}}}}};return ThreeMiddle})(),ThreeRight=(function(){function ThreeRight(value0,value1,value2,value3,value4,value5){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3;this.value4=value4;this.value5=value5};ThreeRight.create=function(value0){return function(value1){return function(value2){return function(value3){return function(value4){return function(value5){return new ThreeRight(value0,value1,value2,value3,value4,value5)}}}}}};return ThreeRight})(),KickUp=(function(){function KickUp(value0,value1,value2,value3){this.value0=value0;this.value1=value1;this.value2=value2;this.value3=value3};KickUp.create=function(value0){return function(value1){return function(value2){return function(value3){return new KickUp(value0,value1,value2,value3)}}}};return KickUp})(),values=function(v){if(v instanceof Leaf)return Data_List_Types.Nil.value;if(v instanceof Two)return Data_Semigroup.append(Data_List_Types.semigroupList)(values(v.value0))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value2))(values(v.value3)));if(v instanceof Three)return Data_Semigroup.append(Data_List_Types.semigroupList)(values(v.value0))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value2))(Data_Semigroup.append(Data_List_Types.semigroupList)(values(v.value3))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value5))(values(v.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 612, column 1 - line 612, column 40): "+[v.constructor.name])},singleton=function(k){return function(v){return new Two(Leaf.value,k,v,Leaf.value)}},toUnfoldable=function(dictUnfoldable){return function(m){var go=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Data_List_Types.Nil){$tco_done=true;return Data_Maybe.Nothing.value};if(v instanceof Data_List_Types.Cons){if(v.value0 instanceof Leaf){$copy_v=v.value1;return};if(v.value0 instanceof Two&&(v.value0.value0 instanceof Leaf&&v.value0.value3 instanceof Leaf)){$tco_done=true;return Data_Maybe.Just.create(new Data_Tuple.Tuple(new Data_Tuple.Tuple(v.value0.value1,v.value0.value2),v.value1))};if(v.value0 instanceof Two&&v.value0.value0 instanceof Leaf){$tco_done=true;return Data_Maybe.Just.create(new Data_Tuple.Tuple(new Data_Tuple.Tuple(v.value0.value1,v.value0.value2),new Data_List_Types.Cons(v.value0.value3,v.value1)))};if(v.value0 instanceof Two){$copy_v=new Data_List_Types.Cons(v.value0.value0,new Data_List_Types.Cons(singleton(v.value0.value1)(v.value0.value2),new Data_List_Types.Cons(v.value0.value3,v.value1)));return};if(v.value0 instanceof Three){$copy_v=new Data_List_Types.Cons(v.value0.value0,new Data_List_Types.Cons(singleton(v.value0.value1)(v.value0.value2),new Data_List_Types.Cons(v.value0.value3,new Data_List_Types.Cons(singleton(v.value0.value4)(v.value0.value5),new Data_List_Types.Cons(v.value0.value6,v.value1)))));return};throw new Error("Failed pattern match at Data.Map.Internal (line 577, column 18 - line 586, column 71): "+[v.value0.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 576, column 3 - line 576, column 19): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result};return Data_Unfoldable.unfoldr(dictUnfoldable)(go)(new Data_List_Types.Cons(m,Data_List_Types.Nil.value))}},toAscArray=toUnfoldable(Data_Unfoldable.unfoldableArray),toUnfoldableUnordered=function(dictUnfoldable){return function(m){var go=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Data_List_Types.Nil){$tco_done=true;return Data_Maybe.Nothing.value};if(v instanceof Data_List_Types.Cons){if(v.value0 instanceof Leaf){$copy_v=v.value1;return};if(v.value0 instanceof Two){$tco_done=true;return Data_Maybe.Just.create(new Data_Tuple.Tuple(new Data_Tuple.Tuple(v.value0.value1,v.value0.value2),new Data_List_Types.Cons(v.value0.value0,new Data_List_Types.Cons(v.value0.value3,v.value1))))};if(v.value0 instanceof Three){$tco_done=true;return Data_Maybe.Just.create(new Data_Tuple.Tuple(new Data_Tuple.Tuple(v.value0.value1,v.value0.value2),new Data_List_Types.Cons(singleton(v.value0.value4)(v.value0.value5),new Data_List_Types.Cons(v.value0.value0,new Data_List_Types.Cons(v.value0.value3,new Data_List_Types.Cons(v.value0.value6,v.value1))))))};throw new Error("Failed pattern match at Data.Map.Internal (line 598, column 18 - line 603, column 77): "+[v.value0.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 597, column 3 - line 597, column 19): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result};return Data_Unfoldable.unfoldr(dictUnfoldable)(go)(new Data_List_Types.Cons(m,Data_List_Types.Nil.value))}},lookup=function(dictOrd){return function(k){var comp=Data_Ord.compare(dictOrd),go=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Leaf){$tco_done=true;return Data_Maybe.Nothing.value};if(v instanceof Two){var v2=comp(k)(v.value1);if(v2 instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(v.value2)};if(v2 instanceof Data_Ordering.LT){$copy_v=v.value0;return};$copy_v=v.value3;return};if(v instanceof Three){var v3=comp(k)(v.value1);if(v3 instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(v.value2)};var v4=comp(k)(v.value4);if(v4 instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(v.value5)};if(v3 instanceof Data_Ordering.LT){$copy_v=v.value0;return};if(v4 instanceof Data_Ordering.GT){$copy_v=v.value6;return};$copy_v=v.value3;return};throw new Error("Failed pattern match at Data.Map.Internal (line 200, column 5 - line 200, column 22): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result};return go}},keys=function(v){if(v instanceof Leaf)return Data_List_Types.Nil.value;if(v instanceof Two)return Data_Semigroup.append(Data_List_Types.semigroupList)(keys(v.value0))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value1))(keys(v.value3)));if(v instanceof Three)return Data_Semigroup.append(Data_List_Types.semigroupList)(keys(v.value0))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value1))(Data_Semigroup.append(Data_List_Types.semigroupList)(keys(v.value3))(Data_Semigroup.append(Data_List_Types.semigroupList)(Control_Applicative.pure(Data_List_Types.applicativeList)(v.value4))(keys(v.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 606, column 1 - line 606, column 38): "+[v.constructor.name])},isEmpty=function(v){if(v instanceof Leaf)return true;return false},fromZipper=function($copy_dictOrd){return function($copy_v){return function($copy_tree){var $tco_var_dictOrd=$copy_dictOrd,$tco_var_v=$copy_v,$tco_done=false,$tco_result;function $tco_loop(dictOrd,v,tree){if(v instanceof Data_List_Types.Nil){$tco_done=true;return tree};if(v instanceof Data_List_Types.Cons){if(v.value0 instanceof TwoLeft){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Two(tree,v.value0.value0,v.value0.value1,v.value0.value2);return};if(v.value0 instanceof TwoRight){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Two(v.value0.value0,v.value0.value1,v.value0.value2,tree);return};if(v.value0 instanceof ThreeLeft){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Three(tree,v.value0.value0,v.value0.value1,v.value0.value2,v.value0.value3,v.value0.value4,v.value0.value5);return};if(v.value0 instanceof ThreeMiddle){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Three(v.value0.value0,v.value0.value1,v.value0.value2,tree,v.value0.value3,v.value0.value4,v.value0.value5);return};if(v.value0 instanceof ThreeRight){$tco_var_dictOrd=dictOrd;$tco_var_v=v.value1;$copy_tree=new Three(v.value0.value0,v.value0.value1,v.value0.value2,v.value0.value3,v.value0.value4,v.value0.value5,tree);return};throw new Error("Failed pattern match at Data.Map.Internal (line 418, column 3 - line 423, column 88): "+[v.value0.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 415, column 1 - line 415, column 80): "+[v.constructor.name,tree.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_dictOrd,$tco_var_v,$copy_tree);return $tco_result}}},insert=function(dictOrd){return function(k){return function(v){var up=function($copy_v1){return function($copy_v2){var $tco_var_v1=$copy_v1,$tco_done=false,$tco_result;function $tco_loop(v1,v2){if(v1 instanceof Data_List_Types.Nil){$tco_done=true;return new Two(v2.value0,v2.value1,v2.value2,v2.value3)};if(v1 instanceof Data_List_Types.Cons){if(v1.value0 instanceof TwoLeft){$tco_done=true;return fromZipper(dictOrd)(v1.value1)(new Three(v2.value0,v2.value1,v2.value2,v2.value3,v1.value0.value0,v1.value0.value1,v1.value0.value2))};if(v1.value0 instanceof TwoRight){$tco_done=true;return fromZipper(dictOrd)(v1.value1)(new Three(v1.value0.value0,v1.value0.value1,v1.value0.value2,v2.value0,v2.value1,v2.value2,v2.value3))};if(v1.value0 instanceof ThreeLeft){$tco_var_v1=v1.value1;$copy_v2=new KickUp(new Two(v2.value0,v2.value1,v2.value2,v2.value3),v1.value0.value0,v1.value0.value1,new Two(v1.value0.value2,v1.value0.value3,v1.value0.value4,v1.value0.value5));return};if(v1.value0 instanceof ThreeMiddle){$tco_var_v1=v1.value1;$copy_v2=new KickUp(new Two(v1.value0.value0,v1.value0.value1,v1.value0.value2,v2.value0),v2.value1,v2.value2,new Two(v2.value3,v1.value0.value3,v1.value0.value4,v1.value0.value5));return};if(v1.value0 instanceof ThreeRight){$tco_var_v1=v1.value1;$copy_v2=new KickUp(new Two(v1.value0.value0,v1.value0.value1,v1.value0.value2,v1.value0.value3),v1.value0.value4,v1.value0.value5,new Two(v2.value0,v2.value1,v2.value2,v2.value3));return};throw new Error("Failed pattern match at Data.Map.Internal (line 454, column 5 - line 459, column 108): "+[v1.value0.constructor.name,v2.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 451, column 3 - line 451, column 56): "+[v1.constructor.name,v2.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_v1,$copy_v2);return $tco_result}},comp=Data_Ord.compare(dictOrd),down=function($copy_ctx){return function($copy_v1){var $tco_var_ctx=$copy_ctx,$tco_done=false,$tco_result;function $tco_loop(ctx,v1){if(v1 instanceof Leaf){$tco_done=true;return up(ctx)(new KickUp(Leaf.value,k,v,Leaf.value))};if(v1 instanceof Two){var v2=comp(k)(v1.value1);if(v2 instanceof Data_Ordering.EQ){$tco_done=true;return fromZipper(dictOrd)(ctx)(new Two(v1.value0,k,v,v1.value3))};if(v2 instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new TwoLeft(v1.value1,v1.value2,v1.value3),ctx);$copy_v1=v1.value0;return};$tco_var_ctx=new Data_List_Types.Cons(new TwoRight(v1.value0,v1.value1,v1.value2),ctx);$copy_v1=v1.value3;return};if(v1 instanceof Three){var v3=comp(k)(v1.value1);if(v3 instanceof Data_Ordering.EQ){$tco_done=true;return fromZipper(dictOrd)(ctx)(new Three(v1.value0,k,v,v1.value3,v1.value4,v1.value5,v1.value6))};var v4=comp(k)(v1.value4);if(v4 instanceof Data_Ordering.EQ){$tco_done=true;return fromZipper(dictOrd)(ctx)(new Three(v1.value0,v1.value1,v1.value2,v1.value3,k,v,v1.value6))};if(v3 instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new ThreeLeft(v1.value1,v1.value2,v1.value3,v1.value4,v1.value5,v1.value6),ctx);$copy_v1=v1.value0;return};if(v3 instanceof Data_Ordering.GT&&v4 instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new ThreeMiddle(v1.value0,v1.value1,v1.value2,v1.value4,v1.value5,v1.value6),ctx);$copy_v1=v1.value3;return};$tco_var_ctx=new Data_List_Types.Cons(new ThreeRight(v1.value0,v1.value1,v1.value2,v1.value3,v1.value4,v1.value5),ctx);$copy_v1=v1.value6;return};throw new Error("Failed pattern match at Data.Map.Internal (line 434, column 3 - line 434, column 55): "+[ctx.constructor.name,v1.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_ctx,$copy_v1);return $tco_result}};return down(Data_List_Types.Nil.value)}}},pop=function(dictOrd){return function(k){var up=function($copy_ctxs){return function($copy_tree){var $tco_var_ctxs=$copy_ctxs,$tco_done=false,$tco_result;function $tco_loop(ctxs,tree){if(ctxs instanceof Data_List_Types.Nil){$tco_done=true;return tree};if(ctxs instanceof Data_List_Types.Cons){if(ctxs.value0 instanceof TwoLeft&&(ctxs.value0.value2 instanceof Leaf&&tree instanceof Leaf)){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(Leaf.value,ctxs.value0.value0,ctxs.value0.value1,Leaf.value))};if(ctxs.value0 instanceof TwoRight&&(ctxs.value0.value0 instanceof Leaf&&tree instanceof Leaf)){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(Leaf.value,ctxs.value0.value1,ctxs.value0.value2,Leaf.value))};if(ctxs.value0 instanceof TwoLeft&&ctxs.value0.value2 instanceof Two){$tco_var_ctxs=ctxs.value1;$copy_tree=new Three(tree,ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2.value0,ctxs.value0.value2.value1,ctxs.value0.value2.value2,ctxs.value0.value2.value3);return};if(ctxs.value0 instanceof TwoRight&&ctxs.value0.value0 instanceof Two){$tco_var_ctxs=ctxs.value1;$copy_tree=new Three(ctxs.value0.value0.value0,ctxs.value0.value0.value1,ctxs.value0.value0.value2,ctxs.value0.value0.value3,ctxs.value0.value1,ctxs.value0.value2,tree);return};if(ctxs.value0 instanceof TwoLeft&&ctxs.value0.value2 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(new Two(tree,ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2.value0),ctxs.value0.value2.value1,ctxs.value0.value2.value2,new Two(ctxs.value0.value2.value3,ctxs.value0.value2.value4,ctxs.value0.value2.value5,ctxs.value0.value2.value6)))};if(ctxs.value0 instanceof TwoRight&&ctxs.value0.value0 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(new Two(ctxs.value0.value0.value0,ctxs.value0.value0.value1,ctxs.value0.value0.value2,ctxs.value0.value0.value3),ctxs.value0.value0.value4,ctxs.value0.value0.value5,new Two(ctxs.value0.value0.value6,ctxs.value0.value1,ctxs.value0.value2,tree)))};if(ctxs.value0 instanceof ThreeLeft&&(ctxs.value0.value2 instanceof Leaf&&(ctxs.value0.value5 instanceof Leaf&&tree instanceof Leaf))){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(Leaf.value,ctxs.value0.value0,ctxs.value0.value1,Leaf.value,ctxs.value0.value3,ctxs.value0.value4,Leaf.value))};if(ctxs.value0 instanceof ThreeMiddle&&(ctxs.value0.value0 instanceof Leaf&&(ctxs.value0.value5 instanceof Leaf&&tree instanceof Leaf))){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(Leaf.value,ctxs.value0.value1,ctxs.value0.value2,Leaf.value,ctxs.value0.value3,ctxs.value0.value4,Leaf.value))};if(ctxs.value0 instanceof ThreeRight&&(ctxs.value0.value0 instanceof Leaf&&(ctxs.value0.value3 instanceof Leaf&&tree instanceof Leaf))){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(Leaf.value,ctxs.value0.value1,ctxs.value0.value2,Leaf.value,ctxs.value0.value4,ctxs.value0.value5,Leaf.value))};if(ctxs.value0 instanceof ThreeLeft&&ctxs.value0.value2 instanceof Two){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(new Three(tree,ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2.value0,ctxs.value0.value2.value1,ctxs.value0.value2.value2,ctxs.value0.value2.value3),ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5))};if(ctxs.value0 instanceof ThreeMiddle&&ctxs.value0.value0 instanceof Two){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(new Three(ctxs.value0.value0.value0,ctxs.value0.value0.value1,ctxs.value0.value0.value2,ctxs.value0.value0.value3,ctxs.value0.value1,ctxs.value0.value2,tree),ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5))};if(ctxs.value0 instanceof ThreeMiddle&&ctxs.value0.value5 instanceof Two){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2,new Three(tree,ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5.value0,ctxs.value0.value5.value1,ctxs.value0.value5.value2,ctxs.value0.value5.value3)))};if(ctxs.value0 instanceof ThreeRight&&ctxs.value0.value3 instanceof Two){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Two(ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2,new Three(ctxs.value0.value3.value0,ctxs.value0.value3.value1,ctxs.value0.value3.value2,ctxs.value0.value3.value3,ctxs.value0.value4,ctxs.value0.value5,tree)))};if(ctxs.value0 instanceof ThreeLeft&&ctxs.value0.value2 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(new Two(tree,ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2.value0),ctxs.value0.value2.value1,ctxs.value0.value2.value2,new Two(ctxs.value0.value2.value3,ctxs.value0.value2.value4,ctxs.value0.value2.value5,ctxs.value0.value2.value6),ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5))};if(ctxs.value0 instanceof ThreeMiddle&&ctxs.value0.value0 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(new Two(ctxs.value0.value0.value0,ctxs.value0.value0.value1,ctxs.value0.value0.value2,ctxs.value0.value0.value3),ctxs.value0.value0.value4,ctxs.value0.value0.value5,new Two(ctxs.value0.value0.value6,ctxs.value0.value1,ctxs.value0.value2,tree),ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5))};if(ctxs.value0 instanceof ThreeMiddle&&ctxs.value0.value5 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2,new Two(tree,ctxs.value0.value3,ctxs.value0.value4,ctxs.value0.value5.value0),ctxs.value0.value5.value1,ctxs.value0.value5.value2,new Two(ctxs.value0.value5.value3,ctxs.value0.value5.value4,ctxs.value0.value5.value5,ctxs.value0.value5.value6)))};if(ctxs.value0 instanceof ThreeRight&&ctxs.value0.value3 instanceof Three){$tco_done=true;return fromZipper(dictOrd)(ctxs.value1)(new Three(ctxs.value0.value0,ctxs.value0.value1,ctxs.value0.value2,new Two(ctxs.value0.value3.value0,ctxs.value0.value3.value1,ctxs.value0.value3.value2,ctxs.value0.value3.value3),ctxs.value0.value3.value4,ctxs.value0.value3.value5,new Two(ctxs.value0.value3.value6,ctxs.value0.value4,ctxs.value0.value5,tree)))};throw new Error("Failed pattern match at Data.Map.Internal (line 511, column 9 - line 528, column 136): "+[ctxs.value0.constructor.name,tree.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 508, column 5 - line 528, column 136): "+[ctxs.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_ctxs,$copy_tree);return $tco_result}},removeMaxNode=function($copy_ctx){return function($copy_m){var $tco_var_ctx=$copy_ctx,$tco_done=false,$tco_result;function $tco_loop(ctx,m){if(m instanceof Two&&(m.value0 instanceof Leaf&&m.value3 instanceof Leaf)){$tco_done=true;return up(ctx)(Leaf.value)};if(m instanceof Two){$tco_var_ctx=new Data_List_Types.Cons(new TwoRight(m.value0,m.value1,m.value2),ctx);$copy_m=m.value3;return};if(m instanceof Three&&(m.value0 instanceof Leaf&&(m.value3 instanceof Leaf&&m.value6 instanceof Leaf))){$tco_done=true;return up(new Data_List_Types.Cons(new TwoRight(Leaf.value,m.value1,m.value2),ctx))(Leaf.value)};if(m instanceof Three){$tco_var_ctx=new Data_List_Types.Cons(new ThreeRight(m.value0,m.value1,m.value2,m.value3,m.value4,m.value5),ctx);$copy_m=m.value6;return};throw new Error("Failed pattern match at Data.Map.Internal (line 540, column 5 - line 544, column 107): "+[m.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_ctx,$copy_m);return $tco_result}},maxNode=function($copy_m){var $tco_done=false,$tco_result;function $tco_loop(m){if(m instanceof Two&&m.value3 instanceof Leaf){$tco_done=true;return{key:m.value1,value:m.value2}};if(m instanceof Two){$copy_m=m.value3;return};if(m instanceof Three&&m.value6 instanceof Leaf){$tco_done=true;return{key:m.value4,value:m.value5}};if(m instanceof Three){$copy_m=m.value6;return};throw new Error("Failed pattern match at Data.Map.Internal (line 531, column 33 - line 535, column 45): "+[m.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_m);return $tco_result},comp=Data_Ord.compare(dictOrd),down=function($copy_ctx){return function($copy_m){var $tco_var_ctx=$copy_ctx,$tco_done=false,$tco_result;function $tco_loop(ctx,m){if(m instanceof Leaf){$tco_done=true;return Data_Maybe.Nothing.value};if(m instanceof Two){var v=comp(k)(m.value1);if(m.value3 instanceof Leaf&&v instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value2,up(ctx)(Leaf.value)))};if(v instanceof Data_Ordering.EQ){var max=maxNode(m.value0);$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value2,removeMaxNode(new Data_List_Types.Cons(new TwoLeft(max.key,max.value,m.value3),ctx))(m.value0)))};if(v instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new TwoLeft(m.value1,m.value2,m.value3),ctx);$copy_m=m.value0;return};$tco_var_ctx=new Data_List_Types.Cons(new TwoRight(m.value0,m.value1,m.value2),ctx);$copy_m=m.value3;return};if(m instanceof Three){var leaves=(function(){if(m.value0 instanceof Leaf&&(m.value3 instanceof Leaf&&m.value6 instanceof Leaf))return true;return false})(),v=comp(k)(m.value4),v3=comp(k)(m.value1);if(leaves&&v3 instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value2,fromZipper(dictOrd)(ctx)(new Two(Leaf.value,m.value4,m.value5,Leaf.value))))};if(leaves&&v instanceof Data_Ordering.EQ){$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value5,fromZipper(dictOrd)(ctx)(new Two(Leaf.value,m.value1,m.value2,Leaf.value))))};if(v3 instanceof Data_Ordering.EQ){var max=maxNode(m.value0);$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value2,removeMaxNode(new Data_List_Types.Cons(new ThreeLeft(max.key,max.value,m.value3,m.value4,m.value5,m.value6),ctx))(m.value0)))};if(v instanceof Data_Ordering.EQ){var max=maxNode(m.value3);$tco_done=true;return new Data_Maybe.Just(new Data_Tuple.Tuple(m.value5,removeMaxNode(new Data_List_Types.Cons(new ThreeMiddle(m.value0,m.value1,m.value2,max.key,max.value,m.value6),ctx))(m.value3)))};if(v3 instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new ThreeLeft(m.value1,m.value2,m.value3,m.value4,m.value5,m.value6),ctx);$copy_m=m.value0;return};if(v3 instanceof Data_Ordering.GT&&v instanceof Data_Ordering.LT){$tco_var_ctx=new Data_List_Types.Cons(new ThreeMiddle(m.value0,m.value1,m.value2,m.value4,m.value5,m.value6),ctx);$copy_m=m.value3;return};$tco_var_ctx=new Data_List_Types.Cons(new ThreeRight(m.value0,m.value1,m.value2,m.value3,m.value4,m.value5),ctx);$copy_m=m.value6;return};throw new Error("Failed pattern match at Data.Map.Internal (line 481, column 34 - line 504, column 80): "+[m.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_ctx,$copy_m);return $tco_result}};return down(Data_List_Types.Nil.value)}},foldableMap=new Data_Foldable.Foldable(function(dictMonoid){return function(f){return function(m){return Data_Foldable.foldMap(Data_List_Types.foldableList)(dictMonoid)(f)(values(m))}}},function(f){return function(z){return function(m){return Data_Foldable.foldl(Data_List_Types.foldableList)(f)(z)(values(m))}}},function(f){return function(z){return function(m){return Data_Foldable.foldr(Data_List_Types.foldableList)(f)(z)(values(m))}}}),eqMap=function(dictEq){return function(dictEq1){return new Data_Eq.Eq(function(m1){return function(m2){return Data_Eq.eq(Data_Eq.eqArray(Data_Tuple.eqTuple(dictEq)(dictEq1)))(toAscArray(m1))(toAscArray(m2))}})}},empty=Leaf.value,fromFoldable=function(dictOrd){return function(dictFoldable){return Data_Foldable.foldl(dictFoldable)(function(m){return function(v){return insert(dictOrd)(v.value0)(v.value1)(m)}})(empty)}},$$delete=function(dictOrd){return function(k){return function(m){return Data_Maybe.maybe(m)(Data_Tuple.snd)(pop(dictOrd)(k)(m))}}},asList=Control_Category.identity(Control_Category.categoryFn),foldableWithIndexMap=new Data_FoldableWithIndex.FoldableWithIndex(function(){return foldableMap},function(dictMonoid){return function(f){return function(m){return Data_Foldable.foldMap(Data_List_Types.foldableList)(dictMonoid)(Data_Tuple.uncurry(f))(asList(toUnfoldable(Data_List_Types.unfoldableList)(m)))}}},function(f){return function(z){return function(m){return Data_Foldable.foldl(Data_List_Types.foldableList)((function(){var $763=Data_Function.flip(f);return function($764){return Data_Tuple.uncurry($763($764))}})())(z)(asList(toUnfoldable(Data_List_Types.unfoldableList)(m)))}}},function(f){return function(z){return function(m){return Data_Foldable.foldr(Data_List_Types.foldableList)(Data_Tuple.uncurry(f))(z)(asList(toUnfoldable(Data_List_Types.unfoldableList)(m)))}}}),mapMaybeWithKey=function(dictOrd){return function(f){return Data_FoldableWithIndex.foldrWithIndex(foldableWithIndexMap)(function(k){return function(a){return function(acc){return Data_Maybe.maybe(acc)(function(b){return insert(dictOrd)(k)(b)(acc)})(f(k)(a))}}})(empty)}},mapMaybe=function(dictOrd){var $765=mapMaybeWithKey(dictOrd);return function($766){return $765(Data_Function["const"]($766))}},alter=function(dictOrd){return function(f){return function(k){return function(m){var v=f(lookup(dictOrd)(k)(m));if(v instanceof Data_Maybe.Nothing)return $$delete(dictOrd)(k)(m);if(v instanceof Data_Maybe.Just)return insert(dictOrd)(k)(v.value0)(m);throw new Error("Failed pattern match at Data.Map.Internal (line 549, column 15 - line 551, column 25): "+[v.constructor.name])}}}},unionWith=function(dictOrd){return function(f){return function(m1){return function(m2){var go=function(m){return function(v){return alter(dictOrd)((function(){var $769=Data_Maybe.maybe(v.value1)(f(v.value1));return function($770){return Data_Maybe.Just.create($769($770))}})())(v.value0)(m)}};return Data_Foldable.foldl(Data_List_Types.foldableList)(go)(m2)(toUnfoldable(Data_List_Types.unfoldableList)(m1))}}}};exports["empty"]=empty;exports["isEmpty"]=isEmpty;exports["singleton"]=singleton;exports["insert"]=insert;exports["lookup"]=lookup;exports["fromFoldable"]=fromFoldable;exports["toUnfoldableUnordered"]=toUnfoldableUnordered;exports["keys"]=keys;exports["unionWith"]=unionWith;exports["mapMaybe"]=mapMaybe;exports["eqMap"]=eqMap;exports["foldableMap"]=foldableMap})(PS);(function($PS){"use strict";$PS["Data.Monoid.Additive"]=$PS["Data.Monoid.Additive"]||{};var exports=$PS["Data.Monoid.Additive"],Data_Semigroup=$PS["Data.Semigroup"],Data_Semiring=$PS["Data.Semiring"],Additive=function(x){return x},semigroupAdditive=function(dictSemiring){return new Data_Semigroup.Semigroup(function(v){return function(v1){return Data_Semiring.add(dictSemiring)(v)(v1)}})};exports["Additive"]=Additive;exports["semigroupAdditive"]=semigroupAdditive})(PS);(function(exports){"use strict";exports["null"]=null;exports.notNull=function(x){return x}})(PS["Data.Nullable"]=PS["Data.Nullable"]||{});(function($PS){"use strict";$PS["Data.Nullable"]=$PS["Data.Nullable"]||{};var exports=$PS["Data.Nullable"],$foreign=$PS["Data.Nullable"],Data_Maybe=$PS["Data.Maybe"],toNullable=Data_Maybe.maybe($foreign["null"])($foreign.notNull);exports["toNullable"]=toNullable;exports["null"]=$foreign["null"];exports["notNull"]=$foreign.notNull})(PS);(function($PS){"use strict";$PS["Data.Set"]=$PS["Data.Set"]||{};var exports=$PS["Data.Set"],Data_Eq=$PS["Data.Eq"],Data_Foldable=$PS["Data.Foldable"],Data_List_Types=$PS["Data.List.Types"],Data_Map_Internal=$PS["Data.Map.Internal"],Data_Ord=$PS["Data.Ord"],Data_Unit=$PS["Data.Unit"],toList=function(v){return Data_Map_Internal.keys(v)},singleton=function(a){return Data_Map_Internal.singleton(a)(Data_Unit.unit)},isEmpty=function(v){return Data_Map_Internal.isEmpty(v)},insert=function(dictOrd){return function(a){return function(v){return Data_Map_Internal.insert(dictOrd)(a)(Data_Unit.unit)(v)}}},foldableSet=new Data_Foldable.Foldable(function(dictMonoid){return function(f){var $65=Data_Foldable.foldMap(Data_List_Types.foldableList)(dictMonoid)(f);return function($66){return $65(toList($66))}}},function(f){return function(x){var $67=Data_Foldable.foldl(Data_List_Types.foldableList)(f)(x);return function($68){return $67(toList($68))}}},function(f){return function(x){var $69=Data_Foldable.foldr(Data_List_Types.foldableList)(f)(x);return function($70){return $69(toList($70))}}}),eqSet=function(dictEq){return new Data_Eq.Eq(function(v){return function(v1){return Data_Eq.eq(Data_Map_Internal.eqMap(dictEq)(Data_Eq.eqUnit))(v)(v1)}})},ordSet=function(dictOrd){return new Data_Ord.Ord(function(){return eqSet(dictOrd.Eq0())},function(s1){return function(s2){return Data_Ord.compare(Data_List_Types.ordList(dictOrd))(toList(s1))(toList(s2))}})},empty=Data_Map_Internal.empty,fromFoldable=function(dictFoldable){return function(dictOrd){return Data_Foldable.foldl(dictFoldable)(function(m){return function(a){return insert(dictOrd)(a)(m)}})(empty)}};exports["fromFoldable"]=fromFoldable;exports["isEmpty"]=isEmpty;exports["singleton"]=singleton;exports["ordSet"]=ordSet;exports["foldableSet"]=foldableSet})(PS);(function($PS){"use strict";$PS["Data.Set.NonEmpty"]=$PS["Data.Set.NonEmpty"]||{};var exports=$PS["Data.Set.NonEmpty"],Data_Maybe=$PS["Data.Maybe"],Data_Set=$PS["Data.Set"],singleton=function(a){return Data_Set.singleton(a)},ordNonEmptySet=function(dictOrd){return Data_Set.ordSet(dictOrd)},fromSet=function(s){var $77=Data_Set.isEmpty(s);if($77)return Data_Maybe.Nothing.value;return new Data_Maybe.Just(s)},fromFoldable=function(dictFoldable){return function(dictOrd){var $86=Data_Set.fromFoldable(dictFoldable)(dictOrd);return function($87){return fromSet($86($87))}}},foldableNonEmptySet=Data_Set.foldableSet;exports["singleton"]=singleton;exports["fromFoldable"]=fromFoldable;exports["ordNonEmptySet"]=ordNonEmptySet;exports["foldableNonEmptySet"]=foldableNonEmptySet})(PS);(function($PS){"use strict";$PS["Data.Time.Duration"]=$PS["Data.Time.Duration"]||{};var exports=$PS["Data.Time.Duration"],Data_Newtype=$PS["Data.Newtype"],Milliseconds=function(x){return x},newtypeMilliseconds=new Data_Newtype.Newtype(function(n){return n},Milliseconds);exports["newtypeMilliseconds"]=newtypeMilliseconds})(PS);(function(exports){"use strict";exports.traverseArrayImpl=function(){function array1(a){return[a]}
function array2(a){return function(b){return[a,b]}}
function array3(a){return function(b){return function(c){return[a,b,c]}}}
function concat2(xs){return function(ys){return xs.concat(ys)}};return function(apply){return function(map){return function(pure){return function(f){return function(array){function go(bot,top){switch(top-bot){case 0:return pure([]);case 1:return map(array1)(f(array[bot]));case 2:return apply(map(array2)(f(array[bot])))(f(array[bot+1]));case 3:return apply(apply(map(array3)(f(array[bot])))(f(array[bot+1])))(f(array[bot+2]));default:var pivot=bot+Math.floor((top-bot)/4)*2;return apply(map(concat2)(go(bot,pivot)))(go(pivot,top))}};return go(0,array.length)}}}}}}()})(PS["Data.Traversable"]=PS["Data.Traversable"]||{});(function($PS){"use strict";$PS["Data.Traversable"]=$PS["Data.Traversable"]||{};var exports=$PS["Data.Traversable"],$foreign=$PS["Data.Traversable"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Category=$PS["Control.Category"],Data_Foldable=$PS["Data.Foldable"],Data_Functor=$PS["Data.Functor"],Traversable=function(Foldable1,Functor0,sequence,traverse){this.Foldable1=Foldable1;this.Functor0=Functor0;this.sequence=sequence;this.traverse=traverse},traverse=function(dict){return dict.traverse},sequenceDefault=function(dictTraversable){return function(dictApplicative){return traverse(dictTraversable)(dictApplicative)(Control_Category.identity(Control_Category.categoryFn))}},traversableArray=new Traversable(function(){return Data_Foldable.foldableArray},function(){return Data_Functor.functorArray},function(dictApplicative){return sequenceDefault(traversableArray)(dictApplicative)},function(dictApplicative){return $foreign.traverseArrayImpl(Control_Apply.apply(dictApplicative.Apply0()))(Data_Functor.map((dictApplicative.Apply0()).Functor0()))(Control_Applicative.pure(dictApplicative))});exports["Traversable"]=Traversable;exports["traverse"]=traverse;exports["sequenceDefault"]=sequenceDefault;exports["traversableArray"]=traversableArray})(PS);(function(exports){"use strict";exports.pureE=function(a){return function(){return a}};exports.bindE=function(a){return function(f){return function(){return f(a())()}}}})(PS["Effect"]=PS["Effect"]||{});(function($PS){"use strict";$PS["Effect"]=$PS["Effect"]||{};var exports=$PS["Effect"],$foreign=$PS["Effect"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Control_Monad=$PS["Control.Monad"],Data_Functor=$PS["Data.Functor"],monadEffect=new Control_Monad.Monad(function(){return applicativeEffect},function(){return bindEffect}),bindEffect=new Control_Bind.Bind(function(){return applyEffect},$foreign.bindE),applyEffect=new Control_Apply.Apply(function(){return functorEffect},Control_Monad.ap(monadEffect)),applicativeEffect=new Control_Applicative.Applicative(function(){return applyEffect},$foreign.pureE),functorEffect=new Data_Functor.Functor(Control_Applicative.liftA1(applicativeEffect));exports["functorEffect"]=functorEffect;exports["applicativeEffect"]=applicativeEffect;exports["bindEffect"]=bindEffect;exports["monadEffect"]=monadEffect})(PS);(function(exports){"use strict";var Aff=function(){var EMPTY={},PURE="Pure",THROW="Throw",CATCH="Catch",SYNC="Sync",ASYNC="Async",BIND="Bind",BRACKET="Bracket",FORK="Fork",SEQ="Sequential",MAP="Map",APPLY="Apply",ALT="Alt",CONS="Cons",RESUME="Resume",RELEASE="Release",FINALIZER="Finalizer",FINALIZED="Finalized",FORKED="Forked",FIBER="Fiber",THUNK="Thunk";function Aff(tag,_1,_2,_3){this.tag=tag;this._1=_1;this._2=_2;this._3=_3}
function AffCtr(tag){var fn=function(_1,_2,_3){return new Aff(tag,_1,_2,_3)};fn.tag=tag;return fn}
function nonCanceler(error){return new Aff(PURE,void 0)}
function runEff(eff){try{eff()}catch(error){setTimeout(function(){throw error},0)}}
function runSync(left,right,eff){try{return right(eff())}catch(error){return left(error)}}
function runAsync(left,eff,k){try{return eff(k)()}catch(error){k(left(error))();return nonCanceler}};var Scheduler=function(){var limit=1024,size=0,ix=0,queue=new Array(limit),draining=false;function drain(){var thunk;draining=true;while(size!==0){size--;thunk=queue[ix];queue[ix]=void 0;ix=(ix+1)%limit;thunk()};draining=false};return{isDraining:function(){return draining},enqueue:function(cb){var i,tmp;if(size===limit){tmp=draining;drain();draining=tmp};queue[(ix+size)%limit]=cb;size++;if(!draining)drain()}}}();function Supervisor(util){var fibers={},fiberId=0,count=0;return{register:function(fiber){var fid=fiberId++;fiber.onComplete({rethrow:true,handler:function(result){return function(){count--;delete fibers[fid]}}})();fibers[fid]=fiber;count++},isEmpty:function(){return count===0},killAll:function(killError,cb){return function(){if(count===0)return cb();var killCount=0,kills={};function kill(fid){kills[fid]=fibers[fid].kill(killError,function(result){return function(){delete kills[fid];killCount--;if(util.isLeft(result)&&util.fromLeft(result))setTimeout(function(){throw util.fromLeft(result)},0);if(killCount===0)cb()}})()};for(var k in fibers)if(fibers.hasOwnProperty(k)){killCount++;kill(k)};fibers={};fiberId=0;count=0;return function(error){return new Aff(SYNC,function(){for(var k in kills)if(kills.hasOwnProperty(k))kills[k]()})}}}}};var SUSPENDED=0,CONTINUE=1,STEP_BIND=2,STEP_RESULT=3,PENDING=4,RETURN=5,COMPLETED=6;function Fiber(util,supervisor,aff){var runTick=0,status=SUSPENDED,step=aff,fail=null,interrupt=null,bhead=null,btail=null,attempts=null,bracketCount=0,joinId=0,joins=null,rethrow=true;function run(localRunTick){var tmp,result,attempt;while(true){tmp=null;result=null;attempt=null;switch(status){case STEP_BIND:status=CONTINUE;try{step=bhead(step);if(btail===null){bhead=null}else{bhead=btail._1;btail=btail._2}}catch(e){status=RETURN;fail=util.left(e);step=null}break;case STEP_RESULT:if(util.isLeft(step)){status=RETURN;fail=step;step=null}else if(bhead===null){status=RETURN}else{status=STEP_BIND;step=util.fromRight(step)};break;case CONTINUE:switch(step.tag){case BIND:if(bhead)btail=new Aff(CONS,bhead,btail);bhead=step._2;status=CONTINUE;step=step._1;break;case PURE:if(bhead===null){status=RETURN;step=util.right(step._1)}else{status=STEP_BIND;step=step._1};break;case SYNC:status=STEP_RESULT;step=runSync(util.left,util.right,step._1);break;case ASYNC:status=PENDING;step=runAsync(util.left,step._1,function(result){return function(){if(runTick!==localRunTick)return;runTick++;Scheduler.enqueue(function(){if(runTick!==localRunTick+1)return;status=STEP_RESULT;step=result;run(runTick)})}});return;case THROW:status=RETURN;fail=util.left(step._1);step=null;break;case CATCH:if(bhead===null){attempts=new Aff(CONS,step,attempts,interrupt)}else attempts=new Aff(CONS,step,new Aff(CONS,new Aff(RESUME,bhead,btail),attempts,interrupt),interrupt);bhead=null;btail=null;status=CONTINUE;step=step._1;break;case BRACKET:bracketCount++;if(bhead===null){attempts=new Aff(CONS,step,attempts,interrupt)}else attempts=new Aff(CONS,step,new Aff(CONS,new Aff(RESUME,bhead,btail),attempts,interrupt),interrupt);bhead=null;btail=null;status=CONTINUE;step=step._1;break;case FORK:status=STEP_RESULT;tmp=Fiber(util,supervisor,step._2);if(supervisor)supervisor.register(tmp);if(step._1)tmp.run();step=util.right(tmp);break;case SEQ:status=CONTINUE;step=sequential(util,supervisor,step._1);break};break;case RETURN:bhead=null;btail=null;if(attempts===null){status=COMPLETED;step=interrupt||fail||step}else{tmp=attempts._3;attempt=attempts._1;attempts=attempts._2;switch(attempt.tag){case CATCH:if(interrupt&&interrupt!==tmp&&bracketCount===0){status=RETURN}else if(fail){status=CONTINUE;step=attempt._2(util.fromLeft(fail));fail=null};break;case RESUME:if(interrupt&&interrupt!==tmp&&bracketCount===0||fail){status=RETURN}else{bhead=attempt._1;btail=attempt._2;status=STEP_BIND;step=util.fromRight(step)};break;case BRACKET:bracketCount--;if(fail===null){result=util.fromRight(step);attempts=new Aff(CONS,new Aff(RELEASE,attempt._2,result),attempts,tmp);if(interrupt===tmp||bracketCount>0){status=CONTINUE;step=attempt._3(result)}};break;case RELEASE:attempts=new Aff(CONS,new Aff(FINALIZED,step,fail),attempts,interrupt);status=CONTINUE;if(interrupt&&interrupt!==tmp&&bracketCount===0){step=attempt._1.killed(util.fromLeft(interrupt))(attempt._2)}else if(fail){step=attempt._1.failed(util.fromLeft(fail))(attempt._2)}else step=attempt._1.completed(util.fromRight(step))(attempt._2);fail=null;bracketCount++;break;case FINALIZER:bracketCount++;attempts=new Aff(CONS,new Aff(FINALIZED,step,fail),attempts,interrupt);status=CONTINUE;step=attempt._1;break;case FINALIZED:bracketCount--;status=RETURN;step=attempt._1;fail=attempt._2;break}};break;case COMPLETED:for(var k in joins)if(joins.hasOwnProperty(k)){rethrow=rethrow&&joins[k].rethrow;runEff(joins[k].handler(step))};joins=null;if(interrupt&&fail){setTimeout(function(){throw util.fromLeft(fail)},0)}else if(util.isLeft(step)&&rethrow)setTimeout(function(){if(rethrow)throw util.fromLeft(step)},0);return;case SUSPENDED:status=CONTINUE;break;case PENDING:return}}}
function onComplete(join){return function(){if(status===COMPLETED){rethrow=rethrow&&join.rethrow;join.handler(step)();return function(){}};var jid=joinId++;joins=joins||{};joins[jid]=join;return function(){if(joins!==null)delete joins[jid]}}}
function kill(error,cb){return function(){if(status===COMPLETED){cb(util.right(void 0))();return function(){}};var canceler=onComplete({rethrow:false,handler:function(){return cb(util.right(void 0))}})();switch(status){case SUSPENDED:interrupt=util.left(error);status=COMPLETED;step=interrupt;run(runTick);break;case PENDING:if(interrupt===null)interrupt=util.left(error);if(bracketCount===0){if(status===PENDING)attempts=new Aff(CONS,new Aff(FINALIZER,step(error)),attempts,interrupt);status=RETURN;step=null;fail=null;run(++runTick)};break;default:if(interrupt===null)interrupt=util.left(error);if(bracketCount===0){status=RETURN;step=null;fail=null}};return canceler}}
function join(cb){return function(){var canceler=onComplete({rethrow:false,handler:cb})();if(status===SUSPENDED)run(runTick);return canceler}};return{kill:kill,join:join,onComplete:onComplete,isSuspended:function(){return status===SUSPENDED},run:function(){if(status===SUSPENDED)if(!Scheduler.isDraining()){Scheduler.enqueue(function(){run(runTick)})}else run(runTick)}}}
function runPar(util,supervisor,par,cb){var fiberId=0,fibers={},killId=0,kills={},early=new Error("[ParAff] Early exit"),interrupt=null,root=EMPTY;function kill(error,par,cb){var step=par,head=null,tail=null,count=0,kills={},tmp,kid;loop:while(true){tmp=null;switch(step.tag){case FORKED:if(step._3===EMPTY){tmp=fibers[step._1];kills[count++]=tmp.kill(error,function(result){return function(){count--;if(count===0)cb(result)()}})};if(head===null)break loop;step=head._2;if(tail===null){head=null}else{head=tail._1;tail=tail._2};break;case MAP:step=step._2;break;case APPLY:case ALT:if(head)tail=new Aff(CONS,head,tail);head=step;step=step._1;break}};if(count===0){cb(util.right(void 0))()}else{kid=0;tmp=count;for(;kid<tmp;kid++)kills[kid]=kills[kid]()};return kills}
function join(result,head,tail){var fail,step,lhs,rhs,tmp,kid;if(util.isLeft(result)){fail=result;step=null}else{step=result;fail=null};loop:while(true){lhs=null;rhs=null;tmp=null;kid=null;if(interrupt!==null)return;if(head===null){cb(fail||step)();return};if(head._3!==EMPTY)return;switch(head.tag){case MAP:if(fail===null){head._3=util.right(head._1(util.fromRight(step)));step=head._3}else head._3=fail;break;case APPLY:lhs=head._1._3;rhs=head._2._3;if(fail){head._3=fail;tmp=true;kid=killId++;kills[kid]=kill(early,fail===lhs?head._2:head._1,function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail===null){join(fail,null,null)}else join(fail,tail._1,tail._2)}});if(tmp){tmp=false;return}}else if(lhs===EMPTY||rhs===EMPTY){return}else{step=util.right(util.fromRight(lhs)(util.fromRight(rhs)));head._3=step};break;case ALT:lhs=head._1._3;rhs=head._2._3;if(lhs===EMPTY&&util.isLeft(rhs)||rhs===EMPTY&&util.isLeft(lhs))return;if(lhs!==EMPTY&&util.isLeft(lhs)&&rhs!==EMPTY&&util.isLeft(rhs)){fail=step===lhs?rhs:lhs;step=null;head._3=fail}else{head._3=step;tmp=true;kid=killId++;kills[kid]=kill(early,step===lhs?head._2:head._1,function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail===null){join(step,null,null)}else join(step,tail._1,tail._2)}});if(tmp){tmp=false;return}};break};if(tail===null){head=null}else{head=tail._1;tail=tail._2}}}
function resolve(fiber){return function(result){return function(){delete fibers[fiber._1];fiber._3=result;join(result,fiber._2._1,fiber._2._2)}}}
function run(){var status=CONTINUE,step=par,head=null,tail=null,tmp,fid;loop:while(true){tmp=null;fid=null;switch(status){case CONTINUE:switch(step.tag){case MAP:if(head)tail=new Aff(CONS,head,tail);head=new Aff(MAP,step._1,EMPTY,EMPTY);step=step._2;break;case APPLY:if(head)tail=new Aff(CONS,head,tail);head=new Aff(APPLY,EMPTY,step._2,EMPTY);step=step._1;break;case ALT:if(head)tail=new Aff(CONS,head,tail);head=new Aff(ALT,EMPTY,step._2,EMPTY);step=step._1;break;default:fid=fiberId++;status=RETURN;tmp=step;step=new Aff(FORKED,fid,new Aff(CONS,head,tail),EMPTY);tmp=Fiber(util,supervisor,tmp);tmp.onComplete({rethrow:false,handler:resolve(step)})();fibers[fid]=tmp;if(supervisor)supervisor.register(tmp)};break;case RETURN:if(head===null)break loop;if(head._1===EMPTY){head._1=step;status=CONTINUE;step=head._2;head._2=EMPTY}else{head._2=step;step=head;if(tail===null){head=null}else{head=tail._1;tail=tail._2}}}};root=step;for(fid=0;fid<fiberId;fid++)fibers[fid].run()}
function cancel(error,cb){interrupt=util.left(error);var innerKills;for(var kid in kills)if(kills.hasOwnProperty(kid)){innerKills=kills[kid];for(kid in innerKills)if(innerKills.hasOwnProperty(kid))innerKills[kid]()};kills=null;var newKills=kill(error,root,cb);return function(killError){return new Aff(ASYNC,function(killCb){return function(){for(var kid in newKills)if(newKills.hasOwnProperty(kid))newKills[kid]();return nonCanceler}})}};run();return function(killError){return new Aff(ASYNC,function(killCb){return function(){return cancel(killError,killCb)}})}}
function sequential(util,supervisor,par){return new Aff(ASYNC,function(cb){return function(){return runPar(util,supervisor,par,cb)}})};Aff.EMPTY=EMPTY;Aff.Pure=AffCtr(PURE);Aff.Throw=AffCtr(THROW);Aff.Catch=AffCtr(CATCH);Aff.Sync=AffCtr(SYNC);Aff.Async=AffCtr(ASYNC);Aff.Bind=AffCtr(BIND);Aff.Bracket=AffCtr(BRACKET);Aff.Fork=AffCtr(FORK);Aff.Seq=AffCtr(SEQ);Aff.ParMap=AffCtr(MAP);Aff.ParApply=AffCtr(APPLY);Aff.ParAlt=AffCtr(ALT);Aff.Fiber=Fiber;Aff.Supervisor=Supervisor;Aff.Scheduler=Scheduler;Aff.nonCanceler=nonCanceler;return Aff}();exports._pure=Aff.Pure;exports._map=function(f){return function(aff){if(aff.tag===Aff.Pure.tag){return Aff.Pure(f(aff._1))}else return Aff.Bind(aff,function(value){return Aff.Pure(f(value))})}};exports._bind=function(aff){return function(k){return Aff.Bind(aff,k)}};exports._liftEffect=Aff.Sync;exports._delay=function(){function setDelay(n,k){if(n===0&&typeof setImmediate!=="undefined"){return setImmediate(k)}else return setTimeout(k,n)}
function clearDelay(n,t){if(n===0&&typeof clearImmediate!=="undefined"){return clearImmediate(t)}else return clearTimeout(t)};return function(right,ms){return Aff.Async(function(cb){return function(){var timer=setDelay(ms,cb(right()));return function(){return Aff.Sync(function(){return right(clearDelay(ms,timer))})}}})}}()})(PS["Effect.Aff"]=PS["Effect.Aff"]||{});(function($PS){"use strict";$PS["Effect.Class"]=$PS["Effect.Class"]||{};var exports=$PS["Effect.Class"],Control_Category=$PS["Control.Category"],Effect=$PS["Effect"],MonadEffect=function(Monad0,liftEffect){this.Monad0=Monad0;this.liftEffect=liftEffect},monadEffectEffect=new MonadEffect(function(){return Effect.monadEffect},Control_Category.identity(Control_Category.categoryFn)),liftEffect=function(dict){return dict.liftEffect};exports["liftEffect"]=liftEffect;exports["MonadEffect"]=MonadEffect;exports["monadEffectEffect"]=monadEffectEffect})(PS);(function($PS){"use strict";$PS["Effect.Aff"]=$PS["Effect.Aff"]||{};var exports=$PS["Effect.Aff"],$foreign=$PS["Effect.Aff"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Control_Monad=$PS["Control.Monad"],Data_Either=$PS["Data.Either"],Data_Functor=$PS["Data.Functor"],Effect_Class=$PS["Effect.Class"],functorAff=new Data_Functor.Functor($foreign["_map"]),delay=function(v){return $foreign["_delay"](Data_Either.Right.create,v)},monadAff=new Control_Monad.Monad(function(){return applicativeAff},function(){return bindAff}),bindAff=new Control_Bind.Bind(function(){return applyAff},$foreign["_bind"]),applyAff=new Control_Apply.Apply(function(){return functorAff},Control_Monad.ap(monadAff)),applicativeAff=new Control_Applicative.Applicative(function(){return applyAff},$foreign["_pure"]),monadEffectAff=new Effect_Class.MonadEffect(function(){return monadAff},$foreign["_liftEffect"]);exports["delay"]=delay;exports["applicativeAff"]=applicativeAff;exports["bindAff"]=bindAff;exports["monadEffectAff"]=monadEffectAff})(PS);(function(exports){"use strict";exports.log=function(s){return function(){console.log(s);return{}}}})(PS["Effect.Console"]=PS["Effect.Console"]||{});(function($PS){"use strict";$PS["Effect.Console"]=$PS["Effect.Console"]||{};var exports=$PS["Effect.Console"],$foreign=$PS["Effect.Console"];exports["log"]=$foreign.log})(PS);(function($PS){"use strict";$PS["Effect.Class.Console"]=$PS["Effect.Class.Console"]||{};var exports=$PS["Effect.Class.Console"],Effect_Class=$PS["Effect.Class"],Effect_Console=$PS["Effect.Console"],log=function(dictMonadEffect){var $30=Effect_Class.liftEffect(dictMonadEffect);return function($31){return $30(Effect_Console.log($31))}};exports["log"]=log})(PS);(function(exports){"use strict";exports.error=function(msg){return new Error(msg)};exports.throwException=function(e){return function(){throw e}}})(PS["Effect.Exception"]=PS["Effect.Exception"]||{});(function($PS){"use strict";$PS["Effect.Exception"]=$PS["Effect.Exception"]||{};var exports=$PS["Effect.Exception"],$foreign=$PS["Effect.Exception"];exports["error"]=$foreign.error;exports["throwException"]=$foreign.throwException})(PS);(function(exports){"use strict";exports.unsafePerformEffect=function(f){return f()}})(PS["Effect.Unsafe"]=PS["Effect.Unsafe"]||{});(function($PS){"use strict";$PS["Effect.Unsafe"]=$PS["Effect.Unsafe"]||{};var exports=$PS["Effect.Unsafe"],$foreign=$PS["Effect.Unsafe"];exports["unsafePerformEffect"]=$foreign.unsafePerformEffect})(PS);(function($PS){"use strict";$PS["Effect.Exception.Unsafe"]=$PS["Effect.Exception.Unsafe"]||{};var exports=$PS["Effect.Exception.Unsafe"],Effect_Exception=$PS["Effect.Exception"],Effect_Unsafe=$PS["Effect.Unsafe"],unsafeThrowException=function($0){return Effect_Unsafe.unsafePerformEffect(Effect_Exception.throwException($0))},unsafeThrow=function($1){return unsafeThrowException(Effect_Exception.error($1))};exports["unsafeThrow"]=unsafeThrow})(PS);(function(exports){"use strict";exports.now=function(){return Date.now()}})(PS["Effect.Now"]=PS["Effect.Now"]||{});(function($PS){"use strict";$PS["Effect.Now"]=$PS["Effect.Now"]||{};var exports=$PS["Effect.Now"],$foreign=$PS["Effect.Now"];exports["now"]=$foreign.now})(PS);(function(exports){"use strict";exports.new=function(val){return function(){return{value:val}}};exports.read=function(ref){return function(){return ref.value}};exports.write=function(val){return function(ref){return function(){ref.value=val;return{}}}}})(PS["Effect.Ref"]=PS["Effect.Ref"]||{});(function($PS){"use strict";$PS["Effect.Ref"]=$PS["Effect.Ref"]||{};var exports=$PS["Effect.Ref"],$foreign=$PS["Effect.Ref"];exports["new"]=$foreign["new"];exports["read"]=$foreign.read;exports["write"]=$foreign.write})(PS);(function(exports){"use strict";const sansSerif="Helvetica Neue,Helvetica,Arial,sans-serif",sameArray=function(xs,ys){const lx=xs.length,ly=ys.length;if(lx==ly){for(const i of d3.range(lx))if(xs[i]!=ys[i])return false;return true}else return false};exports.logMe=function(x){return function(){console.log(x)}};const binom=function(n,k){let x=1;let i=1;while(i<=k){x=x*(n+1-i)/i;i=i+1};return x};exports._binom=binom;exports.factorial=function(n){let i=2;let x=1;while(i<=n){x=x*i;i=i+1};return x};exports._chompPascal=function(q0,n,k0,f){let i=0;let q=q0;let k=k0;while(k>0){const x=binom(n+k-1,n-1);if(q>=x){i=i+1;q=q-x;k=k-1}else break};return f(i)(q)(k)};const ixChomper=function(n,x,f){let k=0;let z=0;while(true){const z2=binom(n+k,n);if(z2>x){return f(x-z)(k)}else{k=k+1;z=z2}}},ixPascal=function(n,x){let y=x;let i=0;let res=[];while(true)if(i<n){ixChomper(n-i,y,y2=>function(s){y=y2;i=i+1;res.unshift(s)})}else return res};exports._ixPascal=ixPascal;const pascalIx=function(ps){let res=0;ps.forEach(function(p,i){if(p>0)res+=binom(p+i,p-1)});return res};exports.pascalIx=pascalIx;const maxBinom=function(n,lim){let i=0;while(true){if(binom(n+i,i)>lim)return i;i=i+1}};exports._maxBinom=maxBinom;exports.memoInt=function(f){let table=[];return function(x){if(x in table){return table[x]}else{const res=f(x);table[x]=res;return res}}};exports._toIntMap=function(extractor,merger,bazaar){let res=[];bazaar(x=>function(){extractor(x)(i=>y=>function(){if(i in res){res[i]=merger(res[i])(y)}else res[i]=y})()})();return res};exports._unionsIntMap=function(merger,bazaar){let res=[];bazaar(xs=>function(){xs.forEach(function(x,i){if(i in res){res[i]=merger(res[i])(x)}else res[i]=x})})();return res};exports._filterIntMap=function(f,xs){let res=[];xs.forEach(function(x,i){if(f(x))res[i]=x});return res};exports.intMapKeys=function(xs){let res=[];xs.forEach((x,i)=>res.push(i));return res};exports._singletonIntMap=function(i,x){let res=[];res[i]=x;return res};exports.trace=function(tr){return function(x){console.log(tr);return x}};const pointChange=function(){let currx=null;let curry=null;const register=function(x,y,f){if((x!=currx)||(y!=curry)){currx=x;curry=y;f(x,y)}},getPos=function(){return{x:currx,y:curry}};return{register,getPos}};exports._setupDrawer=function(sel,size){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10};return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width,window_size.height]).attr("width","15em").style("margin","auto").style("display","block"),activePts=d3.range(size.width).map(()=>d3.range(size.height).map(()=>false)),tracker=pointChange();let clicked=false;let grid={};const registerMove=function(x,y){tracker.register(x,y,function(){if(clicked)if(x&&y){activePts[x][y]^=true;grid.drawer(activePts.flatMap((ys,x)=>ys.flatMap((b,y)=>((b)?[{x,y,val:1}]:[]))))}})},gridbox=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);grid=setupGrid(gridbox,"",size.width,size.height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:((x,y)=>registerMove(x,y)),onleave:(()=>registerMove(null,null))});const clickon=function(e){e.preventDefault();clicked=true},clickoff=function(e){e.preventDefault();clicked=false};svg.on("mousedown",clickon).on("touchstart",clickon).on("mouseup",clickoff).on("touchend",clickoff)}};const slider_size={height:40,width:200};exports.initGolFlat=function(sel){return function(){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10};d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width,window_size.height]).attr("width","15em").style("margin","auto").style("display","block"),dimslidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).attr("width","15em").style("margin","1em auto 0 auto").style("display","block").style("overflow","visible"),slidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).attr("width","15em").style("margin","1em auto 0 auto").style("display","block").style("overflow","visible"),ptsdisp=d3.select(sel).append("div").style("width","20em").style("height","10em").style("margin","1em auto 0 auto").style("display","block").append("p").style("text-align","center").style("font-size","90%").style("line-height","125%");return{svg,slidersvg,dimslidersvg,ptsdisp,window_size,margin}}};exports._drawGolFlat=function({svg,slidersvg,dimslidersvg,ptsdisp,window_size,margin},size,snapshots){const cell_size={height:(window_size.height-margin.top-margin.bottom)/size.height,width:(window_size.width-margin.left-margin.right)/size.width};return function(){svg.selectAll("*").remove();let currTime=0;let currDim=0;let currSel=undefined;let locked=false;let ptcache=[];const grid=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);let gridSetup={};const drawBoxes=function(t,d,sel_){const newCells=(t!=currTime)||(d!=currDim),sel=locked?currSel:sel_;if(newCells){ptcache=[];const cells=snapshots[t][d]().map(function({x,y,pts}){if(x in ptcache){ptcache[x][y]=pts}else{ptcache[x]=[];ptcache[x][y]=pts};return{x,y,val:pts.length}});gridSetup.drawer(cells)};if(sel!=currSel||newCells)if(sel){const{x,y}=sel,pts=(x in ptcache)?((y in ptcache[x])?ptcache[x][y]:[]):[];if(d>0){const ptsstring=(pts.length==0)?"(no points)":pts.map(pt=>"<"+ixPascal(d,pt).join(",")+">").join(", ");ptsdisp.text(ptsstring).style("font-style",(pts.length==0)?"italic":"normal")}else ptsdisp.text((pts.length==0)?"(no point)":"(single point)").style("font-style","italic");const equivGroup=snapshots[t][d]().flatMap(function(testpt){if(sameArray(testpt.pts,pts)){return[{x:testpt.x,y:testpt.y,val:1}]}else return[]});gridSetup.highlighter(equivGroup)}else{gridSetup.highlighter([]);ptsdisp.text("Hover to view points").style("font-style","italic")};currTime=t;currDim=d;currSel=sel};gridSetup=setupGrid(grid,"",size.width,size.height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:((x,y)=>drawBoxes(currTime,currDim,{x,y})),onleave:(()=>drawBoxes(currTime,currDim,undefined))});gridSetup.grid.on("click",function(e){e.preventDefault();locked=!locked;if(locked){gridSetup.underlighter(0.05)}else gridSetup.underlighter(0)});const dimselbox=dimslidersvg.append("g").attr("transform","translate(15,0)"),dimslider=d3.sliderBottom().min(0).max(snapshots[0].length-1).step(1).width(slider_size.width-30).ticks(snapshots[0].length).tickFormat(v=>(v+2)+"").displayFormat(v=>"d="+(v+2)).on("onchange",d=>drawBoxes(currTime,d,currSel));dimselbox.call(dimslider);dimslider.value(3);const controller=setupTimer(slidersvg,snapshots.length,slider_size.width,i=>drawBoxes(i,currDim,currSel))}};exports.initGol3D=function(sel){return function(){const window_size={height:200,width:200},maxZ=6,margin={top:10,bottom:10,left:10,right:10};d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width*(maxZ*2+1),window_size.height]).attr("width","100%").style("margin","auto").style("display","block"),slidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).attr("width","15em").style("margin","1em auto").style("display","block").style("overflow","visible");return{svg,slidersvg,window_size,margin,maxZ}}};exports._drawGol3D=function({svg,slidersvg,window_size,margin,maxZ},size,snapshots){const symmetries=d3.range(0,maxZ+1).map(z=>(z>0)?[-z,z]:[z]),cell_size={height:(window_size.height-margin.top-margin.bottom)/size.height,width:(window_size.width-margin.left-margin.right)/size.width};return function(){svg.selectAll("*").remove();const grid=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);let fullGrid=[];let clearHighlights=[];let grids=[];const clearAllHighlights=function(){clearHighlights.forEach(highlighter=>highlighter([]));clearHighlights=[]},highlightNeighbs=function(x,y,z,i){clearAllHighlights();[-1,0,1].forEach(function(dz){if(inRange(-maxZ,maxZ+1,z+dz)){const hltr=fullGrid[z+dz+maxZ].highlighter,baseNeighbs=(dz==0)?neighbs2d.slice(1):neighbs2d;hltr(baseNeighbs.map(dxy=>({x:x+dxy.x,y:y+dxy.y,val:1})).filter(xy=>(inRange(0,size.width,xy.x)&&inRange(0,size.height,xy.y))));clearHighlights.push(()=>hltr([]))}});grids[i].forEach(function(g){g.underlighter(0.25);clearHighlights.push(()=>g.underlighter(0))})};grids=symmetries.map(function(pos,i){return pos.map(function(z){const res=setupGrid(grid,"z = "+z,size.width,size.height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(x,y){highlightNeighbs(x,y,z,i)},onleave:clearAllHighlights});res.grid.attr("transform",`translate(${(maxZ+z)*window_size.width},0)`);fullGrid[z+maxZ]={drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter};return{drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter}})});let splitCache=[];let refresh=[];const drawBoxes=function(j){refresh.forEach(drawer=>drawer([]));refresh=[];let splitCells=[];if(j in splitCache){splitCells=splitCache[j]}else{const cells=snapshots[j]();cells.map(function({x,y,zs}){zs.map(function(z){if(z in splitCells){splitCells[z].push({x,y,val:1})}else splitCells[z]=[{x,y,val:1}]})});splitCache[j]=splitCells};splitCells.forEach(function(ps,z){grids[z].forEach(function({drawer}){drawer(ps);refresh.push(drawer)})})},controller=setupTimer(slidersvg,snapshots.length,slider_size.width,drawBoxes)}};exports.initGol4D=function(sel){return function(){const window_size={height:200,width:200},maxZW=6,margin={top:10,bottom:10,left:10,right:10};d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width*(maxZW*2+1),window_size.height*(maxZW*2+1)]).attr("width","100%").style("margin","auto").style("display","block"),slidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).attr("width","15em").style("margin","1em auto").style("display","block").style("overflow","visible");return{svg,slidersvg,window_size,margin,maxZW}}};const neighbs2d=[{x:0,y:0},{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:-1,y:-1},{x:-1,y:1},{x:1,y:0},{x:1,y:-1},{x:1,y:1}],inRange=function(mn,mx,x){return(x>=mn&&x<mx)};exports._drawGol4D=function({svg,slidersvg,window_size,margin,maxZW},size,snapshots){const maxPascal=binom(2+maxZW,maxZW),symmetries=d3.range(0,maxPascal).map(function(i){const zw=ixPascal(2,i),z0=zw[0],w0=zw[1];let pos=[{z:z0,w:w0}];if(z0!=w0)pos.push({z:w0,w:z0});pos.forEach(function({z,w}){if(z>0)pos.push({z:-z,w:w});if(w>0)pos.push({z:z,w:-w});if(z>0&&w>0)pos.push({z:-z,w:-w})});return pos}),cell_size={height:(window_size.height-margin.top-margin.bottom)/size.height,width:(window_size.width-margin.left-margin.right)/size.width};return function(){svg.selectAll("*").remove();const grid=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);let fullGrid=d3.range(2*maxZW+1).map(c=>[]);let clearHighlights=[];let grids=[];const clearAllHighlights=function(){clearHighlights.forEach(highlighter=>highlighter([]));clearHighlights=[]},highlightNeighbs=function(x,y,z,w,i){clearAllHighlights();neighbs2d.forEach(function(dzw){if(inRange(-maxZW,maxZW+1,z+dzw.x)&&inRange(-maxZW,maxZW+1,w+dzw.y)){const hltr=fullGrid[z+dzw.x+maxZW][w+dzw.y+maxZW].highlighter,baseNeighbs=(dzw.x==0&&dzw.y==0)?neighbs2d.slice(1):neighbs2d;hltr(baseNeighbs.map(dxy=>({x:x+dxy.x,y:y+dxy.y,val:1})).filter(xy=>(inRange(0,size.width,xy.x)&&inRange(0,size.height,xy.y))));clearHighlights.push(()=>hltr([]))}});grids[i].forEach(function(g){g.underlighter(0.25);clearHighlights.push(()=>g.underlighter(0))})};grids=symmetries.map(function(pos,i){return pos.map(function({z,w}){const res=setupGrid(grid,"",size.width,size.height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(x,y){highlightNeighbs(x,y,z,w,i)},onleave:clearAllHighlights});res.grid.attr("transform",`translate(${(maxZW+z)*window_size.width},${(maxZW+w)*window_size.height})`);fullGrid[z+maxZW][w+maxZW]={drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter};return{drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter}})});let splitCache=[];let refresh=[];const drawBoxes=function(j){refresh.forEach(drawer=>drawer([]));refresh=[];let splitCells=[];if(j in splitCache){splitCells=splitCache[j]}else{const cells=snapshots[j]();cells.map(function({x,y,zws}){zws.map(function(zw){if(zw in splitCells){splitCells[zw].push({x,y,val:1})}else splitCells[zw]=[{x,y,val:1}]})});splitCache[j]=splitCells};splitCells.forEach(function(ps,zw){grids[zw].forEach(function({drawer}){drawer(ps);refresh.push(drawer)})})},controller=setupTimer(slidersvg,snapshots.length,slider_size.width,drawBoxes)}};const normalize4d=function({x,y}){const x_=Math.abs(x),y_=Math.abs(y);return(x_>y_)?{x:y_,y:x_}:{x:x_,y:y_}},pascalIx2d=({x,y})=>pascalIx([x,y]),pushOrAdd=function(xs,i,x){if(i in xs){xs[i].push(x)}else xs[i]=[x]},compressVals=function(ps){let xs=[];ps.forEach(function({x,y,val}){if(x in xs){if(!(y in xs[x]))xs[x][y]=0}else{xs[x]=[];xs[x][y]=0};xs[x][y]+=val});let out=[];xs.forEach(function(ys,x){ys.forEach(function(val,y){out.push({x,y,val})})});return out},neighbsArray=function(maxZW,reversed){const maxPascal=binom(2+maxZW,maxZW);let res=d3.range(0,maxPascal).map(()=>({neighbBox:[],neighbHighlight:[]}));d3.range(0,maxPascal).forEach(function(i){const pos=ixPascal(2,i);neighbs2d.slice(1).forEach(function(dp){const npos={x:pos[0]+dp.x,y:pos[1]+dp.y},j=pascalIx2d(normalize4d(npos)),newPt={x:dp.x+1,y:(-dp.y)+1,val:1};if(j<maxPascal)if(reversed){pushOrAdd(res[j].neighbHighlight,j,newPt);pushOrAdd(res[j].neighbBox,i,newPt)}else{pushOrAdd(res[i].neighbBox,j,newPt);pushOrAdd(res[i].neighbHighlight,i,newPt)}})});return res.map(({neighbBox,neighbHighlight})=>({neighbBox:neighbBox.map(compressVals),neighbHighlight:neighbHighlight.map(compressVals)}))};exports._drawGolSyms4D=function(sel,reversed){const window_size={height:200,width:200},maxZW=6,margin={top:10,bottom:10,left:10,right:10},maxPascal=binom(2+maxZW,maxZW),neighbs=neighbsArray(maxZW,reversed);return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width*(maxZW+1),window_size.height*(maxZW+1)]).attr("width","20em").style("margin","auto").style("overflow","visible").style("display","block"),allBoxes=svg.append("g");let boxes=[];let clearHighlights=[];const clearAllHighlights=function(){clearHighlights.forEach(clr=>clr());clearHighlights=[]},highlightNeighbs=function(i){clearAllHighlights();neighbs[i].neighbBox.forEach(function(ps,j){boxes[j].drawer(ps);boxes[j].settext(ps.length+"");boxes[j].underlighter(ps.length/8);clearHighlights.push(()=>boxes[j].drawer([]));clearHighlights.push(()=>boxes[j].settext(""));clearHighlights.push(()=>boxes[j].underlighter(0))});neighbs[i].neighbHighlight.forEach(function(ps,j){boxes[j].highlighter(ps);clearHighlights.push(()=>boxes[j].highlighter([]))});if(!(i in neighbs[i].neighbBox)){boxes[i].settext("0");clearHighlights.push(()=>boxes[i].settext(""))}};boxes=d3.range(0,maxPascal).map(function(i){const zw=ixPascal(2,i),z0=zw[0],w0=zw[1],res=setupGrid(allBoxes,z0+", "+w0,3,3,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(){highlightNeighbs(i)},onleave:clearAllHighlights});res.grid.attr("transform",`translate(${window_size.width*z0+margin.left},${window_size.height*(maxZW-w0)+margin.top})`);return{drawer:res.drawer,highlighter:res.highlighter,settext:res.settext,underlighter:res.underlighter}});return svg}};exports._drawGolSyms5D=function(sel,getNeighbs){const window_size={height:200,width:200},maxZWQ=5,margin={top:0,bottom:0,left:0,right:0,inter:30},maxPascal=binom(3+maxZWQ,maxZWQ),windowOffset=i=>(i==0)?0:binom(1+i,i-1),qOffset=i=>window_size.width*windowOffset(i)+margin.inter*i;let neighbs=[];const revNeighbs=d3.range(maxPascal).map(function(i){const ns=getNeighbs(i);ns.forEach(function(wt,j){if(!(j in neighbs))neighbs[j]=[];neighbs[j][i]=wt});return ns});return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,qOffset(maxZWQ+1),window_size.height*(maxZWQ+1)]).attr("width","100%").style("margin","auto").style("overflow","visible").style("display","block"),setupBox=function(g,txt,boxsize,handlers){const box=g.append("g"),underlight=box.append("rect").attr("width",boxsize).attr("height",boxsize).attr("fill","yellow").attr("opacity",0),outline=box.append("rect").attr("width",boxsize).attr("height",boxsize).attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("stroke-opacity",0.75),mover=function(e){e.preventDefault();if("onmove" in handlers)handlers.onmove()},leaver=function(e){if("onleave" in handlers)handlers.onleave()},botlab=box.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",40).attr("font-family",sansSerif).attr("transform",`translate(${boxsize/2},${boxsize*7/8})`).text(txt),mkCircle=function(col){const circcont=box.append("g"),circ=circcont.append("circle").attr("fill",col).attr("r",0).attr("transform",`translate(0,${boxsize/2})`).attr("opacity",0.75).style("transition","r 500ms ease"),lab=circcont.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",50).attr("font-family",sansSerif).attr("font-weight","bold").attr("transform",`translate(0,${boxsize*(3/10)})`),circfunc=function setCirc(d,l){circ.attr("r",Math.sqrt(d)*boxsize/4);lab.text(l)};return{box,circcont,circfunc}},circ1=mkCircle("red");circ1.circcont.attr("transform",`translate(${boxsize/4},0)`);const circ2=mkCircle("blue");circ2.circcont.attr("transform",`translate(${boxsize*3/4},0)`);const capture=box.append("rect").attr("width",boxsize).attr("height",boxsize).attr("fill","white").attr("opacity",0);capture.on("touchstart",mover).on("touchend",leaver).on("mouseenter",mover).on("mouseleave",leaver);const underlighter=function(o){underlight.attr("opacity",o)};return{box,circ1func:circ1.circfunc,circ2func:circ2.circfunc,underlighter}},allboxes=svg.append("g");let boxes=[];let clearHighlights=[];const clearNeighbs=function(){clearHighlights.forEach(clr=>clr());clearHighlights=[]},highlightNeighbs=function(i){clearNeighbs();const to=neighbs[i],from=revNeighbs[i];to.forEach(function(weight,x){if(x in boxes){boxes[x].circ1func(weight/8,weight+"");boxes[x].underlighter(0.2);clearHighlights.push(()=>{boxes[x].circ1func(0,"");boxes[x].underlighter(0)})}});from.forEach(function(weight,x){if(x in boxes){boxes[x].circ2func(weight/8,weight+"");boxes[x].underlighter(0.2);clearHighlights.push(()=>{boxes[x].circ2func(0,"");boxes[x].underlighter(0)})}})};boxes=d3.range(0,maxPascal).map(function(i){const zwq=ixPascal(3,i),z0=zwq[0],w0=zwq[1],q0=zwq[2],boxfuncs=setupBox(allboxes,zwq.join(", "),window_size.width-margin.left-margin.right,{onmove:(()=>highlightNeighbs(i)),onleave:(()=>clearNeighbs())});boxfuncs.box.attr("transform",`translate(${qOffset(q0)+window_size.width*z0+margin.left},${window_size.height*(maxZWQ-w0)+margin.top})`);return boxfuncs});return svg}};const setupGrid=function(svg,label,numx,numy,width,height,handlers){const cell_width=width/numx,cell_height=height/numy,grid=svg.append("g"),underlight=grid.append("rect").attr("width",width).attr("height",height).attr("fill","yellow").attr("opacity",0),outline=grid.append("rect").attr("width",width).attr("height",height).attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("stroke-opacity",0.75),boxes=grid.append("g"),xlines=grid.append("g").selectAll("line").data(d3.range(numx-1)).join("line").attr("stroke-opacity",0.3).attr("stroke","black").attr("stroke-width",0.5).attr("x1",d=>(d+1)*cell_width).attr("y1",0).attr("x2",d=>(d+1)*cell_width).attr("y2",height),ylines=grid.append("g").selectAll("line").data(d3.range(numy-1)).join("line").attr("stroke-opacity",0.3).attr("stroke","black").attr("stroke-width",0.5).attr("y1",d=>(d+1)*cell_height).attr("x1",0).attr("y2",d=>(d+1)*cell_height).attr("x2",width),highlights=grid.append("g"),lab=grid.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",(width+height)/10).attr("font-family",sansSerif).attr("transform",`translate(${width/2},${height*9/10})`).attr("opacity",0.85).text(label),hightext=grid.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",(width+height)/6).attr("font-family",sansSerif).attr("transform",`translate(${width/2},${height*(2/3-1/20)})`).attr("opacity",0.85).text(""),capture=grid.append("rect").attr("width",width).attr("height",height).attr("fill","white").attr("opacity",0),mover=function(e){e.preventDefault();const[mx,my]=d3.pointer(e,this),x=Math.floor(mx/cell_width),y=Math.floor(my/cell_height);if(x>=0&&x<numx&&y>=0&&y<numy)handlers.onmove(x,y)},leaver=function(e){if("onleave" in handlers)handlers.onleave()};if("onmove" in handlers)capture.on("touchmove",mover).on("touchstart",mover).on("mousemove",mover).on("mouseenter",mover);if("onleave" in handlers)capture.on("touchend",()=>handlers.onleave()).on("mouseleave",()=>handlers.onleave());const mkDrawer=function(s,col,o){return function(cells){const max=d3.max(cells,d=>d.val),color=d3.scaleSequential(col).domain([0,max]);s.selectAll("*").remove();s.selectAll("rect").data(cells).join("rect").attr("width",cell_width).attr("height",cell_height).attr("x",d=>d.x*cell_width).attr("y",d=>d.y*cell_height).attr("fill",d=>color(d.val)).style("opacity",o)}};return{grid,drawer:mkDrawer(boxes,d3.interpolateGreens,0.8),highlighter:mkDrawer(highlights,d3.interpolateBlues,0.3),underlighter:function(o){underlight.attr("opacity",o)},settext:function(t){hightext.text(t)}}},setupTimer=function(svg,size,width,callback){const tAxis=function(g){const sliderino=d3.sliderBottom().min(0).max(size-1).step(1).width(width-30).ticks(size).tickFormat(v=>"").displayFormat(v=>"");g.call(sliderino);return sliderino};let timer=null;const subslider=svg.append("g"),slidercont=subslider.append("g").attr("transform","translate(15,0)"),sliderino=tAxis(slidercont.append("g")).on('onchange',callback);callback(sliderino.value());const button=subslider.append("g"),drawButton=function(g,playing,callback){g.select("*").remove();g.append("rect").attr("width",50).attr("height",18).attr("rx",2).style("fill","#eee").attr("stroke","#aaa").attr("stroke-width",0.5).style("margin",0).style("padding",0).attr("transform",`translate(${width/2-25},20)`);const txt=g.append("text").attr("fill","#555").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",10).text(playing?"Pause":"Play"),tbb=txt.node().getBBox();txt.attr("transform",`translate(${width/2},${20+18/2+tbb.height/2-2})`);g.on("click",null).on("click",callback)},play_start=function(){button.call(drawButton,true,play_stop);play_tick();timer=setInterval(play_tick,1000)},play_stop=function(){button.call(drawButton,false,play_start);clearInterval(timer);timer=null},play_tick=function(){const currval=sliderino.value(),nextval=(currval+1)%size;sliderino.value(nextval)};play_stop();return subslider};exports._buildHierarchy=function(x,f){return d3.hierarchy(x,f)};const expandRun=r=>r.flatMap((d,i)=>d3.range(d).map(()=>i));exports._drawTree=function(sel,forward,vecRun,mkHier,getContrib){const margin={top:10,bottom:10,left:30,right:42},optSizeLim=70,maxZLim=5,expandChosens=function(c){const contlen=c.leftovers.length,choselen=c.chosen.length,pad=d3.range(contlen-choselen).map(()=>0),fullchose=pad.concat(c.chosen),expandLeft=expandRun(c.leftovers),prefix=(expandLeft.length>0)?("["+expandLeft.join(",")+"]"):"",suffix=expandRun(fullchose).join(","),infix=(prefix.length>0&&suffix.length>0)?",":"";return"<"+prefix+infix+suffix+">"},expandParts=function(c){const parts=c.parts;return[parts.left,parts.here,parts.right].filter(x=>!(x===null)).join("+")};return function(){d3.select(sel).selectAll("p").remove();const dimslidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).attr("width","15em").style("margin","0.25em auto 0 auto").style("display","block").style("overflow","visible"),selbox=d3.select(sel).append("form").style("width","15em").style("margin","0 auto 0 auto").style("display","block").append("select").style("width","100%"),svg=d3.select(sel).append("svg").attr("width","100%").style("margin","auto").style("overflow","visible").style("display","block"),setupSelect=function(dim){selbox.selectAll("*").remove();const maxZ=Math.min(maxBinom(dim,optSizeLim)-1,maxZLim),numOpts=binom(dim+maxZ,maxZ),ptOpts=d3.range(numOpts).map(function(d){const vr=vecRun(dim)(d).slice(0,-1),pt=ixPascal(dim,d);return{pt:d,disp:"<"+pt.join(",")+"> ("+vr.join("-")+")"}});selbox.selectAll("option").data(ptOpts).join("option").attr("value",d=>d.pt).text(d=>d.disp)},dimselbox=dimslidersvg.append("g").attr("transform","translate(15,0)"),dimslider=d3.sliderBottom().min(1).max(5).step(1).width(slider_size.width-30).ticks(5).tickFormat(v=>(v+2)+"").displayFormat(v=>"d="+(v+2));dimselbox.call(dimslider);const drawTree=function(pt){svg.selectAll("*").remove();const dim=dimslider.value(),hier=mkHier(dim)(pt),numchild=hier.leaves().length,window_size={height:numchild*15+margin.top+margin.bottom,width:400},tree=d3.tree().size([window_size.height-margin.top-margin.bottom,window_size.width-margin.left-margin.right])(hier);svg.attr("viewBox",[0,0,window_size.width,window_size.height]);selbox.property("value",pt);const treecont=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`),link=treecont.append("g");link.selectAll("path").data(tree.links()).join("path").attr("fill","none").attr("stroke","#555").attr("stroke-opacity",0.4).attr("stroke-width",1).attr("d",d3.linkHorizontal().x(d=>d.y).y(d=>d.x));const node=treecont.append("g").attr("stroke-linejoin","round").attr("stroke-width",3).selectAll("g").data(tree.descendants()).join("g").attr("transform",d=>`translate(${d.y},${d.x})`),tooltip=treecont.append("g").style("opacity",0.95).attr("display","none");tooltip.append("rect").attr("width",40).attr("height",19).attr("x",-20).attr("y",6).style("fill","#fff").style("stroke","#666").style("stroke-width","0.5px");const tttext1=tooltip.append("text").attr("text-anchor","middle").style("font-size",6.5).attr("font-family",sansSerif).attr("x",0).attr("y",14),tttext2=tooltip.append("text").attr("text-anchor","middle").style("font-size",6).style("font-style","italic").attr("font-family",sansSerif).attr("x",0).attr("y",21),dots=node.append("circle").attr("opacity",0.75);node.append("text").attr("text-anchor","end").attr("dy",-1.5).attr("x",-4).attr("opacity",d=>("children" in d)?0.9:0.5).text(d=>getContrib(d.data)().leftovers.join("-"));node.append("text").attr("text-anchor","end").attr("dy",4.5).attr("x",-4).attr("opacity",d=>(d.parent)?0.9:0.5).text(function(d){const c=getContrib(d.data)(),contlen=c.leftovers.length,choselen=c.chosen.length,pad=d3.range(contlen-choselen).map(()=>"_");return pad.concat(c.chosen).join("-")}).style("font-weight",d=>("children" in d)?"normal":"bold").style("text-decoration",d=>("children" in d)?"none":(getContrib(d.data)().allSame?"line-through":"none"));node.append("text").attr("text-anchor","start").attr("dy",2).attr("x",3).attr("opacity",0.9).text(function(d){const c=getContrib(d.data)(),m=forward?c.multQ():c.multP();if("children" in d){return m.here}else{const endMult=c.allSame?0:m.total;return m.here+"  "+endMult}}).style("text-decoration",d=>("children" in d)?"none":(getContrib(d.data)().allSame?"line-through":"none"));node.selectAll("text").attr("font-family",sansSerif).style("font-size",6).clone(true).lower().attr("stroke","white");const highlightNodes=function(d){const c=getContrib(d.data)(),targChosen=c.chosen;dots.filter(d=>sameArray(targChosen,getContrib(d.data)().chosen)).attr("r",4).attr("fill","blue").attr("opacity","0.5");const ancs=d.ancestors(),checkAnc=function(q){for(const a of ancs)if(a==q)return true;return false};link.selectAll("path").filter(d=>checkAnc(d.target)).attr("stroke-opacity",0.9);tooltip.attr("display",null).attr("transform",`translate(${d.y},${d.x})`);tttext1.text(expandChosens(c));tttext2.text(expandParts(c))},clearNodes=function(){dots.attr("r",d=>(("children" in d)&&d.parent)?1.5:2).attr("fill",d=>(("children" in d)&&d.parent)?"#333":"red").attr("opacity","0.75");link.selectAll("path").attr("stroke-opacity",0.4);tooltip.attr("display","none")};node.append("circle").attr("r",8).attr("opacity",0).on("mouseenter",(e,d)=>highlightNodes(d)).on("touchstart",(e,d)=>highlightNodes(d)).on("mouseleave",()=>clearNodes()).on("touchend",()=>clearNodes());clearNodes()};dimslider.on("onchange",d=>{setupSelect(d);drawTree(0)});selbox.on("change",d=>drawTree(d.srcElement.value));dimslider.value(4);drawTree(22);return svg}};exports.undefined=0;exports._assignWindow=function(p,x){return function(){window[p]=x}}})(PS["Gol"]=PS["Gol"]||{});(function($PS){"use strict";$PS["Matryoshka.Class.Corecursive"]=$PS["Matryoshka.Class.Corecursive"]||{};var exports=$PS["Matryoshka.Class.Corecursive"],Corecursive=function(Functor0,embed){this.Functor0=Functor0;this.embed=embed},embed=function(dict){return dict.embed};exports["embed"]=embed;exports["Corecursive"]=Corecursive})(PS);(function($PS){"use strict";$PS["Matryoshka.Class.Recursive"]=$PS["Matryoshka.Class.Recursive"]||{};var exports=$PS["Matryoshka.Class.Recursive"],Recursive=function(Functor0,project){this.Functor0=Functor0;this.project=project},project=function(dict){return dict.project};exports["project"]=project;exports["Recursive"]=Recursive})(PS);(function($PS){"use strict";$PS["Matryoshka.Fold"]=$PS["Matryoshka.Fold"]||{};var exports=$PS["Matryoshka.Fold"],Data_Functor=$PS["Data.Functor"],Matryoshka_Class_Recursive=$PS["Matryoshka.Class.Recursive"],cata=function(dictRecursive){return function(f){var go=function(t){return f(Data_Functor.map(dictRecursive.Functor0())(go)(Matryoshka_Class_Recursive.project(dictRecursive)(t)))};return go}};exports["cata"]=cata})(PS);(function($PS){"use strict";$PS["Matryoshka.Unfold"]=$PS["Matryoshka.Unfold"]||{};var exports=$PS["Matryoshka.Unfold"],Data_Functor=$PS["Data.Functor"],Matryoshka_Class_Corecursive=$PS["Matryoshka.Class.Corecursive"],ana=function(dictCorecursive){return function(f){var go=function(a){return Matryoshka_Class_Corecursive.embed(dictCorecursive)(Data_Functor.map(dictCorecursive.Functor0())(go)(f(a)))};return go}};exports["ana"]=ana})(PS);(function(exports){"use strict";exports.unsafeCoerce=function(x){return x}})(PS["Unsafe.Coerce"]=PS["Unsafe.Coerce"]||{});(function($PS){"use strict";$PS["Unsafe.Coerce"]=$PS["Unsafe.Coerce"]||{};var exports=$PS["Unsafe.Coerce"],$foreign=$PS["Unsafe.Coerce"];exports["unsafeCoerce"]=$foreign.unsafeCoerce})(PS);(function($PS){"use strict";$PS["Web.DOM.Document"]=$PS["Web.DOM.Document"]||{};var exports=$PS["Web.DOM.Document"],Unsafe_Coerce=$PS["Unsafe.Coerce"],toEventTarget=Unsafe_Coerce.unsafeCoerce;exports["toEventTarget"]=toEventTarget})(PS);(function(exports){"use strict";exports.eventListener=function(fn){return function(){return function(event){return fn(event)()}}};exports.addEventListener=function(type){return function(listener){return function(useCapture){return function(target){return function(){return target.addEventListener(type,listener,useCapture)}}}}}})(PS["Web.Event.EventTarget"]=PS["Web.Event.EventTarget"]||{});(function($PS){"use strict";$PS["Web.Event.EventTarget"]=$PS["Web.Event.EventTarget"]||{};var exports=$PS["Web.Event.EventTarget"],$foreign=$PS["Web.Event.EventTarget"];exports["eventListener"]=$foreign.eventListener;exports["addEventListener"]=$foreign.addEventListener})(PS);(function(exports){"use strict";exports.window=function(){return window}})(PS["Web.HTML"]=PS["Web.HTML"]||{});(function($PS){"use strict";$PS["Web.HTML"]=$PS["Web.HTML"]||{};var exports=$PS["Web.HTML"],$foreign=$PS["Web.HTML"];exports["window"]=$foreign.window})(PS);(function($PS){"use strict";$PS["Web.HTML.Event.EventTypes"]=$PS["Web.HTML.Event.EventTypes"]||{};var exports=$PS["Web.HTML.Event.EventTypes"],readystatechange="readystatechange";exports["readystatechange"]=readystatechange})(PS);(function($PS){"use strict";$PS["Web.HTML.HTMLDocument"]=$PS["Web.HTML.HTMLDocument"]||{};var exports=$PS["Web.HTML.HTMLDocument"],Unsafe_Coerce=$PS["Unsafe.Coerce"],toDocument=Unsafe_Coerce.unsafeCoerce;exports["toDocument"]=toDocument})(PS);(function(exports){"use strict";exports.document=function(window){return function(){return window.document}}})(PS["Web.HTML.Window"]=PS["Web.HTML.Window"]||{});(function($PS){"use strict";$PS["Web.HTML.Window"]=$PS["Web.HTML.Window"]||{};var exports=$PS["Web.HTML.Window"],$foreign=$PS["Web.HTML.Window"];exports["document"]=$foreign.document})(PS);(function($PS){"use strict";$PS["Gol"]=$PS["Gol"]||{};var exports=$PS["Gol"],$foreign=$PS["Gol"],Control_Applicative=$PS["Control.Applicative"],Control_Apply=$PS["Control.Apply"],Control_Bind=$PS["Control.Bind"],Control_MonadZero=$PS["Control.MonadZero"],Data_Array=$PS["Data.Array"],Data_Bifunctor=$PS["Data.Bifunctor"],Data_Boolean=$PS["Data.Boolean"],Data_DateTime_Instant=$PS["Data.DateTime.Instant"],Data_EuclideanRing=$PS["Data.EuclideanRing"],Data_Foldable=$PS["Data.Foldable"],Data_Function=$PS["Data.Function"],Data_Function_Uncurried=$PS["Data.Function.Uncurried"],Data_Functor=$PS["Data.Functor"],Data_Int=$PS["Data.Int"],Data_Lazy=$PS["Data.Lazy"],Data_List_Lazy=$PS["Data.List.Lazy"],Data_List_Lazy_Types=$PS["Data.List.Lazy.Types"],Data_Map_Internal=$PS["Data.Map.Internal"],Data_Maybe=$PS["Data.Maybe"],Data_Monoid=$PS["Data.Monoid"],Data_Monoid_Additive=$PS["Data.Monoid.Additive"],Data_Newtype=$PS["Data.Newtype"],Data_Nullable=$PS["Data.Nullable"],Data_Ord=$PS["Data.Ord"],Data_Semigroup=$PS["Data.Semigroup"],Data_Semiring=$PS["Data.Semiring"],Data_Set=$PS["Data.Set"],Data_Set_NonEmpty=$PS["Data.Set.NonEmpty"],Data_Show=$PS["Data.Show"],Data_Time_Duration=$PS["Data.Time.Duration"],Data_Traversable=$PS["Data.Traversable"],Data_Tuple=$PS["Data.Tuple"],Data_Unfoldable=$PS["Data.Unfoldable"],Data_Unit=$PS["Data.Unit"],Effect=$PS["Effect"],Effect_Aff=$PS["Effect.Aff"],Effect_Class=$PS["Effect.Class"],Effect_Class_Console=$PS["Effect.Class.Console"],Effect_Exception_Unsafe=$PS["Effect.Exception.Unsafe"],Effect_Now=$PS["Effect.Now"],Effect_Ref=$PS["Effect.Ref"],Matryoshka_Class_Corecursive=$PS["Matryoshka.Class.Corecursive"],Matryoshka_Class_Recursive=$PS["Matryoshka.Class.Recursive"],Matryoshka_Fold=$PS["Matryoshka.Fold"],Matryoshka_Unfold=$PS["Matryoshka.Unfold"],Web_DOM_Document=$PS["Web.DOM.Document"],Web_Event_EventTarget=$PS["Web.Event.EventTarget"],Web_HTML=$PS["Web.HTML"],Web_HTML_Event_EventTypes=$PS["Web.HTML.Event.EventTypes"],Web_HTML_HTMLDocument=$PS["Web.HTML.HTMLDocument"],Web_HTML_Window=$PS["Web.HTML.Window"],NodeF=(function(){function NodeF(value0,value1){this.value0=value0;this.value1=value1};NodeF.create=function(value0){return function(value1){return new NodeF(value0,value1)}};return NodeF})(),Node=(function(){function Node(value0,value1){this.value0=value0;this.value1=value1};Node.create=function(value0){return function(value1){return new Node(value0,value1)}};return Node})(),LOne=(function(){function LOne(){};LOne.value=new LOne();return LOne})(),LTwo=(function(){function LTwo(){};LTwo.value=new LTwo();return LTwo})(),LThree=(function(){function LThree(){};LThree.value=new LThree();return LThree})(),NCount=function(x){return x},Dead=(function(){function Dead(value0){this.value0=value0};Dead.create=function(value0){return new Dead(value0)};return Dead})(),LiveAlone=(function(){function LiveAlone(){};LiveAlone.value=new LiveAlone();return LiveAlone})(),Live=(function(){function Live(value0){this.value0=value0};Live.create=function(value0){return new Live(value0)};return Live})(),Overload=(function(){function Overload(){};Overload.value=new Overload();return Overload})(),validLiveCount=function(v){if(v instanceof Dead&&v.value0 instanceof LThree)return true;if(v instanceof Live&&v.value0 instanceof LTwo)return true;if(v instanceof Live&&v.value0 instanceof LThree)return true;return false},unionsIntMap=function(dictFoldable){return function(dictSemigroup){return function(xs){return $foreign["_unionsIntMap"](Data_Semigroup.append(dictSemigroup),Data_Foldable.for_(Effect.applicativeEffect)(dictFoldable)(xs))}}},toNCount=function(v){if(v===0)return Effect_Exception_Unsafe.unsafeThrow("0 ncount");if(v===1)return new Data_Maybe.Just(LOne.value);if(v===2)return new Data_Maybe.Just(LTwo.value);if(v===3)return new Data_Maybe.Just(LThree.value);return Data_Maybe.Nothing.value},toIntMap=function(dictFoldable){return function(dictSemigroup){return function(xs){return $foreign["_toIntMap"](function(v){return function(f){return f(v.value0)(v.value1)}},Data_Semigroup.append(dictSemigroup),Data_Foldable.for_(Effect.applicativeEffect)(dictFoldable)(xs))}}},toDead=function(v){if(v instanceof Data_Maybe.Just)return new Dead(v.value0);if(v instanceof Data_Maybe.Nothing)return Overload.value;throw new Error("Failed pattern match at Gol (line 272, column 1 - line 272, column 28): "+[v.constructor.name])},singletonIntMap=Data_Function_Uncurried.runFn2($foreign["_singletonIntMap"]),showNCount=new Data_Show.Show(function(v){if(v instanceof Data_Maybe.Just&&v.value0 instanceof LOne)return"One";if(v instanceof Data_Maybe.Just&&v.value0 instanceof LTwo)return"Two";if(v instanceof Data_Maybe.Just&&v.value0 instanceof LThree)return"Three";if(v instanceof Data_Maybe.Nothing)return"Many";throw new Error("Failed pattern match at Gol (line 144, column 12 - line 148, column 31): "+[v.constructor.name])}),showLCount=new Data_Show.Show(function(v){if(v instanceof LOne)return"One";if(v instanceof LTwo)return"Two";if(v instanceof LThree)return"Three";throw new Error("Failed pattern match at Gol (line 136, column 12 - line 139, column 24): "+[v.constructor.name])}),showNeighbs=new Data_Show.Show(function(v){if(v instanceof Dead)return"(Dead "+(Data_Show.show(showLCount)(v.value0)+")");if(v instanceof LiveAlone)return"LiveAlone";if(v instanceof Live)return"(Live "+(Data_Show.show(showLCount)(v.value0)+")");if(v instanceof Overload)return"Overload";throw new Error("Failed pattern match at Gol (line 163, column 12 - line 167, column 29): "+[v.constructor.name])}),setupDrawer=Data_Function_Uncurried.runFn2($foreign["_setupDrawer"]),safeRange=function(x){return function(y){if(y>=x)return Data_List_Lazy.range(x)(y);if(Data_Boolean.otherwise)return Data_List_Lazy_Types.nil;throw new Error("Failed pattern match at Gol (line 351, column 1 - line 351, column 36): "+[x.constructor.name,y.constructor.name])}},runSteps=function(v){var go=function(xs){return Control_Bind.bind(Effect_Aff.bindAff)(Effect_Class.liftEffect(Effect_Aff.monadEffectAff)(Effect_Now.now))(function(t0){var v1=Data_List_Lazy_Types.step(xs);if(v1 instanceof Data_List_Lazy_Types.Nil)return Control_Applicative.pure(Effect_Aff.applicativeAff)(Data_Unit.unit);if(v1 instanceof Data_List_Lazy_Types.Cons)return Control_Bind.discard(Control_Bind.discardUnit)(Effect_Aff.bindAff)(Effect_Class.liftEffect(Effect_Aff.monadEffectAff)(v1.value0))(function(){return Control_Bind.bind(Effect_Aff.bindAff)(Effect_Class.liftEffect(Effect_Aff.monadEffectAff)(Effect_Now.now))(function(t1){var fdt=Data_Newtype.unwrap(Data_Time_Duration.newtypeMilliseconds)(Data_DateTime_Instant.unInstant(t1))-Data_Newtype.unwrap(Data_Time_Duration.newtypeMilliseconds)(Data_DateTime_Instant.unInstant(t0)),leftover=v-fdt;return Control_Bind.discard(Control_Bind.discardUnit)(Effect_Aff.bindAff)(Effect_Class.liftEffect(Effect_Aff.monadEffectAff)(Effect_Class_Console.log(Effect_Class.monadEffectEffect)(Data_Show.show(Data_Show.showNumber)(leftover))))(function(){return Control_Bind.discard(Control_Bind.discardUnit)(Effect_Aff.bindAff)(Control_Applicative.when(Effect_Aff.applicativeAff)(leftover>0.0)(Effect_Aff.delay(leftover)))(function(){return go(v1.value1)})})})});throw new Error("Failed pattern match at Gol (line 94, column 7 - line 104, column 16): "+[v1.constructor.name])})};return go},onE=function(etype){return function(targ){return function(h){return function __do(){var listener=Web_Event_EventTarget.eventListener(h)();return Web_Event_EventTarget.addEventListener(etype)(listener)(false)(targ)()}}}},neighbsSet=Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_List_Lazy_Types.applicativeList)(function(x){return Data_List_Lazy_Types.cons(x)(Data_List_Lazy_Types.cons(x-1|0)(Data_List_Lazy_Types.cons(x+1|0)(Data_List_Lazy_Types.nil)))}),neighbs2d=function(n){return function(i){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy_Types.cons(0)(Data_List_Lazy_Types.cons(-1|0)(Data_List_Lazy_Types.cons(1)(Data_List_Lazy_Types.nil))))(function(dx){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy_Types.cons(0)(Data_List_Lazy_Types.cons(-1|0)(Data_List_Lazy_Types.cons(1)(Data_List_Lazy_Types.nil))))(function(dy){return Control_Applicative.pure(Data_List_Lazy_Types.applicativeList)((i+dx|0)+(n*dy|0)|0)})})}},nCountInt=function(v){if(v instanceof Data_Maybe.Just&&v.value0 instanceof LOne)return 1;if(v instanceof Data_Maybe.Just&&v.value0 instanceof LTwo)return 2;if(v instanceof Data_Maybe.Just&&v.value0 instanceof LThree)return 3;if(v instanceof Data_Maybe.Nothing)return 4;throw new Error("Failed pattern match at Gol (line 151, column 13 - line 155, column 22): "+[v.constructor.name])},mulNCount=function(v){return function(v1){if(v instanceof Data_Maybe.Just&&v.value0 instanceof LOne)return v1;if(v1 instanceof Data_Maybe.Just&&v1.value0 instanceof LOne)return v;return Data_Maybe.Nothing.value}},maxBinom=Data_Function_Uncurried.runFn2($foreign["_maxBinom"]),lowNeighbs=function(v){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy_Types.cons(v.value0)(Data_List_Lazy_Types.cons(v.value0-1|0)(Data_List_Lazy_Types.cons(v.value0+1|0)(Data_List_Lazy_Types.nil))))(function(x$prime){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(Data_List_Lazy_Types.cons(v.value1)(Data_List_Lazy_Types.cons(v.value1-1|0)(Data_List_Lazy_Types.cons(v.value1+1|0)(Data_List_Lazy_Types.nil))))(function(y$prime){return Control_Applicative.pure(Data_List_Lazy_Types.applicativeList)(new Data_Tuple.Tuple(x$prime,y$prime))})})},ixPascal=Data_Function_Uncurried.runFn2($foreign["_ixPascal"]),ixOrZero=function(xs){return function(i){var v=Data_Array.index(xs)(i);if(v instanceof Data_Maybe.Nothing)return 0;if(v instanceof Data_Maybe.Just)return v.value0;throw new Error("Failed pattern match at Gol (line 122, column 17 - line 124, column 17): "+[v.constructor.name])}},initialPoints=Data_Set.fromFoldable(Data_Foldable.foldableArray)(Data_Tuple.ordTuple(Data_Ord.ordInt)(Data_Ord.ordInt))([new Data_Tuple.Tuple(0,2),new Data_Tuple.Tuple(1,0),new Data_Tuple.Tuple(1,2),new Data_Tuple.Tuple(2,1),new Data_Tuple.Tuple(2,2)]),functorVecTreeF=function(dictFunctor){return new Data_Functor.Functor(function(f){return function(m){return new NodeF(m.value0,Data_Functor.map(dictFunctor)(f)(m.value1))}})},vecTreeCorec=function(dictFunctor){return new Matryoshka_Class_Corecursive.Corecursive(function(){return functorVecTreeF(dictFunctor)},function(v){return new Node(v.value0,v.value1)})},vecTreeRec=function(dictFunctor){return new Matryoshka_Class_Recursive.Recursive(function(){return functorVecTreeF(dictFunctor)},function(v){return new NodeF(v.value0,v.value1)})},showVecTree=function(dictFunctor){return function(dictFoldable){return function(dictShow){return new Data_Show.Show(Matryoshka_Fold.cata(vecTreeRec(dictFunctor))(function(v){var xshow="["+(Data_Foldable.intercalate(dictFoldable)(Data_Monoid.monoidString)(",")(v.value1)+"]");return"(Node "+(Data_Show.show(dictShow)(v.value0)+(" "+(xshow+")")))}))}}},functorVecTree=function(dictFunctor){return new Data_Functor.Functor(function(f){return function(m){return new Node(f(m.value0),Data_Functor.map(dictFunctor)(Data_Functor.map(functorVecTree(dictFunctor))(f))(m.value1))}})},forIterate=function(dictMonad){return function(n){return function(f){return function(g){var go=function(v){return function(v1){if(v<n)return Control_Bind.discard(Control_Bind.discardUnit)(dictMonad.Bind1())(g(v1))(function(){return go(v+1|0)(f(v1))});return Control_Applicative.pure(dictMonad.Applicative0())(Data_Unit.unit)}};return go(0)}}}},foldableVecTree=function(dictFoldable){return new Data_Foldable.Foldable(function(dictMonoid){return function(f){return function(v){return Data_Semigroup.append(dictMonoid.Semigroup0())(f(v.value0))(Data_Foldable.foldMap(dictFoldable)(dictMonoid)(Data_Foldable.foldMap(foldableVecTree(dictFoldable))(dictMonoid)(f))(v.value1))}}},Data_Foldable.foldlDefault(foldableVecTree(dictFoldable)),Data_Foldable.foldrDefault(foldableVecTree(dictFoldable)))},traversableVecTree=function(dictTraversable){return new Data_Traversable.Traversable(function(){return foldableVecTree(dictTraversable.Foldable1())},function(){return functorVecTree(dictTraversable.Functor0())},function(dictApplicative){return Data_Traversable.sequenceDefault(traversableVecTree(dictTraversable))(dictApplicative)},function(dictApplicative){return function(f){return function(v){return Control_Apply.apply(dictApplicative.Apply0())(Data_Functor.map((dictApplicative.Apply0()).Functor0())(Node.create)(f(v.value0)))(Data_Traversable.traverse(dictTraversable)(dictApplicative)(Data_Traversable.traverse(traversableVecTree(dictTraversable))(dictApplicative)(f))(v.value1))}}})},filterIntMap=Data_Function_Uncurried.runFn2($foreign["_filterIntMap"]),dropAlong=function($copy_xs){return function($copy_ys){var $tco_var_xs=$copy_xs,$tco_done=false,$tco_result;function $tco_loop(xs,ys){var v=Data_List_Lazy_Types.step(xs);if(v instanceof Data_List_Lazy_Types.Nil){$tco_done=true;return ys};if(v instanceof Data_List_Lazy_Types.Cons){var v1=Data_List_Lazy_Types.step(ys);if(v1 instanceof Data_List_Lazy_Types.Nil){$tco_done=true;return Data_List_Lazy_Types.nil};if(v1 instanceof Data_List_Lazy_Types.Cons){$tco_var_xs=v.value1;$copy_ys=v1.value1;return};throw new Error("Failed pattern match at Gol (line 404, column 24 - line 406, column 43): "+[v1.constructor.name])};throw new Error("Failed pattern match at Gol (line 402, column 19 - line 406, column 43): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_xs,$copy_ys);return $tco_result}},drawGolSyms4D=Data_Function_Uncurried.runFn2($foreign["_drawGolSyms4D"]),doOnce=function(a){return function __do(){var doneRef=Effect_Ref["new"](false)();return function __do(){var done=Effect_Ref.read(doneRef)();return Control_Applicative.unless(Effect.applicativeEffect)(done)(function __do(){a();return Effect_Ref.write(true)(doneRef)()})()}}},chompPascal=function(q){return function(n){return function(k){return $foreign["_chompPascal"](q,n,k,function(i$prime){return function(q$prime){return function(k$prime){return new Data_Tuple.Tuple(new Data_Tuple.Tuple(i$prime,q$prime),k$prime)}}})}}},genVecRunIxPascal=function(n){return function(mx){return function(x){var go=function(q){return function(m){return function(k){var v=chompPascal(q)(m)(k),$156=m===1;if($156)return Data_List_Lazy_Types.cons(v.value0.value0)(Data_List_Lazy_Types.cons(v.value1)(Data_List_Lazy_Types.nil));return Data_List_Lazy_Types.cons(v.value0.value0)(go(v.value0.value1)(m-1|0)(v.value1))}}};return go(x)(mx)(n)}}},vecRunNeighbsTree=function(n){return function(orig){var mx=maxBinom(n)(orig)+1|0,gens=genVecRunIxPascal(n)(mx)(orig),go=function(v){return new NodeF(v.value1,(function(){if(v.value0 instanceof Data_Maybe.Nothing)return Data_List_Lazy_Types.nil;if(v.value0 instanceof Data_Maybe.Just){var v1=Data_List_Lazy_Types.step(v.value0.value0.ls0);if(v1 instanceof Data_List_Lazy_Types.Nil){var contrib=Data_Lazy.defer(function(v2){var r$prime=Data_Maybe.fromMaybe(0)(v.value0.value0.r),res=r$prime+v.value0.value0.x|0,out$prime=Data_List_Lazy_Types.cons(res)(v.value0.value0.out),mulfact=Data_Lazy.defer(function(v3){return $foreign.factorial(v.value0.value0.x)*$foreign.factorial(r$prime)|0}),multP=Control_Bind.bind(Data_Lazy.bindLazy)(v.value0.value0.p)(function(p_){return Control_Bind.bind(Data_Lazy.bindLazy)(mulfact)(function(m_){var pPow=Data_Int.pow(2)(r$prime),here=Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)($foreign.factorial(res))(m_);return Control_Applicative.pure(Data_Lazy.applicativeLazy)({total:(p_*here|0)*pPow|0,here:"\xd7"+(Data_Show.show(Data_Show.showInt)(here)+("\xd7"+Data_Show.show(Data_Show.showInt)(pPow)))})})}),multQ=Control_Bind.bind(Data_Lazy.bindLazy)(v.value0.value0.q)(function(q_){return Control_Bind.bind(Data_Lazy.bindLazy)(mulfact)(function(m_){var qPow=Data_Int.pow(2)(v.value0.value0.x0-v.value0.value0.x|0);return Control_Applicative.pure(Data_Lazy.applicativeLazy)({total:Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(q_*qPow|0)(m_),here:"\xf7"+(Data_Show.show(Data_Show.showInt)(m_)+("\xd7"+Data_Show.show(Data_Show.showInt)(qPow)))})})}),chosen=Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(out$prime),allSame$prime=v.value0.value0.allSame&&v.value0.value0.x===v.value0.value0.x0;return{chosen:chosen,multP:multP,multQ:multQ,allSame:allSame$prime,leftovers:Data_Array.replicate(mx+1|0)(0),parts:{left:Data_Nullable["null"],here:Data_Nullable.notNull(v.value0.value0.x),right:Data_Nullable.toNullable(v.value0.value0.r)}}});return Data_List_Lazy.singleton(new Data_Tuple.Tuple(Data_Maybe.Nothing.value,contrib))};if(v1 instanceof Data_List_Lazy_Types.Cons)return Control_Bind.bind(Data_List_Lazy_Types.bindList)(safeRange(0)(v.value0.value0.x+v1.value0|0))(function(xlContrib){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(safeRange(Data_Ord.max(Data_Ord.ordInt)(0)(xlContrib-v.value0.value0.x|0))(Data_Ord.min(Data_Ord.ordInt)(v1.value0)(xlContrib)))(function(lContrib){var xContrib=xlContrib-lContrib|0,x$prime=v.value0.value0.x-xContrib|0,r$prime=Data_Maybe.fromMaybe(0)(v.value0.value0.r),res=r$prime+xlContrib|0,out$prime=Data_List_Lazy_Types.cons(res)(v.value0.value0.out),mulfact=Data_Lazy.defer(function(v2){return($foreign.factorial(r$prime)*$foreign.factorial(xContrib)|0)*$foreign.factorial(lContrib)|0}),multP=Control_Bind.bind(Data_Lazy.bindLazy)(v.value0.value0.p)(function(p_){return Control_Bind.bind(Data_Lazy.bindLazy)(mulfact)(function(m_){var here=Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)($foreign.factorial(res))(m_);return Control_Applicative.pure(Data_Lazy.applicativeLazy)({total:p_*here|0,here:"\xd7"+Data_Show.show(Data_Show.showInt)(here)})})}),multQ=Control_Bind.bind(Data_Lazy.bindLazy)(v.value0.value0.q)(function(q_){return Control_Bind.bind(Data_Lazy.bindLazy)(mulfact)(function(m_){return Control_Applicative.pure(Data_Lazy.applicativeLazy)({total:Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(q_)(m_),here:"\xf7"+Data_Show.show(Data_Show.showInt)(m_)})})}),l$prime=v1.value0-lContrib|0,j$prime=v.value0.value0.j-res|0,i$prime=v.value0.value0.i-1|0,allSame$prime=v.value0.value0.allSame&&xContrib===v.value0.value0.x0,contrib=Data_Lazy.defer(function(v2){return{chosen:Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(out$prime),multP:multP,multQ:multQ,allSame:allSame$prime,leftovers:Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.take(mx+1|0)((function(v3){return Data_Semigroup.append(Data_List_Lazy_Types.semigroupList)(v3)(Data_List_Lazy.repeat(0))})(Data_List_Lazy.reverse(Data_List_Lazy_Types.cons(x$prime)(Data_List_Lazy_Types.cons(l$prime)(Data_List_Lazy.drop(2)(dropAlong(v.value0.value0.out)(gens)))))))),parts:{left:Data_Nullable.notNull(lContrib),here:Data_Nullable.notNull(xContrib),right:Data_Nullable.toNullable(v.value0.value0.r)}}});return Control_Applicative.pure(Data_List_Lazy_Types.applicativeList)(new Data_Tuple.Tuple(new Data_Maybe.Just({i:i$prime,j:j$prime,out:out$prime,x0:v1.value0,allSame:allSame$prime,p:Data_Functor.map(Data_Lazy.functorLazy)(function(v2){return v2.total})(multP),q:Data_Functor.map(Data_Lazy.functorLazy)(function(v2){return v2.total})(multQ),r:new Data_Maybe.Just(x$prime),x:l$prime,ls0:v1.value1}),contrib))})});throw new Error("Failed pattern match at Gol (line 437, column 48 - line 520, column 26): "+[v1.constructor.name])};throw new Error("Failed pattern match at Gol (line 435, column 53 - line 520, column 26): "+[v.value0.constructor.name])})())},initQ=Data_Lazy.defer(function(v){return Data_Foldable.product(Data_List_Lazy_Types.foldableList)(Data_Semiring.semiringInt)(Data_Functor.map(Data_List_Lazy_Types.functorList)($foreign.factorial)(gens))}),v=Data_List_Lazy_Types.step(gens);if(v instanceof Data_List_Lazy_Types.Nil)return $foreign["undefined"];if(v instanceof Data_List_Lazy_Types.Cons)return Matryoshka_Unfold.ana(vecTreeCorec(Data_List_Lazy_Types.functorList))(go)(new Data_Tuple.Tuple(new Data_Maybe.Just({i:mx,j:n,out:Data_List_Lazy_Types.nil,x0:v.value0,allSame:true,p:Data_Lazy.defer(function(v1){return 1}),q:initQ,r:Data_Maybe.Nothing.value,x:v.value0,ls0:v.value1}),Data_Lazy.defer(function(v1){var leftovers=Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.reverse(gens));return{chosen:[],multP:Data_Lazy.defer(function(v2){return{total:1,here:"=1"}}),multQ:Data_Function.flip(Data_Functor.map(Data_Lazy.functorLazy))(initQ)(function(q){return{total:q,here:"="+Data_Show.show(Data_Show.showInt)(q)}}),leftovers:Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.reverse(gens)),allSame:true,parts:{left:Data_Nullable["null"],here:Data_Nullable["null"],right:Data_Nullable["null"]}}})));throw new Error("Failed pattern match at Gol (line 412, column 28 - line 429, column 14): "+[v.constructor.name])}},buildHierarchy=Data_Function_Uncurried.runFn2($foreign["_buildHierarchy"]),vecTreeHierarchy=function(dictFoldable){return function(xs){return buildHierarchy(xs)(function(v){return Data_Array.fromFoldable(dictFoldable)(v.value1)})}},drawTree=function(sel){return function(fwd){var vecRun=function(d){return function(n){var mx=maxBinom(d)(n)+1|0,gens=genVecRunIxPascal(d)(mx)(n);return Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.reverse(gens))}},mkHier=function(d){var $238=vecTreeHierarchy(Data_List_Lazy_Types.foldableList),$239=vecRunNeighbsTree(d);return function($240){return $238($239($240))}};return $foreign["_drawTree"](sel,fwd,vecRun,mkHier,function(v){return v.value0})}},binom=Data_Function_Uncurried.runFn2($foreign["_binom"]),vecRunNeighbs=function(update){return function(p0){return function(n){return function(orig){var mx=maxBinom(n)(orig)+1|0,go=function(i){return function(j){return function(tot){return function(x0){return function(allSame){return function(p){return function(r){return function(x){return function(ls0){var v=Data_List_Lazy_Types.step(ls0);if(v instanceof Data_List_Lazy_Types.Nil){var res=r+x|0,p$prime=update(p)(Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)($foreign.factorial(res)*Data_Int.pow(2)(r)|0)($foreign.factorial(x)*$foreign.factorial(r)|0));return Data_Functor.voidRight(Data_List_Lazy_Types.functorList)(new Data_Tuple.Tuple(tot,p$prime))(Control_MonadZero.guard(Data_List_Lazy_Types.monadZeroList)(!(allSame&&x===x0)))};if(v instanceof Data_List_Lazy_Types.Cons)return Control_Bind.bind(Data_List_Lazy_Types.bindList)(safeRange(0)(x+v.value0|0))(function(xlContrib){return Control_Bind.bind(Data_List_Lazy_Types.bindList)(safeRange(Data_Ord.max(Data_Ord.ordInt)(0)(xlContrib-x|0))(Data_Ord.min(Data_Ord.ordInt)(v.value0)(xlContrib)))(function(lContrib){var xContrib=xlContrib-lContrib|0,x$prime=x-xContrib|0,res=r+xlContrib|0,tot$prime=tot+Data_Foldable.sum(Data_List_Lazy_Types.foldableList)(Data_Semiring.semiringInt)(Data_Functor.map(Data_List_Lazy_Types.functorList)(function(k){return binom((i+j|0)-k|0)(i-1|0)})(safeRange(1)(res)))|0,p$prime=update(p)(Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)($foreign.factorial(res))(($foreign.factorial(r)*$foreign.factorial(xContrib)|0)*$foreign.factorial(lContrib)|0)),l$prime=v.value0-lContrib|0,j$prime=j-res|0,i$prime=i-1|0;return go(i$prime)(j$prime)(tot$prime)(v.value0)(allSame&&xContrib===x0)(p$prime)(x$prime)(l$prime)(v.value1)})});throw new Error("Failed pattern match at Gol (line 328, column 39 - line 349, column 64): "+[v.constructor.name])}}}}}}}}},gens=genVecRunIxPascal(n)(mx)(orig),v=Data_List_Lazy_Types.step(gens);if(v instanceof Data_List_Lazy_Types.Nil)return Data_List_Lazy_Types.nil;if(v instanceof Data_List_Lazy_Types.Cons)return go(mx)(n)(0)(v.value0)(true)(p0)(0)(v.value0)(v.value1);throw new Error("Failed pattern match at Gol (line 312, column 34 - line 314, column 49): "+[v.constructor.name])}}}},drawGolSyms5D=function(sel){return $foreign["_drawGolSyms5D"](sel,(function(){var $241=toIntMap(Data_List_Lazy_Types.foldableList)(Data_Monoid_Additive.semigroupAdditive(Data_Semiring.semiringInt)),$242=Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Tuple.functorTuple)(Data_Monoid_Additive.Additive)),$243=vecRunNeighbs(Data_Semiring.mul(Data_Semiring.semiringInt))(1)(3);return function($244){return $241($242($243($244)))}})())},assignWindow=Data_Function_Uncurried.runFn2($foreign["_assignWindow"]),addLCount=function(f){return function(x){return function(v){if(v instanceof LOne)return function(v1){if(v1 instanceof LOne)return f(LTwo.value);if(v1 instanceof LTwo)return f(LThree.value);return x};if(v instanceof LTwo)return function(v1){if(v1 instanceof LOne)return f(LThree.value);return x};if(v instanceof LThree)return Data_Function["const"](x);throw new Error("Failed pattern match at Gol (line 170, column 17 - line 178, column 22): "+[v.constructor.name])}}},sgNCount=new Data_Semigroup.Semigroup(function(v){return function(v1){if(v instanceof Data_Maybe.Just&&v1 instanceof Data_Maybe.Just)return addLCount(Data_Maybe.Just.create)(Data_Maybe.Nothing.value)(v.value0)(v1.value0);return Data_Maybe.Nothing.value}}),sgNieghbs=new Data_Semigroup.Semigroup(function(v){if(v instanceof Dead)return function(v1){if(v1 instanceof Dead)return addLCount(Dead.create)(Overload.value)(v.value0)(v1.value0);if(v1 instanceof LiveAlone)return new Live(v.value0);if(v1 instanceof Live)return addLCount(Live.create)(Overload.value)(v.value0)(v1.value0);return Overload.value};if(v instanceof LiveAlone)return function(v1){if(v1 instanceof Dead)return new Live(v1.value0);if(v1 instanceof LiveAlone)return LiveAlone.value;if(v1 instanceof Live)return new Live(v1.value0);return Overload.value};if(v instanceof Live)return function(v1){if(v1 instanceof Dead)return addLCount(Live.create)(Overload.value)(v.value0)(v1.value0);if(v1 instanceof LiveAlone)return new Live(v.value0);if(v1 instanceof Live)return addLCount(Live.create)(Overload.value)(v.value0)(v1.value0);return Overload.value};if(v instanceof Overload)return Data_Function["const"](Overload.value);throw new Error("Failed pattern match at Gol (line 185, column 14 - line 201, column 33): "+[v.constructor.name])}),stepper=function(dictOrd){return function(dictShow){return function(expand){return function(syms){return function(cs){var uniqueGroups=Data_Set.fromFoldable(Data_Map_Internal.foldableMap)(Data_Set_NonEmpty.ordNonEmptySet(Data_Ord.ordInt))(cs),prebake=(function(){var $245=Data_Bifunctor.bimap(Data_Tuple.bifunctorTuple)(unionsIntMap(Data_List_Lazy_Types.foldableList)(sgNieghbs))(unionsIntMap(Data_List_Lazy_Types.foldableList)(sgNieghbs)),$246=Data_Foldable.foldr(Data_Set_NonEmpty.foldableNonEmptySet)(function(pIx){return function(v){var pNeighbs=syms(pIx),there$prime=Data_List_Lazy_Types.cons(singletonIntMap(pIx)(new Dead(LOne.value)))(Data_List_Lazy_Types.cons(pNeighbs)(v.value1)),here$prime=Data_List_Lazy_Types.cons(singletonIntMap(pIx)(LiveAlone.value))(Data_List_Lazy_Types.cons(pNeighbs)(v.value0));return new Data_Tuple.Tuple(here$prime,there$prime)}})(new Data_Tuple.Tuple(Data_Monoid.mempty(Data_List_Lazy_Types.monoidList),Data_Monoid.mempty(Data_List_Lazy_Types.monoidList)));return function($247){return $245($246($247))}})(),prebaked=Data_Map_Internal.fromFoldable(Data_Set_NonEmpty.ordNonEmptySet(Data_Ord.ordInt))(Data_List_Lazy_Types.foldableList)(Data_Functor.map(Data_List_Lazy_Types.functorList)(function(gr){return new Data_Tuple.Tuple(gr,prebake(gr))})(Data_List_Lazy.fromFoldable(Data_Set.foldableSet)(uniqueGroups)));return Data_Map_Internal.mapMaybe(dictOrd)((function(){var $248=Data_Set_NonEmpty.fromFoldable(Data_Foldable.foldableArray)(Data_Ord.ordInt),$249=filterIntMap(validLiveCount),$250=unionsIntMap(Data_List_Lazy_Types.foldableList)(sgNieghbs);return function($251){return $248($foreign.intMapKeys($249($250($251))))}})())(Data_Foldable.foldl(Data_List_Lazy_Types.foldableList)(function(res){return function(v){var v1=Data_Map_Internal.lookup(Data_Set_NonEmpty.ordNonEmptySet(Data_Ord.ordInt))(v.value1)(prebaked);if(v1 instanceof Data_Maybe.Nothing)return res;if(v1 instanceof Data_Maybe.Just)return Data_Function.flip(Data_Map_Internal.unionWith(dictOrd)(Data_Semigroup.append(Data_List_Lazy_Types.semigroupList)))(res)(Data_Map_Internal.fromFoldable(dictOrd)(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.zip(expand(v.value0))(Data_List_Lazy_Types.cons(Data_List_Lazy.singleton(v1.value0.value0))(Data_List_Lazy.repeat(Data_List_Lazy.singleton(v1.value0.value1))))));throw new Error("Failed pattern match at Gol (line 226, column 11 - line 229, column 100): "+[v1.constructor.name])}})(Data_Map_Internal.empty)(Data_Map_Internal.toUnfoldableUnordered(Data_List_Lazy_Types.unfoldableList)(cs)))}}}}},runner=function(d){var highNeighbs=$foreign.memoInt((function(){var $252=toIntMap(Data_List_Lazy_Types.foldableList)(sgNieghbs),$253=Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Tuple.functorTuple)(toDead)),$254=vecRunNeighbs(function(n){var $256=mulNCount(n);return function($257){return $256(toNCount($257))}})(new Data_Maybe.Just(LOne.value))(d);return function($255){return $252($253($254($255)))}})()),$258=Data_List_Lazy.iterate(function(v){return Control_Bind.bindFlipped(Data_Lazy.bindLazy)((function(){var $264=Control_Applicative.pure(Data_Lazy.applicativeLazy),$265=stepper(Data_Tuple.ordTuple(Data_Ord.ordInt)(Data_Ord.ordInt))(Data_Tuple.showTuple(Data_Show.showInt)(Data_Show.showInt))(lowNeighbs)(highNeighbs);return function($266){return $264($265($266))}})())(v)}),$259=Control_Applicative.pure(Data_Lazy.applicativeLazy),$260=Data_Map_Internal.fromFoldable(Data_Tuple.ordTuple(Data_Ord.ordInt)(Data_Ord.ordInt))(Data_List_Lazy_Types.foldableList),$261=Data_Functor.map(Data_List_Lazy_Types.functorList)(function(x){return new Data_Tuple.Tuple(x,Data_Set_NonEmpty.singleton(0))}),$262=Data_List_Lazy.fromFoldable(Data_Set.foldableSet);return function($263){return $258($259($260($261($262($263)))))}},drawGol3D=function(sel){return function(size){return function(n){return function(pts){var drawer=(function(){var $267=Data_Functor.map(Data_Functor.functorArray)(function(v){return{x:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.value0+8|0)(20),y:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.value1+8|0)(20),zs:Data_Array.fromFoldable(Data_Set_NonEmpty.foldableNonEmptySet)(v.value1)}}),$268=Data_Map_Internal.toUnfoldableUnordered(Data_Unfoldable.unfoldableArray);return function($269){return $267($268($269))}})();return $foreign["_drawGol3D"](sel,size,Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.take(n)(Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Lazy.functorLazy)(drawer))(runner(1)(pts)))))}}}},drawGol4D=function(sel){return function(size){return function(n){return function(pts){var drawer=(function(){var $270=Data_Functor.map(Data_Functor.functorArray)(function(v){return{x:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.value0+8|0)(20),y:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.value1+8|0)(20),zws:Data_Array.fromFoldable(Data_Set_NonEmpty.foldableNonEmptySet)(v.value1)}}),$271=Data_Map_Internal.toUnfoldableUnordered(Data_Unfoldable.unfoldableArray);return function($272){return $270($271($272))}})();return $foreign["_drawGol4D"](sel,size,Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_List_Lazy.take(n)(Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Lazy.functorLazy)(drawer))(runner(2)(pts)))))}}}},drawGolFlat=function(sel){return function(size){return function(dim){return function(n){return function(pts){var drawer=(function(){var $273=Data_Functor.map(Data_Functor.functorArray)(function(v){return{x:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.value0+8|0)(20),y:Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(v.value0.value1+8|0)(20),pts:Data_Array.fromFoldable(Data_Set_NonEmpty.foldableNonEmptySet)(v.value1)}}),$274=Data_Map_Internal.toUnfoldableUnordered(Data_Unfoldable.unfoldableArray);return function($275){return $273($274($275))}})();return $foreign["_drawGolFlat"](sel,size,Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList)(Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Array.fromFoldable(Data_List_Lazy_Types.foldableList))(Data_List_Lazy.transpose(Data_Function.flip(Data_Functor.map(Data_List_Lazy_Types.functorList))(Data_List_Lazy.range(0)(dim))(function(d){return Data_Functor.map(Data_List_Lazy_Types.functorList)(Data_Functor.map(Data_Lazy.functorLazy)(drawer))(Data_List_Lazy.take(n)(runner(d)(initialPoints)))})))))}}}}},main=(function(){var ready=function(doc){return function(a){return function __do(){var a$prime=doOnce(a)();return onE(Web_HTML_Event_EventTypes.readystatechange)(Web_DOM_Document.toEventTarget(doc))(function(v){return a$prime})()}}};return function __do(){var doc=Control_Bind.bindFlipped(Effect.bindEffect)((function(){var $276=Data_Functor.map(Effect.functorEffect)(Web_HTML_HTMLDocument.toDocument);return function($277){return $276(Web_HTML_Window.document($277))}})())(Web_HTML.window)();return ready(doc)(function __do(){$foreign.logMe(27)();setupDrawer("#golDrawer")({height:8,width:8})();var g3D=$foreign.initGol3D("#gol3D")();drawGol3D(g3D)({height:20,width:20})(7)(initialPoints)();var g4D=$foreign.initGol4D("#gol4D")();drawGol4D(g4D)({height:20,width:20})(7)(initialPoints)();var gFlat=$foreign.initGolFlat("#golFlat")();drawGolFlat(gFlat)({height:20,width:20})(8)(7)(initialPoints)();drawGolSyms4D("#golSymsForward")(false)();drawGolSyms4D("#golSymsReverse")(true)();drawTree("#golTreeForward")(true)();drawTree("#golTreeReverse")(false)();return drawGolSyms5D("#golSyms5D")()})()}})();exports["main"]=main;exports["runSteps"]=runSteps;exports["forIterate"]=forIterate;exports["ixOrZero"]=ixOrZero;exports["initialPoints"]=initialPoints;exports["LOne"]=LOne;exports["LTwo"]=LTwo;exports["LThree"]=LThree;exports["NCount"]=NCount;exports["nCountInt"]=nCountInt;exports["Dead"]=Dead;exports["LiveAlone"]=LiveAlone;exports["Live"]=Live;exports["Overload"]=Overload;exports["addLCount"]=addLCount;exports["validLiveCount"]=validLiveCount;exports["neighbs2d"]=neighbs2d;exports["stepper"]=stepper;exports["runner"]=runner;exports["lowNeighbs"]=lowNeighbs;exports["toDead"]=toDead;exports["neighbsSet"]=neighbsSet;exports["genVecRunIxPascal"]=genVecRunIxPascal;exports["mulNCount"]=mulNCount;exports["toNCount"]=toNCount;exports["vecRunNeighbs"]=vecRunNeighbs;exports["safeRange"]=safeRange;exports["Node"]=Node;exports["NodeF"]=NodeF;exports["dropAlong"]=dropAlong;exports["vecRunNeighbsTree"]=vecRunNeighbsTree;exports["vecTreeHierarchy"]=vecTreeHierarchy;exports["toIntMap"]=toIntMap;exports["unionsIntMap"]=unionsIntMap;exports["filterIntMap"]=filterIntMap;exports["singletonIntMap"]=singletonIntMap;exports["buildHierarchy"]=buildHierarchy;exports["setupDrawer"]=setupDrawer;exports["drawGolFlat"]=drawGolFlat;exports["drawGol3D"]=drawGol3D;exports["drawGol4D"]=drawGol4D;exports["drawGolSyms4D"]=drawGolSyms4D;exports["drawGolSyms5D"]=drawGolSyms5D;exports["drawTree"]=drawTree;exports["binom"]=binom;exports["maxBinom"]=maxBinom;exports["ixPascal"]=ixPascal;exports["chompPascal"]=chompPascal;exports["onE"]=onE;exports["doOnce"]=doOnce;exports["assignWindow"]=assignWindow;exports["showLCount"]=showLCount;exports["showNCount"]=showNCount;exports["showNeighbs"]=showNeighbs;exports["sgNCount"]=sgNCount;exports["sgNieghbs"]=sgNieghbs;exports["functorVecTree"]=functorVecTree;exports["functorVecTreeF"]=functorVecTreeF;exports["vecTreeCorec"]=vecTreeCorec;exports["vecTreeRec"]=vecTreeRec;exports["showVecTree"]=showVecTree;exports["foldableVecTree"]=foldableVecTree;exports["traversableVecTree"]=traversableVecTree;exports["_toIntMap"]=$foreign["_toIntMap"];exports["_unionsIntMap"]=$foreign["_unionsIntMap"];exports["_filterIntMap"]=$foreign["_filterIntMap"];exports["intMapKeys"]=$foreign.intMapKeys;exports["_singletonIntMap"]=$foreign["_singletonIntMap"];exports["_buildHierarchy"]=$foreign["_buildHierarchy"];exports["logMe"]=$foreign.logMe;exports["trace"]=$foreign.trace;exports["_setupDrawer"]=$foreign["_setupDrawer"];exports["initGolFlat"]=$foreign.initGolFlat;exports["_drawGolFlat"]=$foreign["_drawGolFlat"];exports["initGol3D"]=$foreign.initGol3D;exports["_drawGol3D"]=$foreign["_drawGol3D"];exports["initGol4D"]=$foreign.initGol4D;exports["_drawGol4D"]=$foreign["_drawGol4D"];exports["_drawGolSyms4D"]=$foreign["_drawGolSyms4D"];exports["_drawGolSyms5D"]=$foreign["_drawGolSyms5D"];exports["_drawTree"]=$foreign["_drawTree"];exports["_binom"]=$foreign["_binom"];exports["_maxBinom"]=$foreign["_maxBinom"];exports["_ixPascal"]=$foreign["_ixPascal"];exports["pascalIx"]=$foreign.pascalIx;exports["_chompPascal"]=$foreign["_chompPascal"];exports["factorial"]=$foreign.factorial;exports["memoInt"]=$foreign.memoInt;exports["undefined"]=$foreign["undefined"];exports["_assignWindow"]=$foreign["_assignWindow"]})(PS);PS["Gol"].main()